{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\nimport { each, createHashMap, merge, assert } from 'zrender/lib/core/util';\nimport ComponentModel from '../../model/Component';\nimport { getAxisMainType, DATA_ZOOM_AXIS_DIMENSIONS } from './helper';\nimport { MULTIPLE_REFERRING, SINGLE_REFERRING } from '../../util/model';\n\nvar DataZoomAxisInfo =\n/** @class */\nfunction () {\n  function DataZoomAxisInfo() {\n    this.indexList = [];\n    this.indexMap = [];\n  }\n\n  DataZoomAxisInfo.prototype.add = function (axisCmptIdx) {\n    // Remove duplication.\n    if (!this.indexMap[axisCmptIdx]) {\n      this.indexList.push(axisCmptIdx);\n      this.indexMap[axisCmptIdx] = true;\n    }\n  };\n\n  return DataZoomAxisInfo;\n}();\n\nvar DataZoomModel =\n/** @class */\nfunction (_super) {\n  __extends(DataZoomModel, _super);\n\n  function DataZoomModel() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = DataZoomModel.type;\n    _this._autoThrottle = true;\n    _this._noTarget = true;\n    /**\n     * It is `[rangeModeForMin, rangeModeForMax]`.\n     * The optional values for `rangeMode`:\n     * + `'value'` mode: the axis extent will always be determined by\n     *     `dataZoom.startValue` and `dataZoom.endValue`, despite\n     *     how data like and how `axis.min` and `axis.max` are.\n     * + `'percent'` mode: `100` represents 100% of the `[dMin, dMax]`,\n     *     where `dMin` is `axis.min` if `axis.min` specified, otherwise `data.extent[0]`,\n     *     and `dMax` is `axis.max` if `axis.max` specified, otherwise `data.extent[1]`.\n     *     Axis extent will be determined by the result of the percent of `[dMin, dMax]`.\n     *\n     * For example, when users are using dynamic data (update data periodically via `setOption`),\n     * if in `'value`' mode, the window will be kept in a fixed value range despite how\n     * data are appended, while if in `'percent'` mode, whe window range will be changed alone with\n     * the appended data (suppose `axis.min` and `axis.max` are not specified).\n     */\n\n    _this._rangePropMode = ['percent', 'percent'];\n    return _this;\n  }\n\n  DataZoomModel.prototype.init = function (option, parentModel, ecModel) {\n    var inputRawOption = retrieveRawOption(option);\n    /**\n     * Suppose a \"main process\" start at the point that model prepared (that is,\n     * model initialized or merged or method called in `action`).\n     * We should keep the `main process` idempotent, that is, given a set of values\n     * on `option`, we get the same result.\n     *\n     * But sometimes, values on `option` will be updated for providing users\n     * a \"final calculated value\" (`dataZoomProcessor` will do that). Those value\n     * should not be the base/input of the `main process`.\n     *\n     * So in that case we should save and keep the input of the `main process`\n     * separately, called `settledOption`.\n     *\n     * For example, consider the case:\n     * (Step_1) brush zoom the grid by `toolbox.dataZoom`,\n     *     where the original input `option.startValue`, `option.endValue` are earsed by\n     *     calculated value.\n     * (Step)2) click the legend to hide and show a series,\n     *     where the new range is calculated by the earsed `startValue` and `endValue`,\n     *     which brings incorrect result.\n     */\n\n    this.settledOption = inputRawOption;\n    this.mergeDefaultAndTheme(option, ecModel);\n\n    this._doInit(inputRawOption);\n  };\n\n  DataZoomModel.prototype.mergeOption = function (newOption) {\n    var inputRawOption = retrieveRawOption(newOption); //FIX #2591\n\n    merge(this.option, newOption, true);\n    merge(this.settledOption, inputRawOption, true);\n\n    this._doInit(inputRawOption);\n  };\n\n  DataZoomModel.prototype._doInit = function (inputRawOption) {\n    var thisOption = this.option; // if (!env.canvasSupported) {\n    //     thisOption.realtime = false;\n    // }\n\n    this._setDefaultThrottle(inputRawOption);\n\n    this._updateRangeUse(inputRawOption);\n\n    var settledOption = this.settledOption;\n    each([['start', 'startValue'], ['end', 'endValue']], function (names, index) {\n      // start/end has higher priority over startValue/endValue if they\n      // both set, but we should make chart.setOption({endValue: 1000})\n      // effective, rather than chart.setOption({endValue: 1000, end: null}).\n      if (this._rangePropMode[index] === 'value') {\n        thisOption[names[0]] = settledOption[names[0]] = null;\n      } // Otherwise do nothing and use the merge result.\n\n    }, this);\n\n    this._resetTarget();\n  };\n\n  DataZoomModel.prototype._resetTarget = function () {\n    var optionOrient = this.get('orient', true);\n    var targetAxisIndexMap = this._targetAxisInfoMap = createHashMap();\n\n    var hasAxisSpecified = this._fillSpecifiedTargetAxis(targetAxisIndexMap);\n\n    if (hasAxisSpecified) {\n      this._orient = optionOrient || this._makeAutoOrientByTargetAxis();\n    } else {\n      this._orient = optionOrient || 'horizontal';\n\n      this._fillAutoTargetAxisByOrient(targetAxisIndexMap, this._orient);\n    }\n\n    this._noTarget = true;\n    targetAxisIndexMap.each(function (axisInfo) {\n      if (axisInfo.indexList.length) {\n        this._noTarget = false;\n      }\n    }, this);\n  };\n\n  DataZoomModel.prototype._fillSpecifiedTargetAxis = function (targetAxisIndexMap) {\n    var hasAxisSpecified = false;\n    each(DATA_ZOOM_AXIS_DIMENSIONS, function (axisDim) {\n      var refering = this.getReferringComponents(getAxisMainType(axisDim), MULTIPLE_REFERRING); // When user set axisIndex as a empty array, we think that user specify axisIndex\n      // but do not want use auto mode. Because empty array may be encountered when\n      // some error occured.\n\n      if (!refering.specified) {\n        return;\n      }\n\n      hasAxisSpecified = true;\n      var axisInfo = new DataZoomAxisInfo();\n      each(refering.models, function (axisModel) {\n        axisInfo.add(axisModel.componentIndex);\n      });\n      targetAxisIndexMap.set(axisDim, axisInfo);\n    }, this);\n    return hasAxisSpecified;\n  };\n\n  DataZoomModel.prototype._fillAutoTargetAxisByOrient = function (targetAxisIndexMap, orient) {\n    var ecModel = this.ecModel;\n    var needAuto = true; // Find axis that parallel to dataZoom as default.\n\n    if (needAuto) {\n      var axisDim = orient === 'vertical' ? 'y' : 'x';\n      var axisModels = ecModel.findComponents({\n        mainType: axisDim + 'Axis'\n      });\n      setParallelAxis(axisModels, axisDim);\n    } // Find axis that parallel to dataZoom as default.\n\n\n    if (needAuto) {\n      var axisModels = ecModel.findComponents({\n        mainType: 'singleAxis',\n        filter: function (axisModel) {\n          return axisModel.get('orient', true) === orient;\n        }\n      });\n      setParallelAxis(axisModels, 'single');\n    }\n\n    function setParallelAxis(axisModels, axisDim) {\n      // At least use the first parallel axis as the target axis.\n      var axisModel = axisModels[0];\n\n      if (!axisModel) {\n        return;\n      }\n\n      var axisInfo = new DataZoomAxisInfo();\n      axisInfo.add(axisModel.componentIndex);\n      targetAxisIndexMap.set(axisDim, axisInfo);\n      needAuto = false; // Find parallel axes in the same grid.\n\n      if (axisDim === 'x' || axisDim === 'y') {\n        var gridModel_1 = axisModel.getReferringComponents('grid', SINGLE_REFERRING).models[0];\n        gridModel_1 && each(axisModels, function (axModel) {\n          if (axisModel.componentIndex !== axModel.componentIndex && gridModel_1 === axModel.getReferringComponents('grid', SINGLE_REFERRING).models[0]) {\n            axisInfo.add(axModel.componentIndex);\n          }\n        });\n      }\n    }\n\n    if (needAuto) {\n      // If no parallel axis, find the first category axis as default. (Also consider polar).\n      each(DATA_ZOOM_AXIS_DIMENSIONS, function (axisDim) {\n        if (!needAuto) {\n          return;\n        }\n\n        var axisModels = ecModel.findComponents({\n          mainType: getAxisMainType(axisDim),\n          filter: function (axisModel) {\n            return axisModel.get('type', true) === 'category';\n          }\n        });\n\n        if (axisModels[0]) {\n          var axisInfo = new DataZoomAxisInfo();\n          axisInfo.add(axisModels[0].componentIndex);\n          targetAxisIndexMap.set(axisDim, axisInfo);\n          needAuto = false;\n        }\n      }, this);\n    }\n  };\n\n  DataZoomModel.prototype._makeAutoOrientByTargetAxis = function () {\n    var dim; // Find the first axis\n\n    this.eachTargetAxis(function (axisDim) {\n      !dim && (dim = axisDim);\n    }, this);\n    return dim === 'y' ? 'vertical' : 'horizontal';\n  };\n\n  DataZoomModel.prototype._setDefaultThrottle = function (inputRawOption) {\n    // When first time user set throttle, auto throttle ends.\n    if (inputRawOption.hasOwnProperty('throttle')) {\n      this._autoThrottle = false;\n    }\n\n    if (this._autoThrottle) {\n      var globalOption = this.ecModel.option;\n      this.option.throttle = globalOption.animation && globalOption.animationDurationUpdate > 0 ? 100 : 20;\n    }\n  };\n\n  DataZoomModel.prototype._updateRangeUse = function (inputRawOption) {\n    var rangePropMode = this._rangePropMode;\n    var rangeModeInOption = this.get('rangeMode');\n    each([['start', 'startValue'], ['end', 'endValue']], function (names, index) {\n      var percentSpecified = inputRawOption[names[0]] != null;\n      var valueSpecified = inputRawOption[names[1]] != null;\n\n      if (percentSpecified && !valueSpecified) {\n        rangePropMode[index] = 'percent';\n      } else if (!percentSpecified && valueSpecified) {\n        rangePropMode[index] = 'value';\n      } else if (rangeModeInOption) {\n        rangePropMode[index] = rangeModeInOption[index];\n      } else if (percentSpecified) {\n        // percentSpecified && valueSpecified\n        rangePropMode[index] = 'percent';\n      } // else remain its original setting.\n\n    });\n  };\n\n  DataZoomModel.prototype.noTarget = function () {\n    return this._noTarget;\n  };\n\n  DataZoomModel.prototype.getFirstTargetAxisModel = function () {\n    var firstAxisModel;\n    this.eachTargetAxis(function (axisDim, axisIndex) {\n      if (firstAxisModel == null) {\n        firstAxisModel = this.ecModel.getComponent(getAxisMainType(axisDim), axisIndex);\n      }\n    }, this);\n    return firstAxisModel;\n  };\n  /**\n   * @param {Function} callback param: axisModel, dimNames, axisIndex, dataZoomModel, ecModel\n   */\n\n\n  DataZoomModel.prototype.eachTargetAxis = function (callback, context) {\n    this._targetAxisInfoMap.each(function (axisInfo, axisDim) {\n      each(axisInfo.indexList, function (axisIndex) {\n        callback.call(context, axisDim, axisIndex);\n      });\n    });\n  };\n  /**\n   * @return If not found, return null/undefined.\n   */\n\n\n  DataZoomModel.prototype.getAxisProxy = function (axisDim, axisIndex) {\n    var axisModel = this.getAxisModel(axisDim, axisIndex);\n\n    if (axisModel) {\n      return axisModel.__dzAxisProxy;\n    }\n  };\n  /**\n   * @return If not found, return null/undefined.\n   */\n\n\n  DataZoomModel.prototype.getAxisModel = function (axisDim, axisIndex) {\n    if (process.env.NODE_ENV !== 'production') {\n      assert(axisDim && axisIndex != null);\n    }\n\n    var axisInfo = this._targetAxisInfoMap.get(axisDim);\n\n    if (axisInfo && axisInfo.indexMap[axisIndex]) {\n      return this.ecModel.getComponent(getAxisMainType(axisDim), axisIndex);\n    }\n  };\n  /**\n   * If not specified, set to undefined.\n   */\n\n\n  DataZoomModel.prototype.setRawRange = function (opt) {\n    var thisOption = this.option;\n    var settledOption = this.settledOption;\n    each([['start', 'startValue'], ['end', 'endValue']], function (names) {\n      // Consider the pair <start, startValue>:\n      // If one has value and the other one is `null/undefined`, we both set them\n      // to `settledOption`. This strategy enables the feature to clear the original\n      // value in `settledOption` to `null/undefined`.\n      // But if both of them are `null/undefined`, we do not set them to `settledOption`\n      // and keep `settledOption` with the original value. This strategy enables users to\n      // only set <end or endValue> but not set <start or startValue> when calling\n      // `dispatchAction`.\n      // The pair <end, endValue> is treated in the same way.\n      if (opt[names[0]] != null || opt[names[1]] != null) {\n        thisOption[names[0]] = settledOption[names[0]] = opt[names[0]];\n        thisOption[names[1]] = settledOption[names[1]] = opt[names[1]];\n      }\n    }, this);\n\n    this._updateRangeUse(opt);\n  };\n\n  DataZoomModel.prototype.setCalculatedRange = function (opt) {\n    var option = this.option;\n    each(['start', 'startValue', 'end', 'endValue'], function (name) {\n      option[name] = opt[name];\n    });\n  };\n\n  DataZoomModel.prototype.getPercentRange = function () {\n    var axisProxy = this.findRepresentativeAxisProxy();\n\n    if (axisProxy) {\n      return axisProxy.getDataPercentWindow();\n    }\n  };\n  /**\n   * For example, chart.getModel().getComponent('dataZoom').getValueRange('y', 0);\n   *\n   * @return [startValue, endValue] value can only be '-' or finite number.\n   */\n\n\n  DataZoomModel.prototype.getValueRange = function (axisDim, axisIndex) {\n    if (axisDim == null && axisIndex == null) {\n      var axisProxy = this.findRepresentativeAxisProxy();\n\n      if (axisProxy) {\n        return axisProxy.getDataValueWindow();\n      }\n    } else {\n      return this.getAxisProxy(axisDim, axisIndex).getDataValueWindow();\n    }\n  };\n  /**\n   * @param axisModel If axisModel given, find axisProxy\n   *      corresponding to the axisModel\n   */\n\n\n  DataZoomModel.prototype.findRepresentativeAxisProxy = function (axisModel) {\n    if (axisModel) {\n      return axisModel.__dzAxisProxy;\n    } // Find the first hosted axisProxy\n\n\n    var firstProxy;\n\n    var axisDimList = this._targetAxisInfoMap.keys();\n\n    for (var i = 0; i < axisDimList.length; i++) {\n      var axisDim = axisDimList[i];\n\n      var axisInfo = this._targetAxisInfoMap.get(axisDim);\n\n      for (var j = 0; j < axisInfo.indexList.length; j++) {\n        var proxy = this.getAxisProxy(axisDim, axisInfo.indexList[j]);\n\n        if (proxy.hostedBy(this)) {\n          return proxy;\n        }\n\n        if (!firstProxy) {\n          firstProxy = proxy;\n        }\n      }\n    } // If no hosted proxy found, still need to return a proxy.\n    // This case always happens in toolbox dataZoom, where axes are all hosted by\n    // other dataZooms.\n\n\n    return firstProxy;\n  };\n\n  DataZoomModel.prototype.getRangePropMode = function () {\n    return this._rangePropMode.slice();\n  };\n\n  DataZoomModel.prototype.getOrient = function () {\n    if (process.env.NODE_ENV !== 'production') {\n      // Should not be called before initialized.\n      assert(this._orient);\n    }\n\n    return this._orient;\n  };\n\n  DataZoomModel.type = 'dataZoom';\n  DataZoomModel.dependencies = ['xAxis', 'yAxis', 'radiusAxis', 'angleAxis', 'singleAxis', 'series', 'toolbox'];\n  DataZoomModel.defaultOption = {\n    zlevel: 0,\n    z: 4,\n    filterMode: 'filter',\n    start: 0,\n    end: 100\n  };\n  return DataZoomModel;\n}(ComponentModel);\n/**\n * Retrieve the those raw params from option, which will be cached separately.\n * becasue they will be overwritten by normalized/calculated values in the main\n * process.\n */\n\n\nfunction retrieveRawOption(option) {\n  var ret = {};\n  each(['start', 'end', 'startValue', 'endValue', 'throttle'], function (name) {\n    option.hasOwnProperty(name) && (ret[name] = option[name]);\n  });\n  return ret;\n}\n\nexport default DataZoomModel;","map":{"version":3,"sources":["D:/桌面/react基础原理分析/react_extension/node_modules/echarts/lib/component/dataZoom/DataZoomModel.js"],"names":["__extends","each","createHashMap","merge","assert","ComponentModel","getAxisMainType","DATA_ZOOM_AXIS_DIMENSIONS","MULTIPLE_REFERRING","SINGLE_REFERRING","DataZoomAxisInfo","indexList","indexMap","prototype","add","axisCmptIdx","push","DataZoomModel","_super","_this","apply","arguments","type","_autoThrottle","_noTarget","_rangePropMode","init","option","parentModel","ecModel","inputRawOption","retrieveRawOption","settledOption","mergeDefaultAndTheme","_doInit","mergeOption","newOption","thisOption","_setDefaultThrottle","_updateRangeUse","names","index","_resetTarget","optionOrient","get","targetAxisIndexMap","_targetAxisInfoMap","hasAxisSpecified","_fillSpecifiedTargetAxis","_orient","_makeAutoOrientByTargetAxis","_fillAutoTargetAxisByOrient","axisInfo","length","axisDim","refering","getReferringComponents","specified","models","axisModel","componentIndex","set","orient","needAuto","axisModels","findComponents","mainType","setParallelAxis","filter","gridModel_1","axModel","dim","eachTargetAxis","hasOwnProperty","globalOption","throttle","animation","animationDurationUpdate","rangePropMode","rangeModeInOption","percentSpecified","valueSpecified","noTarget","getFirstTargetAxisModel","firstAxisModel","axisIndex","getComponent","callback","context","call","getAxisProxy","getAxisModel","__dzAxisProxy","process","env","NODE_ENV","setRawRange","opt","setCalculatedRange","name","getPercentRange","axisProxy","findRepresentativeAxisProxy","getDataPercentWindow","getValueRange","getDataValueWindow","firstProxy","axisDimList","keys","i","j","proxy","hostedBy","getRangePropMode","slice","getOrient","dependencies","defaultOption","zlevel","z","filterMode","start","end","ret"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\nimport { each, createHashMap, merge, assert } from 'zrender/lib/core/util';\nimport ComponentModel from '../../model/Component';\nimport { getAxisMainType, DATA_ZOOM_AXIS_DIMENSIONS } from './helper';\nimport { MULTIPLE_REFERRING, SINGLE_REFERRING } from '../../util/model';\n\nvar DataZoomAxisInfo =\n/** @class */\nfunction () {\n  function DataZoomAxisInfo() {\n    this.indexList = [];\n    this.indexMap = [];\n  }\n\n  DataZoomAxisInfo.prototype.add = function (axisCmptIdx) {\n    // Remove duplication.\n    if (!this.indexMap[axisCmptIdx]) {\n      this.indexList.push(axisCmptIdx);\n      this.indexMap[axisCmptIdx] = true;\n    }\n  };\n\n  return DataZoomAxisInfo;\n}();\n\nvar DataZoomModel =\n/** @class */\nfunction (_super) {\n  __extends(DataZoomModel, _super);\n\n  function DataZoomModel() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = DataZoomModel.type;\n    _this._autoThrottle = true;\n    _this._noTarget = true;\n    /**\n     * It is `[rangeModeForMin, rangeModeForMax]`.\n     * The optional values for `rangeMode`:\n     * + `'value'` mode: the axis extent will always be determined by\n     *     `dataZoom.startValue` and `dataZoom.endValue`, despite\n     *     how data like and how `axis.min` and `axis.max` are.\n     * + `'percent'` mode: `100` represents 100% of the `[dMin, dMax]`,\n     *     where `dMin` is `axis.min` if `axis.min` specified, otherwise `data.extent[0]`,\n     *     and `dMax` is `axis.max` if `axis.max` specified, otherwise `data.extent[1]`.\n     *     Axis extent will be determined by the result of the percent of `[dMin, dMax]`.\n     *\n     * For example, when users are using dynamic data (update data periodically via `setOption`),\n     * if in `'value`' mode, the window will be kept in a fixed value range despite how\n     * data are appended, while if in `'percent'` mode, whe window range will be changed alone with\n     * the appended data (suppose `axis.min` and `axis.max` are not specified).\n     */\n\n    _this._rangePropMode = ['percent', 'percent'];\n    return _this;\n  }\n\n  DataZoomModel.prototype.init = function (option, parentModel, ecModel) {\n    var inputRawOption = retrieveRawOption(option);\n    /**\n     * Suppose a \"main process\" start at the point that model prepared (that is,\n     * model initialized or merged or method called in `action`).\n     * We should keep the `main process` idempotent, that is, given a set of values\n     * on `option`, we get the same result.\n     *\n     * But sometimes, values on `option` will be updated for providing users\n     * a \"final calculated value\" (`dataZoomProcessor` will do that). Those value\n     * should not be the base/input of the `main process`.\n     *\n     * So in that case we should save and keep the input of the `main process`\n     * separately, called `settledOption`.\n     *\n     * For example, consider the case:\n     * (Step_1) brush zoom the grid by `toolbox.dataZoom`,\n     *     where the original input `option.startValue`, `option.endValue` are earsed by\n     *     calculated value.\n     * (Step)2) click the legend to hide and show a series,\n     *     where the new range is calculated by the earsed `startValue` and `endValue`,\n     *     which brings incorrect result.\n     */\n\n    this.settledOption = inputRawOption;\n    this.mergeDefaultAndTheme(option, ecModel);\n\n    this._doInit(inputRawOption);\n  };\n\n  DataZoomModel.prototype.mergeOption = function (newOption) {\n    var inputRawOption = retrieveRawOption(newOption); //FIX #2591\n\n    merge(this.option, newOption, true);\n    merge(this.settledOption, inputRawOption, true);\n\n    this._doInit(inputRawOption);\n  };\n\n  DataZoomModel.prototype._doInit = function (inputRawOption) {\n    var thisOption = this.option; // if (!env.canvasSupported) {\n    //     thisOption.realtime = false;\n    // }\n\n    this._setDefaultThrottle(inputRawOption);\n\n    this._updateRangeUse(inputRawOption);\n\n    var settledOption = this.settledOption;\n    each([['start', 'startValue'], ['end', 'endValue']], function (names, index) {\n      // start/end has higher priority over startValue/endValue if they\n      // both set, but we should make chart.setOption({endValue: 1000})\n      // effective, rather than chart.setOption({endValue: 1000, end: null}).\n      if (this._rangePropMode[index] === 'value') {\n        thisOption[names[0]] = settledOption[names[0]] = null;\n      } // Otherwise do nothing and use the merge result.\n\n    }, this);\n\n    this._resetTarget();\n  };\n\n  DataZoomModel.prototype._resetTarget = function () {\n    var optionOrient = this.get('orient', true);\n    var targetAxisIndexMap = this._targetAxisInfoMap = createHashMap();\n\n    var hasAxisSpecified = this._fillSpecifiedTargetAxis(targetAxisIndexMap);\n\n    if (hasAxisSpecified) {\n      this._orient = optionOrient || this._makeAutoOrientByTargetAxis();\n    } else {\n      this._orient = optionOrient || 'horizontal';\n\n      this._fillAutoTargetAxisByOrient(targetAxisIndexMap, this._orient);\n    }\n\n    this._noTarget = true;\n    targetAxisIndexMap.each(function (axisInfo) {\n      if (axisInfo.indexList.length) {\n        this._noTarget = false;\n      }\n    }, this);\n  };\n\n  DataZoomModel.prototype._fillSpecifiedTargetAxis = function (targetAxisIndexMap) {\n    var hasAxisSpecified = false;\n    each(DATA_ZOOM_AXIS_DIMENSIONS, function (axisDim) {\n      var refering = this.getReferringComponents(getAxisMainType(axisDim), MULTIPLE_REFERRING); // When user set axisIndex as a empty array, we think that user specify axisIndex\n      // but do not want use auto mode. Because empty array may be encountered when\n      // some error occured.\n\n      if (!refering.specified) {\n        return;\n      }\n\n      hasAxisSpecified = true;\n      var axisInfo = new DataZoomAxisInfo();\n      each(refering.models, function (axisModel) {\n        axisInfo.add(axisModel.componentIndex);\n      });\n      targetAxisIndexMap.set(axisDim, axisInfo);\n    }, this);\n    return hasAxisSpecified;\n  };\n\n  DataZoomModel.prototype._fillAutoTargetAxisByOrient = function (targetAxisIndexMap, orient) {\n    var ecModel = this.ecModel;\n    var needAuto = true; // Find axis that parallel to dataZoom as default.\n\n    if (needAuto) {\n      var axisDim = orient === 'vertical' ? 'y' : 'x';\n      var axisModels = ecModel.findComponents({\n        mainType: axisDim + 'Axis'\n      });\n      setParallelAxis(axisModels, axisDim);\n    } // Find axis that parallel to dataZoom as default.\n\n\n    if (needAuto) {\n      var axisModels = ecModel.findComponents({\n        mainType: 'singleAxis',\n        filter: function (axisModel) {\n          return axisModel.get('orient', true) === orient;\n        }\n      });\n      setParallelAxis(axisModels, 'single');\n    }\n\n    function setParallelAxis(axisModels, axisDim) {\n      // At least use the first parallel axis as the target axis.\n      var axisModel = axisModels[0];\n\n      if (!axisModel) {\n        return;\n      }\n\n      var axisInfo = new DataZoomAxisInfo();\n      axisInfo.add(axisModel.componentIndex);\n      targetAxisIndexMap.set(axisDim, axisInfo);\n      needAuto = false; // Find parallel axes in the same grid.\n\n      if (axisDim === 'x' || axisDim === 'y') {\n        var gridModel_1 = axisModel.getReferringComponents('grid', SINGLE_REFERRING).models[0];\n        gridModel_1 && each(axisModels, function (axModel) {\n          if (axisModel.componentIndex !== axModel.componentIndex && gridModel_1 === axModel.getReferringComponents('grid', SINGLE_REFERRING).models[0]) {\n            axisInfo.add(axModel.componentIndex);\n          }\n        });\n      }\n    }\n\n    if (needAuto) {\n      // If no parallel axis, find the first category axis as default. (Also consider polar).\n      each(DATA_ZOOM_AXIS_DIMENSIONS, function (axisDim) {\n        if (!needAuto) {\n          return;\n        }\n\n        var axisModels = ecModel.findComponents({\n          mainType: getAxisMainType(axisDim),\n          filter: function (axisModel) {\n            return axisModel.get('type', true) === 'category';\n          }\n        });\n\n        if (axisModels[0]) {\n          var axisInfo = new DataZoomAxisInfo();\n          axisInfo.add(axisModels[0].componentIndex);\n          targetAxisIndexMap.set(axisDim, axisInfo);\n          needAuto = false;\n        }\n      }, this);\n    }\n  };\n\n  DataZoomModel.prototype._makeAutoOrientByTargetAxis = function () {\n    var dim; // Find the first axis\n\n    this.eachTargetAxis(function (axisDim) {\n      !dim && (dim = axisDim);\n    }, this);\n    return dim === 'y' ? 'vertical' : 'horizontal';\n  };\n\n  DataZoomModel.prototype._setDefaultThrottle = function (inputRawOption) {\n    // When first time user set throttle, auto throttle ends.\n    if (inputRawOption.hasOwnProperty('throttle')) {\n      this._autoThrottle = false;\n    }\n\n    if (this._autoThrottle) {\n      var globalOption = this.ecModel.option;\n      this.option.throttle = globalOption.animation && globalOption.animationDurationUpdate > 0 ? 100 : 20;\n    }\n  };\n\n  DataZoomModel.prototype._updateRangeUse = function (inputRawOption) {\n    var rangePropMode = this._rangePropMode;\n    var rangeModeInOption = this.get('rangeMode');\n    each([['start', 'startValue'], ['end', 'endValue']], function (names, index) {\n      var percentSpecified = inputRawOption[names[0]] != null;\n      var valueSpecified = inputRawOption[names[1]] != null;\n\n      if (percentSpecified && !valueSpecified) {\n        rangePropMode[index] = 'percent';\n      } else if (!percentSpecified && valueSpecified) {\n        rangePropMode[index] = 'value';\n      } else if (rangeModeInOption) {\n        rangePropMode[index] = rangeModeInOption[index];\n      } else if (percentSpecified) {\n        // percentSpecified && valueSpecified\n        rangePropMode[index] = 'percent';\n      } // else remain its original setting.\n\n    });\n  };\n\n  DataZoomModel.prototype.noTarget = function () {\n    return this._noTarget;\n  };\n\n  DataZoomModel.prototype.getFirstTargetAxisModel = function () {\n    var firstAxisModel;\n    this.eachTargetAxis(function (axisDim, axisIndex) {\n      if (firstAxisModel == null) {\n        firstAxisModel = this.ecModel.getComponent(getAxisMainType(axisDim), axisIndex);\n      }\n    }, this);\n    return firstAxisModel;\n  };\n  /**\n   * @param {Function} callback param: axisModel, dimNames, axisIndex, dataZoomModel, ecModel\n   */\n\n\n  DataZoomModel.prototype.eachTargetAxis = function (callback, context) {\n    this._targetAxisInfoMap.each(function (axisInfo, axisDim) {\n      each(axisInfo.indexList, function (axisIndex) {\n        callback.call(context, axisDim, axisIndex);\n      });\n    });\n  };\n  /**\n   * @return If not found, return null/undefined.\n   */\n\n\n  DataZoomModel.prototype.getAxisProxy = function (axisDim, axisIndex) {\n    var axisModel = this.getAxisModel(axisDim, axisIndex);\n\n    if (axisModel) {\n      return axisModel.__dzAxisProxy;\n    }\n  };\n  /**\n   * @return If not found, return null/undefined.\n   */\n\n\n  DataZoomModel.prototype.getAxisModel = function (axisDim, axisIndex) {\n    if (process.env.NODE_ENV !== 'production') {\n      assert(axisDim && axisIndex != null);\n    }\n\n    var axisInfo = this._targetAxisInfoMap.get(axisDim);\n\n    if (axisInfo && axisInfo.indexMap[axisIndex]) {\n      return this.ecModel.getComponent(getAxisMainType(axisDim), axisIndex);\n    }\n  };\n  /**\n   * If not specified, set to undefined.\n   */\n\n\n  DataZoomModel.prototype.setRawRange = function (opt) {\n    var thisOption = this.option;\n    var settledOption = this.settledOption;\n    each([['start', 'startValue'], ['end', 'endValue']], function (names) {\n      // Consider the pair <start, startValue>:\n      // If one has value and the other one is `null/undefined`, we both set them\n      // to `settledOption`. This strategy enables the feature to clear the original\n      // value in `settledOption` to `null/undefined`.\n      // But if both of them are `null/undefined`, we do not set them to `settledOption`\n      // and keep `settledOption` with the original value. This strategy enables users to\n      // only set <end or endValue> but not set <start or startValue> when calling\n      // `dispatchAction`.\n      // The pair <end, endValue> is treated in the same way.\n      if (opt[names[0]] != null || opt[names[1]] != null) {\n        thisOption[names[0]] = settledOption[names[0]] = opt[names[0]];\n        thisOption[names[1]] = settledOption[names[1]] = opt[names[1]];\n      }\n    }, this);\n\n    this._updateRangeUse(opt);\n  };\n\n  DataZoomModel.prototype.setCalculatedRange = function (opt) {\n    var option = this.option;\n    each(['start', 'startValue', 'end', 'endValue'], function (name) {\n      option[name] = opt[name];\n    });\n  };\n\n  DataZoomModel.prototype.getPercentRange = function () {\n    var axisProxy = this.findRepresentativeAxisProxy();\n\n    if (axisProxy) {\n      return axisProxy.getDataPercentWindow();\n    }\n  };\n  /**\n   * For example, chart.getModel().getComponent('dataZoom').getValueRange('y', 0);\n   *\n   * @return [startValue, endValue] value can only be '-' or finite number.\n   */\n\n\n  DataZoomModel.prototype.getValueRange = function (axisDim, axisIndex) {\n    if (axisDim == null && axisIndex == null) {\n      var axisProxy = this.findRepresentativeAxisProxy();\n\n      if (axisProxy) {\n        return axisProxy.getDataValueWindow();\n      }\n    } else {\n      return this.getAxisProxy(axisDim, axisIndex).getDataValueWindow();\n    }\n  };\n  /**\n   * @param axisModel If axisModel given, find axisProxy\n   *      corresponding to the axisModel\n   */\n\n\n  DataZoomModel.prototype.findRepresentativeAxisProxy = function (axisModel) {\n    if (axisModel) {\n      return axisModel.__dzAxisProxy;\n    } // Find the first hosted axisProxy\n\n\n    var firstProxy;\n\n    var axisDimList = this._targetAxisInfoMap.keys();\n\n    for (var i = 0; i < axisDimList.length; i++) {\n      var axisDim = axisDimList[i];\n\n      var axisInfo = this._targetAxisInfoMap.get(axisDim);\n\n      for (var j = 0; j < axisInfo.indexList.length; j++) {\n        var proxy = this.getAxisProxy(axisDim, axisInfo.indexList[j]);\n\n        if (proxy.hostedBy(this)) {\n          return proxy;\n        }\n\n        if (!firstProxy) {\n          firstProxy = proxy;\n        }\n      }\n    } // If no hosted proxy found, still need to return a proxy.\n    // This case always happens in toolbox dataZoom, where axes are all hosted by\n    // other dataZooms.\n\n\n    return firstProxy;\n  };\n\n  DataZoomModel.prototype.getRangePropMode = function () {\n    return this._rangePropMode.slice();\n  };\n\n  DataZoomModel.prototype.getOrient = function () {\n    if (process.env.NODE_ENV !== 'production') {\n      // Should not be called before initialized.\n      assert(this._orient);\n    }\n\n    return this._orient;\n  };\n\n  DataZoomModel.type = 'dataZoom';\n  DataZoomModel.dependencies = ['xAxis', 'yAxis', 'radiusAxis', 'angleAxis', 'singleAxis', 'series', 'toolbox'];\n  DataZoomModel.defaultOption = {\n    zlevel: 0,\n    z: 4,\n    filterMode: 'filter',\n    start: 0,\n    end: 100\n  };\n  return DataZoomModel;\n}(ComponentModel);\n/**\n * Retrieve the those raw params from option, which will be cached separately.\n * becasue they will be overwritten by normalized/calculated values in the main\n * process.\n */\n\n\nfunction retrieveRawOption(option) {\n  var ret = {};\n  each(['start', 'end', 'startValue', 'endValue', 'throttle'], function (name) {\n    option.hasOwnProperty(name) && (ret[name] = option[name]);\n  });\n  return ret;\n}\n\nexport default DataZoomModel;"]},"metadata":{},"sourceType":"module"}