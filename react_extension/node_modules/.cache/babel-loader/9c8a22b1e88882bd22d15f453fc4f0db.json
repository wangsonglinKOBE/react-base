{"ast":null,"code":"/*!\n* ZRender, a high performance 2d drawing library.\n*\n* Copyright (c) 2013, Baidu Inc.\n* All rights reserved.\n*\n* LICENSE\n* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt\n*/\nimport env from './core/env';\nimport * as zrUtil from './core/util';\nimport Handler from './Handler';\nimport Storage from './Storage';\nimport Animation from './animation/Animation';\nimport HandlerProxy from './dom/HandlerProxy';\nimport { lum } from './tool/color';\nimport { DARK_MODE_THRESHOLD } from './config';\nimport Group from './graphic/Group';\nvar useVML = !env.canvasSupported;\nvar painterCtors = {};\nvar instances = {};\n\nfunction delInstance(id) {\n  delete instances[id];\n}\n\nfunction isDarkMode(backgroundColor) {\n  if (!backgroundColor) {\n    return false;\n  }\n\n  if (typeof backgroundColor === 'string') {\n    return lum(backgroundColor, 1) < DARK_MODE_THRESHOLD;\n  } else if (backgroundColor.colorStops) {\n    var colorStops = backgroundColor.colorStops;\n    var totalLum = 0;\n    var len = colorStops.length;\n\n    for (var i = 0; i < len; i++) {\n      totalLum += lum(colorStops[i].color, 1);\n    }\n\n    totalLum /= len;\n    return totalLum < DARK_MODE_THRESHOLD;\n  }\n\n  return false;\n}\n\nvar ZRender = function () {\n  function ZRender(id, dom, opts) {\n    var _this = this;\n\n    this._sleepAfterStill = 10;\n    this._stillFrameAccum = 0;\n    this._needsRefresh = true;\n    this._needsRefreshHover = true;\n    this._darkMode = false;\n    opts = opts || {};\n    this.dom = dom;\n    this.id = id;\n    var storage = new Storage();\n    var rendererType = opts.renderer || 'canvas';\n\n    if (useVML) {\n      throw new Error('IE8 support has been dropped since 5.0');\n    }\n\n    if (!painterCtors[rendererType]) {\n      rendererType = zrUtil.keys(painterCtors)[0];\n    }\n\n    if (!painterCtors[rendererType]) {\n      throw new Error(\"Renderer '\" + rendererType + \"' is not imported. Please import it first.\");\n    }\n\n    opts.useDirtyRect = opts.useDirtyRect == null ? false : opts.useDirtyRect;\n    var painter = new painterCtors[rendererType](dom, storage, opts, id);\n    this.storage = storage;\n    this.painter = painter;\n    var handerProxy = !env.node && !env.worker ? new HandlerProxy(painter.getViewportRoot(), painter.root) : null;\n    this.handler = new Handler(storage, painter, handerProxy, painter.root);\n    this.animation = new Animation({\n      stage: {\n        update: function () {\n          return _this._flush(true);\n        }\n      }\n    });\n    this.animation.start();\n  }\n\n  ZRender.prototype.add = function (el) {\n    if (!el) {\n      return;\n    }\n\n    this.storage.addRoot(el);\n    el.addSelfToZr(this);\n    this.refresh();\n  };\n\n  ZRender.prototype.remove = function (el) {\n    if (!el) {\n      return;\n    }\n\n    this.storage.delRoot(el);\n    el.removeSelfFromZr(this);\n    this.refresh();\n  };\n\n  ZRender.prototype.configLayer = function (zLevel, config) {\n    if (this.painter.configLayer) {\n      this.painter.configLayer(zLevel, config);\n    }\n\n    this.refresh();\n  };\n\n  ZRender.prototype.setBackgroundColor = function (backgroundColor) {\n    if (this.painter.setBackgroundColor) {\n      this.painter.setBackgroundColor(backgroundColor);\n    }\n\n    this.refresh();\n    this._backgroundColor = backgroundColor;\n    this._darkMode = isDarkMode(backgroundColor);\n  };\n\n  ZRender.prototype.getBackgroundColor = function () {\n    return this._backgroundColor;\n  };\n\n  ZRender.prototype.setDarkMode = function (darkMode) {\n    this._darkMode = darkMode;\n  };\n\n  ZRender.prototype.isDarkMode = function () {\n    return this._darkMode;\n  };\n\n  ZRender.prototype.refreshImmediately = function (fromInside) {\n    if (!fromInside) {\n      this.animation.update(true);\n    }\n\n    this._needsRefresh = false;\n    this.painter.refresh();\n    this._needsRefresh = false;\n  };\n\n  ZRender.prototype.refresh = function () {\n    this._needsRefresh = true;\n    this.animation.start();\n  };\n\n  ZRender.prototype.flush = function () {\n    this._flush(false);\n  };\n\n  ZRender.prototype._flush = function (fromInside) {\n    var triggerRendered;\n    var start = new Date().getTime();\n\n    if (this._needsRefresh) {\n      triggerRendered = true;\n      this.refreshImmediately(fromInside);\n    }\n\n    if (this._needsRefreshHover) {\n      triggerRendered = true;\n      this.refreshHoverImmediately();\n    }\n\n    var end = new Date().getTime();\n\n    if (triggerRendered) {\n      this._stillFrameAccum = 0;\n      this.trigger('rendered', {\n        elapsedTime: end - start\n      });\n    } else if (this._sleepAfterStill > 0) {\n      this._stillFrameAccum++;\n\n      if (this._stillFrameAccum > this._sleepAfterStill) {\n        this.animation.stop();\n      }\n    }\n  };\n\n  ZRender.prototype.setSleepAfterStill = function (stillFramesCount) {\n    this._sleepAfterStill = stillFramesCount;\n  };\n\n  ZRender.prototype.wakeUp = function () {\n    this.animation.start();\n    this._stillFrameAccum = 0;\n  };\n\n  ZRender.prototype.addHover = function (el) {};\n\n  ZRender.prototype.removeHover = function (el) {};\n\n  ZRender.prototype.clearHover = function () {};\n\n  ZRender.prototype.refreshHover = function () {\n    this._needsRefreshHover = true;\n  };\n\n  ZRender.prototype.refreshHoverImmediately = function () {\n    this._needsRefreshHover = false;\n\n    if (this.painter.refreshHover && this.painter.getType() === 'canvas') {\n      this.painter.refreshHover();\n    }\n  };\n\n  ZRender.prototype.resize = function (opts) {\n    opts = opts || {};\n    this.painter.resize(opts.width, opts.height);\n    this.handler.resize();\n  };\n\n  ZRender.prototype.clearAnimation = function () {\n    this.animation.clear();\n  };\n\n  ZRender.prototype.getWidth = function () {\n    return this.painter.getWidth();\n  };\n\n  ZRender.prototype.getHeight = function () {\n    return this.painter.getHeight();\n  };\n\n  ZRender.prototype.pathToImage = function (e, dpr) {\n    if (this.painter.pathToImage) {\n      return this.painter.pathToImage(e, dpr);\n    }\n  };\n\n  ZRender.prototype.setCursorStyle = function (cursorStyle) {\n    this.handler.setCursorStyle(cursorStyle);\n  };\n\n  ZRender.prototype.findHover = function (x, y) {\n    return this.handler.findHover(x, y);\n  };\n\n  ZRender.prototype.on = function (eventName, eventHandler, context) {\n    this.handler.on(eventName, eventHandler, context);\n    return this;\n  };\n\n  ZRender.prototype.off = function (eventName, eventHandler) {\n    this.handler.off(eventName, eventHandler);\n  };\n\n  ZRender.prototype.trigger = function (eventName, event) {\n    this.handler.trigger(eventName, event);\n  };\n\n  ZRender.prototype.clear = function () {\n    var roots = this.storage.getRoots();\n\n    for (var i = 0; i < roots.length; i++) {\n      if (roots[i] instanceof Group) {\n        roots[i].removeSelfFromZr(this);\n      }\n    }\n\n    this.storage.delAllRoots();\n    this.painter.clear();\n  };\n\n  ZRender.prototype.dispose = function () {\n    this.animation.stop();\n    this.clear();\n    this.storage.dispose();\n    this.painter.dispose();\n    this.handler.dispose();\n    this.animation = this.storage = this.painter = this.handler = null;\n    delInstance(this.id);\n  };\n\n  return ZRender;\n}();\n\nexport function init(dom, opts) {\n  var zr = new ZRender(zrUtil.guid(), dom, opts);\n  instances[zr.id] = zr;\n  return zr;\n}\nexport function dispose(zr) {\n  zr.dispose();\n}\nexport function disposeAll() {\n  for (var key in instances) {\n    if (instances.hasOwnProperty(key)) {\n      instances[key].dispose();\n    }\n  }\n\n  instances = {};\n}\nexport function getInstance(id) {\n  return instances[id];\n}\nexport function registerPainter(name, Ctor) {\n  painterCtors[name] = Ctor;\n}\nexport var version = '5.2.0';\n;","map":{"version":3,"sources":["D:/桌面/react基础原理分析/react_extension/node_modules/zrender/lib/zrender.js"],"names":["env","zrUtil","Handler","Storage","Animation","HandlerProxy","lum","DARK_MODE_THRESHOLD","Group","useVML","canvasSupported","painterCtors","instances","delInstance","id","isDarkMode","backgroundColor","colorStops","totalLum","len","length","i","color","ZRender","dom","opts","_this","_sleepAfterStill","_stillFrameAccum","_needsRefresh","_needsRefreshHover","_darkMode","storage","rendererType","renderer","Error","keys","useDirtyRect","painter","handerProxy","node","worker","getViewportRoot","root","handler","animation","stage","update","_flush","start","prototype","add","el","addRoot","addSelfToZr","refresh","remove","delRoot","removeSelfFromZr","configLayer","zLevel","config","setBackgroundColor","_backgroundColor","getBackgroundColor","setDarkMode","darkMode","refreshImmediately","fromInside","flush","triggerRendered","Date","getTime","refreshHoverImmediately","end","trigger","elapsedTime","stop","setSleepAfterStill","stillFramesCount","wakeUp","addHover","removeHover","clearHover","refreshHover","getType","resize","width","height","clearAnimation","clear","getWidth","getHeight","pathToImage","e","dpr","setCursorStyle","cursorStyle","findHover","x","y","on","eventName","eventHandler","context","off","event","roots","getRoots","delAllRoots","dispose","init","zr","guid","disposeAll","key","hasOwnProperty","getInstance","registerPainter","name","Ctor","version"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAOA,GAAP,MAAgB,YAAhB;AACA,OAAO,KAAKC,MAAZ,MAAwB,aAAxB;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,OAAOC,SAAP,MAAsB,uBAAtB;AACA,OAAOC,YAAP,MAAyB,oBAAzB;AACA,SAASC,GAAT,QAAoB,cAApB;AACA,SAASC,mBAAT,QAAoC,UAApC;AACA,OAAOC,KAAP,MAAkB,iBAAlB;AACA,IAAIC,MAAM,GAAG,CAACT,GAAG,CAACU,eAAlB;AACA,IAAIC,YAAY,GAAG,EAAnB;AACA,IAAIC,SAAS,GAAG,EAAhB;;AACA,SAASC,WAAT,CAAqBC,EAArB,EAAyB;AACrB,SAAOF,SAAS,CAACE,EAAD,CAAhB;AACH;;AACD,SAASC,UAAT,CAAoBC,eAApB,EAAqC;AACjC,MAAI,CAACA,eAAL,EAAsB;AAClB,WAAO,KAAP;AACH;;AACD,MAAI,OAAOA,eAAP,KAA2B,QAA/B,EAAyC;AACrC,WAAOV,GAAG,CAACU,eAAD,EAAkB,CAAlB,CAAH,GAA0BT,mBAAjC;AACH,GAFD,MAGK,IAAIS,eAAe,CAACC,UAApB,EAAgC;AACjC,QAAIA,UAAU,GAAGD,eAAe,CAACC,UAAjC;AACA,QAAIC,QAAQ,GAAG,CAAf;AACA,QAAIC,GAAG,GAAGF,UAAU,CAACG,MAArB;;AACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,GAApB,EAAyBE,CAAC,EAA1B,EAA8B;AAC1BH,MAAAA,QAAQ,IAAIZ,GAAG,CAACW,UAAU,CAACI,CAAD,CAAV,CAAcC,KAAf,EAAsB,CAAtB,CAAf;AACH;;AACDJ,IAAAA,QAAQ,IAAIC,GAAZ;AACA,WAAOD,QAAQ,GAAGX,mBAAlB;AACH;;AACD,SAAO,KAAP;AACH;;AACD,IAAIgB,OAAO,GAAI,YAAY;AACvB,WAASA,OAAT,CAAiBT,EAAjB,EAAqBU,GAArB,EAA0BC,IAA1B,EAAgC;AAC5B,QAAIC,KAAK,GAAG,IAAZ;;AACA,SAAKC,gBAAL,GAAwB,EAAxB;AACA,SAAKC,gBAAL,GAAwB,CAAxB;AACA,SAAKC,aAAL,GAAqB,IAArB;AACA,SAAKC,kBAAL,GAA0B,IAA1B;AACA,SAAKC,SAAL,GAAiB,KAAjB;AACAN,IAAAA,IAAI,GAAGA,IAAI,IAAI,EAAf;AACA,SAAKD,GAAL,GAAWA,GAAX;AACA,SAAKV,EAAL,GAAUA,EAAV;AACA,QAAIkB,OAAO,GAAG,IAAI7B,OAAJ,EAAd;AACA,QAAI8B,YAAY,GAAGR,IAAI,CAACS,QAAL,IAAiB,QAApC;;AACA,QAAIzB,MAAJ,EAAY;AACR,YAAM,IAAI0B,KAAJ,CAAU,wCAAV,CAAN;AACH;;AACD,QAAI,CAACxB,YAAY,CAACsB,YAAD,CAAjB,EAAiC;AAC7BA,MAAAA,YAAY,GAAGhC,MAAM,CAACmC,IAAP,CAAYzB,YAAZ,EAA0B,CAA1B,CAAf;AACH;;AACD,QAAI,CAACA,YAAY,CAACsB,YAAD,CAAjB,EAAiC;AAC7B,YAAM,IAAIE,KAAJ,CAAU,eAAeF,YAAf,GAA8B,4CAAxC,CAAN;AACH;;AACDR,IAAAA,IAAI,CAACY,YAAL,GAAoBZ,IAAI,CAACY,YAAL,IAAqB,IAArB,GACd,KADc,GAEdZ,IAAI,CAACY,YAFX;AAGA,QAAIC,OAAO,GAAG,IAAI3B,YAAY,CAACsB,YAAD,CAAhB,CAA+BT,GAA/B,EAAoCQ,OAApC,EAA6CP,IAA7C,EAAmDX,EAAnD,CAAd;AACA,SAAKkB,OAAL,GAAeA,OAAf;AACA,SAAKM,OAAL,GAAeA,OAAf;AACA,QAAIC,WAAW,GAAI,CAACvC,GAAG,CAACwC,IAAL,IAAa,CAACxC,GAAG,CAACyC,MAAnB,GACZ,IAAIpC,YAAJ,CAAiBiC,OAAO,CAACI,eAAR,EAAjB,EAA4CJ,OAAO,CAACK,IAApD,CADY,GAEZ,IAFN;AAGA,SAAKC,OAAL,GAAe,IAAI1C,OAAJ,CAAY8B,OAAZ,EAAqBM,OAArB,EAA8BC,WAA9B,EAA2CD,OAAO,CAACK,IAAnD,CAAf;AACA,SAAKE,SAAL,GAAiB,IAAIzC,SAAJ,CAAc;AAC3B0C,MAAAA,KAAK,EAAE;AACHC,QAAAA,MAAM,EAAE,YAAY;AAAE,iBAAOrB,KAAK,CAACsB,MAAN,CAAa,IAAb,CAAP;AAA4B;AAD/C;AADoB,KAAd,CAAjB;AAKA,SAAKH,SAAL,CAAeI,KAAf;AACH;;AACD1B,EAAAA,OAAO,CAAC2B,SAAR,CAAkBC,GAAlB,GAAwB,UAAUC,EAAV,EAAc;AAClC,QAAI,CAACA,EAAL,EAAS;AACL;AACH;;AACD,SAAKpB,OAAL,CAAaqB,OAAb,CAAqBD,EAArB;AACAA,IAAAA,EAAE,CAACE,WAAH,CAAe,IAAf;AACA,SAAKC,OAAL;AACH,GAPD;;AAQAhC,EAAAA,OAAO,CAAC2B,SAAR,CAAkBM,MAAlB,GAA2B,UAAUJ,EAAV,EAAc;AACrC,QAAI,CAACA,EAAL,EAAS;AACL;AACH;;AACD,SAAKpB,OAAL,CAAayB,OAAb,CAAqBL,EAArB;AACAA,IAAAA,EAAE,CAACM,gBAAH,CAAoB,IAApB;AACA,SAAKH,OAAL;AACH,GAPD;;AAQAhC,EAAAA,OAAO,CAAC2B,SAAR,CAAkBS,WAAlB,GAAgC,UAAUC,MAAV,EAAkBC,MAAlB,EAA0B;AACtD,QAAI,KAAKvB,OAAL,CAAaqB,WAAjB,EAA8B;AAC1B,WAAKrB,OAAL,CAAaqB,WAAb,CAAyBC,MAAzB,EAAiCC,MAAjC;AACH;;AACD,SAAKN,OAAL;AACH,GALD;;AAMAhC,EAAAA,OAAO,CAAC2B,SAAR,CAAkBY,kBAAlB,GAAuC,UAAU9C,eAAV,EAA2B;AAC9D,QAAI,KAAKsB,OAAL,CAAawB,kBAAjB,EAAqC;AACjC,WAAKxB,OAAL,CAAawB,kBAAb,CAAgC9C,eAAhC;AACH;;AACD,SAAKuC,OAAL;AACA,SAAKQ,gBAAL,GAAwB/C,eAAxB;AACA,SAAKe,SAAL,GAAiBhB,UAAU,CAACC,eAAD,CAA3B;AACH,GAPD;;AAQAO,EAAAA,OAAO,CAAC2B,SAAR,CAAkBc,kBAAlB,GAAuC,YAAY;AAC/C,WAAO,KAAKD,gBAAZ;AACH,GAFD;;AAGAxC,EAAAA,OAAO,CAAC2B,SAAR,CAAkBe,WAAlB,GAAgC,UAAUC,QAAV,EAAoB;AAChD,SAAKnC,SAAL,GAAiBmC,QAAjB;AACH,GAFD;;AAGA3C,EAAAA,OAAO,CAAC2B,SAAR,CAAkBnC,UAAlB,GAA+B,YAAY;AACvC,WAAO,KAAKgB,SAAZ;AACH,GAFD;;AAGAR,EAAAA,OAAO,CAAC2B,SAAR,CAAkBiB,kBAAlB,GAAuC,UAAUC,UAAV,EAAsB;AACzD,QAAI,CAACA,UAAL,EAAiB;AACb,WAAKvB,SAAL,CAAeE,MAAf,CAAsB,IAAtB;AACH;;AACD,SAAKlB,aAAL,GAAqB,KAArB;AACA,SAAKS,OAAL,CAAaiB,OAAb;AACA,SAAK1B,aAAL,GAAqB,KAArB;AACH,GAPD;;AAQAN,EAAAA,OAAO,CAAC2B,SAAR,CAAkBK,OAAlB,GAA4B,YAAY;AACpC,SAAK1B,aAAL,GAAqB,IAArB;AACA,SAAKgB,SAAL,CAAeI,KAAf;AACH,GAHD;;AAIA1B,EAAAA,OAAO,CAAC2B,SAAR,CAAkBmB,KAAlB,GAA0B,YAAY;AAClC,SAAKrB,MAAL,CAAY,KAAZ;AACH,GAFD;;AAGAzB,EAAAA,OAAO,CAAC2B,SAAR,CAAkBF,MAAlB,GAA2B,UAAUoB,UAAV,EAAsB;AAC7C,QAAIE,eAAJ;AACA,QAAIrB,KAAK,GAAG,IAAIsB,IAAJ,GAAWC,OAAX,EAAZ;;AACA,QAAI,KAAK3C,aAAT,EAAwB;AACpByC,MAAAA,eAAe,GAAG,IAAlB;AACA,WAAKH,kBAAL,CAAwBC,UAAxB;AACH;;AACD,QAAI,KAAKtC,kBAAT,EAA6B;AACzBwC,MAAAA,eAAe,GAAG,IAAlB;AACA,WAAKG,uBAAL;AACH;;AACD,QAAIC,GAAG,GAAG,IAAIH,IAAJ,GAAWC,OAAX,EAAV;;AACA,QAAIF,eAAJ,EAAqB;AACjB,WAAK1C,gBAAL,GAAwB,CAAxB;AACA,WAAK+C,OAAL,CAAa,UAAb,EAAyB;AACrBC,QAAAA,WAAW,EAAEF,GAAG,GAAGzB;AADE,OAAzB;AAGH,KALD,MAMK,IAAI,KAAKtB,gBAAL,GAAwB,CAA5B,EAA+B;AAChC,WAAKC,gBAAL;;AACA,UAAI,KAAKA,gBAAL,GAAwB,KAAKD,gBAAjC,EAAmD;AAC/C,aAAKkB,SAAL,CAAegC,IAAf;AACH;AACJ;AACJ,GAxBD;;AAyBAtD,EAAAA,OAAO,CAAC2B,SAAR,CAAkB4B,kBAAlB,GAAuC,UAAUC,gBAAV,EAA4B;AAC/D,SAAKpD,gBAAL,GAAwBoD,gBAAxB;AACH,GAFD;;AAGAxD,EAAAA,OAAO,CAAC2B,SAAR,CAAkB8B,MAAlB,GAA2B,YAAY;AACnC,SAAKnC,SAAL,CAAeI,KAAf;AACA,SAAKrB,gBAAL,GAAwB,CAAxB;AACH,GAHD;;AAIAL,EAAAA,OAAO,CAAC2B,SAAR,CAAkB+B,QAAlB,GAA6B,UAAU7B,EAAV,EAAc,CAC1C,CADD;;AAEA7B,EAAAA,OAAO,CAAC2B,SAAR,CAAkBgC,WAAlB,GAAgC,UAAU9B,EAAV,EAAc,CAC7C,CADD;;AAEA7B,EAAAA,OAAO,CAAC2B,SAAR,CAAkBiC,UAAlB,GAA+B,YAAY,CAC1C,CADD;;AAEA5D,EAAAA,OAAO,CAAC2B,SAAR,CAAkBkC,YAAlB,GAAiC,YAAY;AACzC,SAAKtD,kBAAL,GAA0B,IAA1B;AACH,GAFD;;AAGAP,EAAAA,OAAO,CAAC2B,SAAR,CAAkBuB,uBAAlB,GAA4C,YAAY;AACpD,SAAK3C,kBAAL,GAA0B,KAA1B;;AACA,QAAI,KAAKQ,OAAL,CAAa8C,YAAb,IAA6B,KAAK9C,OAAL,CAAa+C,OAAb,OAA2B,QAA5D,EAAsE;AAClE,WAAK/C,OAAL,CAAa8C,YAAb;AACH;AACJ,GALD;;AAMA7D,EAAAA,OAAO,CAAC2B,SAAR,CAAkBoC,MAAlB,GAA2B,UAAU7D,IAAV,EAAgB;AACvCA,IAAAA,IAAI,GAAGA,IAAI,IAAI,EAAf;AACA,SAAKa,OAAL,CAAagD,MAAb,CAAoB7D,IAAI,CAAC8D,KAAzB,EAAgC9D,IAAI,CAAC+D,MAArC;AACA,SAAK5C,OAAL,CAAa0C,MAAb;AACH,GAJD;;AAKA/D,EAAAA,OAAO,CAAC2B,SAAR,CAAkBuC,cAAlB,GAAmC,YAAY;AAC3C,SAAK5C,SAAL,CAAe6C,KAAf;AACH,GAFD;;AAGAnE,EAAAA,OAAO,CAAC2B,SAAR,CAAkByC,QAAlB,GAA6B,YAAY;AACrC,WAAO,KAAKrD,OAAL,CAAaqD,QAAb,EAAP;AACH,GAFD;;AAGApE,EAAAA,OAAO,CAAC2B,SAAR,CAAkB0C,SAAlB,GAA8B,YAAY;AACtC,WAAO,KAAKtD,OAAL,CAAasD,SAAb,EAAP;AACH,GAFD;;AAGArE,EAAAA,OAAO,CAAC2B,SAAR,CAAkB2C,WAAlB,GAAgC,UAAUC,CAAV,EAAaC,GAAb,EAAkB;AAC9C,QAAI,KAAKzD,OAAL,CAAauD,WAAjB,EAA8B;AAC1B,aAAO,KAAKvD,OAAL,CAAauD,WAAb,CAAyBC,CAAzB,EAA4BC,GAA5B,CAAP;AACH;AACJ,GAJD;;AAKAxE,EAAAA,OAAO,CAAC2B,SAAR,CAAkB8C,cAAlB,GAAmC,UAAUC,WAAV,EAAuB;AACtD,SAAKrD,OAAL,CAAaoD,cAAb,CAA4BC,WAA5B;AACH,GAFD;;AAGA1E,EAAAA,OAAO,CAAC2B,SAAR,CAAkBgD,SAAlB,GAA8B,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AAC1C,WAAO,KAAKxD,OAAL,CAAasD,SAAb,CAAuBC,CAAvB,EAA0BC,CAA1B,CAAP;AACH,GAFD;;AAGA7E,EAAAA,OAAO,CAAC2B,SAAR,CAAkBmD,EAAlB,GAAuB,UAAUC,SAAV,EAAqBC,YAArB,EAAmCC,OAAnC,EAA4C;AAC/D,SAAK5D,OAAL,CAAayD,EAAb,CAAgBC,SAAhB,EAA2BC,YAA3B,EAAyCC,OAAzC;AACA,WAAO,IAAP;AACH,GAHD;;AAIAjF,EAAAA,OAAO,CAAC2B,SAAR,CAAkBuD,GAAlB,GAAwB,UAAUH,SAAV,EAAqBC,YAArB,EAAmC;AACvD,SAAK3D,OAAL,CAAa6D,GAAb,CAAiBH,SAAjB,EAA4BC,YAA5B;AACH,GAFD;;AAGAhF,EAAAA,OAAO,CAAC2B,SAAR,CAAkByB,OAAlB,GAA4B,UAAU2B,SAAV,EAAqBI,KAArB,EAA4B;AACpD,SAAK9D,OAAL,CAAa+B,OAAb,CAAqB2B,SAArB,EAAgCI,KAAhC;AACH,GAFD;;AAGAnF,EAAAA,OAAO,CAAC2B,SAAR,CAAkBwC,KAAlB,GAA0B,YAAY;AAClC,QAAIiB,KAAK,GAAG,KAAK3E,OAAL,CAAa4E,QAAb,EAAZ;;AACA,SAAK,IAAIvF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsF,KAAK,CAACvF,MAA1B,EAAkCC,CAAC,EAAnC,EAAuC;AACnC,UAAIsF,KAAK,CAACtF,CAAD,CAAL,YAAoBb,KAAxB,EAA+B;AAC3BmG,QAAAA,KAAK,CAACtF,CAAD,CAAL,CAASqC,gBAAT,CAA0B,IAA1B;AACH;AACJ;;AACD,SAAK1B,OAAL,CAAa6E,WAAb;AACA,SAAKvE,OAAL,CAAaoD,KAAb;AACH,GATD;;AAUAnE,EAAAA,OAAO,CAAC2B,SAAR,CAAkB4D,OAAlB,GAA4B,YAAY;AACpC,SAAKjE,SAAL,CAAegC,IAAf;AACA,SAAKa,KAAL;AACA,SAAK1D,OAAL,CAAa8E,OAAb;AACA,SAAKxE,OAAL,CAAawE,OAAb;AACA,SAAKlE,OAAL,CAAakE,OAAb;AACA,SAAKjE,SAAL,GACI,KAAKb,OAAL,GACI,KAAKM,OAAL,GACI,KAAKM,OAAL,GAAe,IAH3B;AAIA/B,IAAAA,WAAW,CAAC,KAAKC,EAAN,CAAX;AACH,GAXD;;AAYA,SAAOS,OAAP;AACH,CAtMc,EAAf;;AAuMA,OAAO,SAASwF,IAAT,CAAcvF,GAAd,EAAmBC,IAAnB,EAAyB;AAC5B,MAAIuF,EAAE,GAAG,IAAIzF,OAAJ,CAAYtB,MAAM,CAACgH,IAAP,EAAZ,EAA2BzF,GAA3B,EAAgCC,IAAhC,CAAT;AACAb,EAAAA,SAAS,CAACoG,EAAE,CAAClG,EAAJ,CAAT,GAAmBkG,EAAnB;AACA,SAAOA,EAAP;AACH;AACD,OAAO,SAASF,OAAT,CAAiBE,EAAjB,EAAqB;AACxBA,EAAAA,EAAE,CAACF,OAAH;AACH;AACD,OAAO,SAASI,UAAT,GAAsB;AACzB,OAAK,IAAIC,GAAT,IAAgBvG,SAAhB,EAA2B;AACvB,QAAIA,SAAS,CAACwG,cAAV,CAAyBD,GAAzB,CAAJ,EAAmC;AAC/BvG,MAAAA,SAAS,CAACuG,GAAD,CAAT,CAAeL,OAAf;AACH;AACJ;;AACDlG,EAAAA,SAAS,GAAG,EAAZ;AACH;AACD,OAAO,SAASyG,WAAT,CAAqBvG,EAArB,EAAyB;AAC5B,SAAOF,SAAS,CAACE,EAAD,CAAhB;AACH;AACD,OAAO,SAASwG,eAAT,CAAyBC,IAAzB,EAA+BC,IAA/B,EAAqC;AACxC7G,EAAAA,YAAY,CAAC4G,IAAD,CAAZ,GAAqBC,IAArB;AACH;AACD,OAAO,IAAIC,OAAO,GAAG,OAAd;AACP","sourcesContent":["/*!\n* ZRender, a high performance 2d drawing library.\n*\n* Copyright (c) 2013, Baidu Inc.\n* All rights reserved.\n*\n* LICENSE\n* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt\n*/\nimport env from './core/env';\nimport * as zrUtil from './core/util';\nimport Handler from './Handler';\nimport Storage from './Storage';\nimport Animation from './animation/Animation';\nimport HandlerProxy from './dom/HandlerProxy';\nimport { lum } from './tool/color';\nimport { DARK_MODE_THRESHOLD } from './config';\nimport Group from './graphic/Group';\nvar useVML = !env.canvasSupported;\nvar painterCtors = {};\nvar instances = {};\nfunction delInstance(id) {\n    delete instances[id];\n}\nfunction isDarkMode(backgroundColor) {\n    if (!backgroundColor) {\n        return false;\n    }\n    if (typeof backgroundColor === 'string') {\n        return lum(backgroundColor, 1) < DARK_MODE_THRESHOLD;\n    }\n    else if (backgroundColor.colorStops) {\n        var colorStops = backgroundColor.colorStops;\n        var totalLum = 0;\n        var len = colorStops.length;\n        for (var i = 0; i < len; i++) {\n            totalLum += lum(colorStops[i].color, 1);\n        }\n        totalLum /= len;\n        return totalLum < DARK_MODE_THRESHOLD;\n    }\n    return false;\n}\nvar ZRender = (function () {\n    function ZRender(id, dom, opts) {\n        var _this = this;\n        this._sleepAfterStill = 10;\n        this._stillFrameAccum = 0;\n        this._needsRefresh = true;\n        this._needsRefreshHover = true;\n        this._darkMode = false;\n        opts = opts || {};\n        this.dom = dom;\n        this.id = id;\n        var storage = new Storage();\n        var rendererType = opts.renderer || 'canvas';\n        if (useVML) {\n            throw new Error('IE8 support has been dropped since 5.0');\n        }\n        if (!painterCtors[rendererType]) {\n            rendererType = zrUtil.keys(painterCtors)[0];\n        }\n        if (!painterCtors[rendererType]) {\n            throw new Error(\"Renderer '\" + rendererType + \"' is not imported. Please import it first.\");\n        }\n        opts.useDirtyRect = opts.useDirtyRect == null\n            ? false\n            : opts.useDirtyRect;\n        var painter = new painterCtors[rendererType](dom, storage, opts, id);\n        this.storage = storage;\n        this.painter = painter;\n        var handerProxy = (!env.node && !env.worker)\n            ? new HandlerProxy(painter.getViewportRoot(), painter.root)\n            : null;\n        this.handler = new Handler(storage, painter, handerProxy, painter.root);\n        this.animation = new Animation({\n            stage: {\n                update: function () { return _this._flush(true); }\n            }\n        });\n        this.animation.start();\n    }\n    ZRender.prototype.add = function (el) {\n        if (!el) {\n            return;\n        }\n        this.storage.addRoot(el);\n        el.addSelfToZr(this);\n        this.refresh();\n    };\n    ZRender.prototype.remove = function (el) {\n        if (!el) {\n            return;\n        }\n        this.storage.delRoot(el);\n        el.removeSelfFromZr(this);\n        this.refresh();\n    };\n    ZRender.prototype.configLayer = function (zLevel, config) {\n        if (this.painter.configLayer) {\n            this.painter.configLayer(zLevel, config);\n        }\n        this.refresh();\n    };\n    ZRender.prototype.setBackgroundColor = function (backgroundColor) {\n        if (this.painter.setBackgroundColor) {\n            this.painter.setBackgroundColor(backgroundColor);\n        }\n        this.refresh();\n        this._backgroundColor = backgroundColor;\n        this._darkMode = isDarkMode(backgroundColor);\n    };\n    ZRender.prototype.getBackgroundColor = function () {\n        return this._backgroundColor;\n    };\n    ZRender.prototype.setDarkMode = function (darkMode) {\n        this._darkMode = darkMode;\n    };\n    ZRender.prototype.isDarkMode = function () {\n        return this._darkMode;\n    };\n    ZRender.prototype.refreshImmediately = function (fromInside) {\n        if (!fromInside) {\n            this.animation.update(true);\n        }\n        this._needsRefresh = false;\n        this.painter.refresh();\n        this._needsRefresh = false;\n    };\n    ZRender.prototype.refresh = function () {\n        this._needsRefresh = true;\n        this.animation.start();\n    };\n    ZRender.prototype.flush = function () {\n        this._flush(false);\n    };\n    ZRender.prototype._flush = function (fromInside) {\n        var triggerRendered;\n        var start = new Date().getTime();\n        if (this._needsRefresh) {\n            triggerRendered = true;\n            this.refreshImmediately(fromInside);\n        }\n        if (this._needsRefreshHover) {\n            triggerRendered = true;\n            this.refreshHoverImmediately();\n        }\n        var end = new Date().getTime();\n        if (triggerRendered) {\n            this._stillFrameAccum = 0;\n            this.trigger('rendered', {\n                elapsedTime: end - start\n            });\n        }\n        else if (this._sleepAfterStill > 0) {\n            this._stillFrameAccum++;\n            if (this._stillFrameAccum > this._sleepAfterStill) {\n                this.animation.stop();\n            }\n        }\n    };\n    ZRender.prototype.setSleepAfterStill = function (stillFramesCount) {\n        this._sleepAfterStill = stillFramesCount;\n    };\n    ZRender.prototype.wakeUp = function () {\n        this.animation.start();\n        this._stillFrameAccum = 0;\n    };\n    ZRender.prototype.addHover = function (el) {\n    };\n    ZRender.prototype.removeHover = function (el) {\n    };\n    ZRender.prototype.clearHover = function () {\n    };\n    ZRender.prototype.refreshHover = function () {\n        this._needsRefreshHover = true;\n    };\n    ZRender.prototype.refreshHoverImmediately = function () {\n        this._needsRefreshHover = false;\n        if (this.painter.refreshHover && this.painter.getType() === 'canvas') {\n            this.painter.refreshHover();\n        }\n    };\n    ZRender.prototype.resize = function (opts) {\n        opts = opts || {};\n        this.painter.resize(opts.width, opts.height);\n        this.handler.resize();\n    };\n    ZRender.prototype.clearAnimation = function () {\n        this.animation.clear();\n    };\n    ZRender.prototype.getWidth = function () {\n        return this.painter.getWidth();\n    };\n    ZRender.prototype.getHeight = function () {\n        return this.painter.getHeight();\n    };\n    ZRender.prototype.pathToImage = function (e, dpr) {\n        if (this.painter.pathToImage) {\n            return this.painter.pathToImage(e, dpr);\n        }\n    };\n    ZRender.prototype.setCursorStyle = function (cursorStyle) {\n        this.handler.setCursorStyle(cursorStyle);\n    };\n    ZRender.prototype.findHover = function (x, y) {\n        return this.handler.findHover(x, y);\n    };\n    ZRender.prototype.on = function (eventName, eventHandler, context) {\n        this.handler.on(eventName, eventHandler, context);\n        return this;\n    };\n    ZRender.prototype.off = function (eventName, eventHandler) {\n        this.handler.off(eventName, eventHandler);\n    };\n    ZRender.prototype.trigger = function (eventName, event) {\n        this.handler.trigger(eventName, event);\n    };\n    ZRender.prototype.clear = function () {\n        var roots = this.storage.getRoots();\n        for (var i = 0; i < roots.length; i++) {\n            if (roots[i] instanceof Group) {\n                roots[i].removeSelfFromZr(this);\n            }\n        }\n        this.storage.delAllRoots();\n        this.painter.clear();\n    };\n    ZRender.prototype.dispose = function () {\n        this.animation.stop();\n        this.clear();\n        this.storage.dispose();\n        this.painter.dispose();\n        this.handler.dispose();\n        this.animation =\n            this.storage =\n                this.painter =\n                    this.handler = null;\n        delInstance(this.id);\n    };\n    return ZRender;\n}());\nexport function init(dom, opts) {\n    var zr = new ZRender(zrUtil.guid(), dom, opts);\n    instances[zr.id] = zr;\n    return zr;\n}\nexport function dispose(zr) {\n    zr.dispose();\n}\nexport function disposeAll() {\n    for (var key in instances) {\n        if (instances.hasOwnProperty(key)) {\n            instances[key].dispose();\n        }\n    }\n    instances = {};\n}\nexport function getInstance(id) {\n    return instances[id];\n}\nexport function registerPainter(name, Ctor) {\n    painterCtors[name] = Ctor;\n}\nexport var version = '5.2.0';\n;\n"]},"metadata":{},"sourceType":"module"}