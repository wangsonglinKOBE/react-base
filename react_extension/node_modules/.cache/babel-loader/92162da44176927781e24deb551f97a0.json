{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\nimport * as zrUtil from 'zrender/lib/core/util';\nimport * as modelUtil from '../../util/model';\nimport * as graphicUtil from '../../util/graphic';\nimport * as layoutUtil from '../../util/layout';\nimport { parsePercent } from '../../util/number';\nimport ComponentModel from '../../model/Component';\nimport ComponentView from '../../view/Component';\nimport { getECData } from '../../util/innerStore';\nimport { isEC4CompatibleStyle, convertFromEC4CompatibleStyle } from '../../util/styleCompat';\nvar TRANSFORM_PROPS = {\n  x: 1,\n  y: 1,\n  scaleX: 1,\n  scaleY: 1,\n  originX: 1,\n  originY: 1,\n  rotation: 1\n};\n;\nvar inner = modelUtil.makeInner();\nvar _nonShapeGraphicElements = {\n  // Reserved but not supported in graphic component.\n  path: null,\n  compoundPath: null,\n  // Supported in graphic component.\n  group: graphicUtil.Group,\n  image: graphicUtil.Image,\n  text: graphicUtil.Text\n}; // ------------------------\n// Preprocessor\n// ------------------------\n\nvar preprocessor = function (option) {\n  var graphicOption = option.graphic; // Convert\n  // {graphic: [{left: 10, type: 'circle'}, ...]}\n  // or\n  // {graphic: {left: 10, type: 'circle'}}\n  // to\n  // {graphic: [{elements: [{left: 10, type: 'circle'}, ...]}]}\n\n  if (zrUtil.isArray(graphicOption)) {\n    if (!graphicOption[0] || !graphicOption[0].elements) {\n      option.graphic = [{\n        elements: graphicOption\n      }];\n    } else {\n      // Only one graphic instance can be instantiated. (We dont\n      // want that too many views are created in echarts._viewMap)\n      option.graphic = [option.graphic[0]];\n    }\n  } else if (graphicOption && !graphicOption.elements) {\n    option.graphic = [{\n      elements: [graphicOption]\n    }];\n  }\n};\n\n;\n\nvar GraphicComponentModel =\n/** @class */\nfunction (_super) {\n  __extends(GraphicComponentModel, _super);\n\n  function GraphicComponentModel() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = GraphicComponentModel.type;\n    _this.preventAutoZ = true;\n    return _this;\n  }\n\n  GraphicComponentModel.prototype.mergeOption = function (option, ecModel) {\n    // Prevent default merge to elements\n    var elements = this.option.elements;\n    this.option.elements = null;\n\n    _super.prototype.mergeOption.call(this, option, ecModel);\n\n    this.option.elements = elements;\n  };\n\n  GraphicComponentModel.prototype.optionUpdated = function (newOption, isInit) {\n    var thisOption = this.option;\n    var newList = (isInit ? thisOption : newOption).elements;\n    var existList = thisOption.elements = isInit ? [] : thisOption.elements;\n    var flattenedList = [];\n\n    this._flatten(newList, flattenedList, null);\n\n    var mappingResult = modelUtil.mappingToExists(existList, flattenedList, 'normalMerge'); // Clear elOptionsToUpdate\n\n    var elOptionsToUpdate = this._elOptionsToUpdate = [];\n    zrUtil.each(mappingResult, function (resultItem, index) {\n      var newElOption = resultItem.newOption;\n\n      if (process.env.NODE_ENV !== 'production') {\n        zrUtil.assert(zrUtil.isObject(newElOption) || resultItem.existing, 'Empty graphic option definition');\n      }\n\n      if (!newElOption) {\n        return;\n      }\n\n      elOptionsToUpdate.push(newElOption);\n      setKeyInfoToNewElOption(resultItem, newElOption);\n      mergeNewElOptionToExist(existList, index, newElOption);\n      setLayoutInfoToExist(existList[index], newElOption);\n    }, this); // Clean\n\n    for (var i = existList.length - 1; i >= 0; i--) {\n      if (existList[i] == null) {\n        existList.splice(i, 1);\n      } else {\n        // $action should be volatile, otherwise option gotten from\n        // `getOption` will contain unexpected $action.\n        delete existList[i].$action;\n      }\n    }\n  };\n  /**\n   * Convert\n   * [{\n   *  type: 'group',\n   *  id: 'xx',\n   *  children: [{type: 'circle'}, {type: 'polygon'}]\n   * }]\n   * to\n   * [\n   *  {type: 'group', id: 'xx'},\n   *  {type: 'circle', parentId: 'xx'},\n   *  {type: 'polygon', parentId: 'xx'}\n   * ]\n   */\n\n\n  GraphicComponentModel.prototype._flatten = function (optionList, result, parentOption) {\n    zrUtil.each(optionList, function (option) {\n      if (!option) {\n        return;\n      }\n\n      if (parentOption) {\n        option.parentOption = parentOption;\n      }\n\n      result.push(option);\n      var children = option.children;\n\n      if (option.type === 'group' && children) {\n        this._flatten(children, result, option);\n      } // Deleting for JSON output, and for not affecting group creation.\n\n\n      delete option.children;\n    }, this);\n  }; // FIXME\n  // Pass to view using payload? setOption has a payload?\n\n\n  GraphicComponentModel.prototype.useElOptionsToUpdate = function () {\n    var els = this._elOptionsToUpdate; // Clear to avoid render duplicately when zooming.\n\n    this._elOptionsToUpdate = null;\n    return els;\n  };\n\n  GraphicComponentModel.type = 'graphic';\n  GraphicComponentModel.defaultOption = {\n    elements: [] // parentId: null\n\n  };\n  return GraphicComponentModel;\n}(ComponentModel); // ------------------------\n// View\n// ------------------------\n\n\nvar GraphicComponentView =\n/** @class */\nfunction (_super) {\n  __extends(GraphicComponentView, _super);\n\n  function GraphicComponentView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = GraphicComponentView.type;\n    return _this;\n  }\n\n  GraphicComponentView.prototype.init = function () {\n    this._elMap = zrUtil.createHashMap();\n  };\n\n  GraphicComponentView.prototype.render = function (graphicModel, ecModel, api) {\n    // Having leveraged between use cases and algorithm complexity, a very\n    // simple layout mechanism is used:\n    // The size(width/height) can be determined by itself or its parent (not\n    // implemented yet), but can not by its children. (Top-down travel)\n    // The location(x/y) can be determined by the bounding rect of itself\n    // (can including its descendants or not) and the size of its parent.\n    // (Bottom-up travel)\n    // When `chart.clear()` or `chart.setOption({...}, true)` with the same id,\n    // view will be reused.\n    if (graphicModel !== this._lastGraphicModel) {\n      this._clear();\n    }\n\n    this._lastGraphicModel = graphicModel;\n\n    this._updateElements(graphicModel);\n\n    this._relocate(graphicModel, api);\n  };\n  /**\n   * Update graphic elements.\n   */\n\n\n  GraphicComponentView.prototype._updateElements = function (graphicModel) {\n    var elOptionsToUpdate = graphicModel.useElOptionsToUpdate();\n\n    if (!elOptionsToUpdate) {\n      return;\n    }\n\n    var elMap = this._elMap;\n    var rootGroup = this.group; // Top-down tranverse to assign graphic settings to each elements.\n\n    zrUtil.each(elOptionsToUpdate, function (elOption) {\n      var id = modelUtil.convertOptionIdName(elOption.id, null);\n      var elExisting = id != null ? elMap.get(id) : null;\n      var parentId = modelUtil.convertOptionIdName(elOption.parentId, null);\n      var targetElParent = parentId != null ? elMap.get(parentId) : rootGroup;\n      var elType = elOption.type;\n      var elOptionStyle = elOption.style;\n\n      if (elType === 'text' && elOptionStyle) {\n        // In top/bottom mode, textVerticalAlign should not be used, which cause\n        // inaccurately locating.\n        if (elOption.hv && elOption.hv[1]) {\n          elOptionStyle.textVerticalAlign = elOptionStyle.textBaseline = elOptionStyle.verticalAlign = elOptionStyle.align = null;\n        }\n      }\n\n      var textContentOption = elOption.textContent;\n      var textConfig = elOption.textConfig;\n\n      if (elOptionStyle && isEC4CompatibleStyle(elOptionStyle, elType, !!textConfig, !!textContentOption)) {\n        var convertResult = convertFromEC4CompatibleStyle(elOptionStyle, elType, true);\n\n        if (!textConfig && convertResult.textConfig) {\n          textConfig = elOption.textConfig = convertResult.textConfig;\n        }\n\n        if (!textContentOption && convertResult.textContent) {\n          textContentOption = convertResult.textContent;\n        }\n      } // Remove unnecessary props to avoid potential problems.\n\n\n      var elOptionCleaned = getCleanedElOption(elOption); // For simple, do not support parent change, otherwise reorder is needed.\n\n      if (process.env.NODE_ENV !== 'production') {\n        elExisting && zrUtil.assert(targetElParent === elExisting.parent, 'Changing parent is not supported.');\n      }\n\n      var $action = elOption.$action || 'merge';\n\n      if ($action === 'merge') {\n        elExisting ? elExisting.attr(elOptionCleaned) : createEl(id, targetElParent, elOptionCleaned, elMap);\n      } else if ($action === 'replace') {\n        removeEl(elExisting, elMap);\n        createEl(id, targetElParent, elOptionCleaned, elMap);\n      } else if ($action === 'remove') {\n        removeEl(elExisting, elMap);\n      }\n\n      var el = elMap.get(id);\n\n      if (el && textContentOption) {\n        if ($action === 'merge') {\n          var textContentExisting = el.getTextContent();\n          textContentExisting ? textContentExisting.attr(textContentOption) : el.setTextContent(new graphicUtil.Text(textContentOption));\n        } else if ($action === 'replace') {\n          el.setTextContent(new graphicUtil.Text(textContentOption));\n        }\n      }\n\n      if (el) {\n        var elInner = inner(el);\n        elInner.__ecGraphicWidthOption = elOption.width;\n        elInner.__ecGraphicHeightOption = elOption.height;\n        setEventData(el, graphicModel, elOption);\n        graphicUtil.setTooltipConfig({\n          el: el,\n          componentModel: graphicModel,\n          itemName: el.name,\n          itemTooltipOption: elOption.tooltip\n        });\n      }\n    });\n  };\n  /**\n   * Locate graphic elements.\n   */\n\n\n  GraphicComponentView.prototype._relocate = function (graphicModel, api) {\n    var elOptions = graphicModel.option.elements;\n    var rootGroup = this.group;\n    var elMap = this._elMap;\n    var apiWidth = api.getWidth();\n    var apiHeight = api.getHeight(); // Top-down to calculate percentage width/height of group\n\n    for (var i = 0; i < elOptions.length; i++) {\n      var elOption = elOptions[i];\n      var id = modelUtil.convertOptionIdName(elOption.id, null);\n      var el = id != null ? elMap.get(id) : null;\n\n      if (!el || !el.isGroup) {\n        continue;\n      }\n\n      var parentEl = el.parent;\n      var isParentRoot = parentEl === rootGroup; // Like 'position:absolut' in css, default 0.\n\n      var elInner = inner(el);\n      var parentElInner = inner(parentEl);\n      elInner.__ecGraphicWidth = parsePercent(elInner.__ecGraphicWidthOption, isParentRoot ? apiWidth : parentElInner.__ecGraphicWidth) || 0;\n      elInner.__ecGraphicHeight = parsePercent(elInner.__ecGraphicHeightOption, isParentRoot ? apiHeight : parentElInner.__ecGraphicHeight) || 0;\n    } // Bottom-up tranvese all elements (consider ec resize) to locate elements.\n\n\n    for (var i = elOptions.length - 1; i >= 0; i--) {\n      var elOption = elOptions[i];\n      var id = modelUtil.convertOptionIdName(elOption.id, null);\n      var el = id != null ? elMap.get(id) : null;\n\n      if (!el) {\n        continue;\n      }\n\n      var parentEl = el.parent;\n      var parentElInner = inner(parentEl);\n      var containerInfo = parentEl === rootGroup ? {\n        width: apiWidth,\n        height: apiHeight\n      } : {\n        width: parentElInner.__ecGraphicWidth,\n        height: parentElInner.__ecGraphicHeight\n      }; // PENDING\n      // Currently, when `bounding: 'all'`, the union bounding rect of the group\n      // does not include the rect of [0, 0, group.width, group.height], which\n      // is probably weird for users. Should we make a break change for it?\n\n      layoutUtil.positionElement(el, elOption, containerInfo, null, {\n        hv: elOption.hv,\n        boundingMode: elOption.bounding\n      });\n    }\n  };\n  /**\n   * Clear all elements.\n   */\n\n\n  GraphicComponentView.prototype._clear = function () {\n    var elMap = this._elMap;\n    elMap.each(function (el) {\n      removeEl(el, elMap);\n    });\n    this._elMap = zrUtil.createHashMap();\n  };\n\n  GraphicComponentView.prototype.dispose = function () {\n    this._clear();\n  };\n\n  GraphicComponentView.type = 'graphic';\n  return GraphicComponentView;\n}(ComponentView);\n\nfunction createEl(id, targetElParent, elOption, elMap) {\n  var graphicType = elOption.type;\n\n  if (process.env.NODE_ENV !== 'production') {\n    zrUtil.assert(graphicType, 'graphic type MUST be set');\n  }\n\n  var Clz = zrUtil.hasOwn(_nonShapeGraphicElements, graphicType) // Those graphic elements are not shapes. They should not be\n  // overwritten by users, so do them first.\n  ? _nonShapeGraphicElements[graphicType] : graphicUtil.getShapeClass(graphicType);\n\n  if (process.env.NODE_ENV !== 'production') {\n    zrUtil.assert(Clz, 'graphic type can not be found');\n  }\n\n  var el = new Clz(elOption);\n  targetElParent.add(el);\n  elMap.set(id, el);\n  inner(el).__ecGraphicId = id;\n}\n\nfunction removeEl(elExisting, elMap) {\n  var existElParent = elExisting && elExisting.parent;\n\n  if (existElParent) {\n    elExisting.type === 'group' && elExisting.traverse(function (el) {\n      removeEl(el, elMap);\n    });\n    elMap.removeKey(inner(elExisting).__ecGraphicId);\n    existElParent.remove(elExisting);\n  }\n} // Remove unnecessary props to avoid potential problems.\n\n\nfunction getCleanedElOption(elOption) {\n  elOption = zrUtil.extend({}, elOption);\n  zrUtil.each(['id', 'parentId', '$action', 'hv', 'bounding', 'textContent'].concat(layoutUtil.LOCATION_PARAMS), function (name) {\n    delete elOption[name];\n  });\n  return elOption;\n}\n\nfunction isSetLoc(obj, props) {\n  var isSet;\n  zrUtil.each(props, function (prop) {\n    obj[prop] != null && obj[prop] !== 'auto' && (isSet = true);\n  });\n  return isSet;\n}\n\nfunction setKeyInfoToNewElOption(resultItem, newElOption) {\n  var existElOption = resultItem.existing; // Set id and type after id assigned.\n\n  newElOption.id = resultItem.keyInfo.id;\n  !newElOption.type && existElOption && (newElOption.type = existElOption.type); // Set parent id if not specified\n\n  if (newElOption.parentId == null) {\n    var newElParentOption = newElOption.parentOption;\n\n    if (newElParentOption) {\n      newElOption.parentId = newElParentOption.id;\n    } else if (existElOption) {\n      newElOption.parentId = existElOption.parentId;\n    }\n  } // Clear\n\n\n  newElOption.parentOption = null;\n}\n\nfunction mergeNewElOptionToExist(existList, index, newElOption) {\n  // Update existing options, for `getOption` feature.\n  var newElOptCopy = zrUtil.extend({}, newElOption);\n  var existElOption = existList[index];\n  var $action = newElOption.$action || 'merge';\n\n  if ($action === 'merge') {\n    if (existElOption) {\n      if (process.env.NODE_ENV !== 'production') {\n        var newType = newElOption.type;\n        zrUtil.assert(!newType || existElOption.type === newType, 'Please set $action: \"replace\" to change `type`');\n      } // We can ensure that newElOptCopy and existElOption are not\n      // the same object, so `merge` will not change newElOptCopy.\n\n\n      zrUtil.merge(existElOption, newElOptCopy, true); // Rigid body, use ignoreSize.\n\n      layoutUtil.mergeLayoutParam(existElOption, newElOptCopy, {\n        ignoreSize: true\n      }); // Will be used in render.\n\n      layoutUtil.copyLayoutParams(newElOption, existElOption);\n    } else {\n      existList[index] = newElOptCopy;\n    }\n  } else if ($action === 'replace') {\n    existList[index] = newElOptCopy;\n  } else if ($action === 'remove') {\n    // null will be cleaned later.\n    existElOption && (existList[index] = null);\n  }\n}\n\nfunction setLayoutInfoToExist(existItem, newElOption) {\n  if (!existItem) {\n    return;\n  }\n\n  existItem.hv = newElOption.hv = [// Rigid body, dont care `width`.\n  isSetLoc(newElOption, ['left', 'right']), // Rigid body, dont care `height`.\n  isSetLoc(newElOption, ['top', 'bottom'])]; // Give default group size. Otherwise layout error may occur.\n\n  if (existItem.type === 'group') {\n    var existingGroupOpt = existItem;\n    var newGroupOpt = newElOption;\n    existingGroupOpt.width == null && (existingGroupOpt.width = newGroupOpt.width = 0);\n    existingGroupOpt.height == null && (existingGroupOpt.height = newGroupOpt.height = 0);\n  }\n}\n\nfunction setEventData(el, graphicModel, elOption) {\n  var eventData = getECData(el).eventData; // Simple optimize for large amount of elements that no need event.\n\n  if (!el.silent && !el.ignore && !eventData) {\n    eventData = getECData(el).eventData = {\n      componentType: 'graphic',\n      componentIndex: graphicModel.componentIndex,\n      name: el.name\n    };\n  } // `elOption.info` enables user to mount some info on\n  // elements and use them in event handlers.\n\n\n  if (eventData) {\n    eventData.info = elOption.info;\n  }\n}\n\nexport function install(registers) {\n  registers.registerComponentModel(GraphicComponentModel);\n  registers.registerComponentView(GraphicComponentView);\n  registers.registerPreprocessor(preprocessor);\n}","map":{"version":3,"sources":["D:/桌面/react基础原理分析/react_extension/node_modules/echarts/lib/component/graphic/install.js"],"names":["__extends","zrUtil","modelUtil","graphicUtil","layoutUtil","parsePercent","ComponentModel","ComponentView","getECData","isEC4CompatibleStyle","convertFromEC4CompatibleStyle","TRANSFORM_PROPS","x","y","scaleX","scaleY","originX","originY","rotation","inner","makeInner","_nonShapeGraphicElements","path","compoundPath","group","Group","image","Image","text","Text","preprocessor","option","graphicOption","graphic","isArray","elements","GraphicComponentModel","_super","_this","apply","arguments","type","preventAutoZ","prototype","mergeOption","ecModel","call","optionUpdated","newOption","isInit","thisOption","newList","existList","flattenedList","_flatten","mappingResult","mappingToExists","elOptionsToUpdate","_elOptionsToUpdate","each","resultItem","index","newElOption","process","env","NODE_ENV","assert","isObject","existing","push","setKeyInfoToNewElOption","mergeNewElOptionToExist","setLayoutInfoToExist","i","length","splice","$action","optionList","result","parentOption","children","useElOptionsToUpdate","els","defaultOption","GraphicComponentView","init","_elMap","createHashMap","render","graphicModel","api","_lastGraphicModel","_clear","_updateElements","_relocate","elMap","rootGroup","elOption","id","convertOptionIdName","elExisting","get","parentId","targetElParent","elType","elOptionStyle","style","hv","textVerticalAlign","textBaseline","verticalAlign","align","textContentOption","textContent","textConfig","convertResult","elOptionCleaned","getCleanedElOption","parent","attr","createEl","removeEl","el","textContentExisting","getTextContent","setTextContent","elInner","__ecGraphicWidthOption","width","__ecGraphicHeightOption","height","setEventData","setTooltipConfig","componentModel","itemName","name","itemTooltipOption","tooltip","elOptions","apiWidth","getWidth","apiHeight","getHeight","isGroup","parentEl","isParentRoot","parentElInner","__ecGraphicWidth","__ecGraphicHeight","containerInfo","positionElement","boundingMode","bounding","dispose","graphicType","Clz","hasOwn","getShapeClass","add","set","__ecGraphicId","existElParent","traverse","removeKey","remove","extend","concat","LOCATION_PARAMS","isSetLoc","obj","props","isSet","prop","existElOption","keyInfo","newElParentOption","newElOptCopy","newType","merge","mergeLayoutParam","ignoreSize","copyLayoutParams","existItem","existingGroupOpt","newGroupOpt","eventData","silent","ignore","componentType","componentIndex","info","install","registers","registerComponentModel","registerComponentView","registerPreprocessor"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\nimport * as zrUtil from 'zrender/lib/core/util';\nimport * as modelUtil from '../../util/model';\nimport * as graphicUtil from '../../util/graphic';\nimport * as layoutUtil from '../../util/layout';\nimport { parsePercent } from '../../util/number';\nimport ComponentModel from '../../model/Component';\nimport ComponentView from '../../view/Component';\nimport { getECData } from '../../util/innerStore';\nimport { isEC4CompatibleStyle, convertFromEC4CompatibleStyle } from '../../util/styleCompat';\nvar TRANSFORM_PROPS = {\n  x: 1,\n  y: 1,\n  scaleX: 1,\n  scaleY: 1,\n  originX: 1,\n  originY: 1,\n  rotation: 1\n};\n;\nvar inner = modelUtil.makeInner();\nvar _nonShapeGraphicElements = {\n  // Reserved but not supported in graphic component.\n  path: null,\n  compoundPath: null,\n  // Supported in graphic component.\n  group: graphicUtil.Group,\n  image: graphicUtil.Image,\n  text: graphicUtil.Text\n}; // ------------------------\n// Preprocessor\n// ------------------------\n\nvar preprocessor = function (option) {\n  var graphicOption = option.graphic; // Convert\n  // {graphic: [{left: 10, type: 'circle'}, ...]}\n  // or\n  // {graphic: {left: 10, type: 'circle'}}\n  // to\n  // {graphic: [{elements: [{left: 10, type: 'circle'}, ...]}]}\n\n  if (zrUtil.isArray(graphicOption)) {\n    if (!graphicOption[0] || !graphicOption[0].elements) {\n      option.graphic = [{\n        elements: graphicOption\n      }];\n    } else {\n      // Only one graphic instance can be instantiated. (We dont\n      // want that too many views are created in echarts._viewMap)\n      option.graphic = [option.graphic[0]];\n    }\n  } else if (graphicOption && !graphicOption.elements) {\n    option.graphic = [{\n      elements: [graphicOption]\n    }];\n  }\n};\n\n;\n\nvar GraphicComponentModel =\n/** @class */\nfunction (_super) {\n  __extends(GraphicComponentModel, _super);\n\n  function GraphicComponentModel() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = GraphicComponentModel.type;\n    _this.preventAutoZ = true;\n    return _this;\n  }\n\n  GraphicComponentModel.prototype.mergeOption = function (option, ecModel) {\n    // Prevent default merge to elements\n    var elements = this.option.elements;\n    this.option.elements = null;\n\n    _super.prototype.mergeOption.call(this, option, ecModel);\n\n    this.option.elements = elements;\n  };\n\n  GraphicComponentModel.prototype.optionUpdated = function (newOption, isInit) {\n    var thisOption = this.option;\n    var newList = (isInit ? thisOption : newOption).elements;\n    var existList = thisOption.elements = isInit ? [] : thisOption.elements;\n    var flattenedList = [];\n\n    this._flatten(newList, flattenedList, null);\n\n    var mappingResult = modelUtil.mappingToExists(existList, flattenedList, 'normalMerge'); // Clear elOptionsToUpdate\n\n    var elOptionsToUpdate = this._elOptionsToUpdate = [];\n    zrUtil.each(mappingResult, function (resultItem, index) {\n      var newElOption = resultItem.newOption;\n\n      if (process.env.NODE_ENV !== 'production') {\n        zrUtil.assert(zrUtil.isObject(newElOption) || resultItem.existing, 'Empty graphic option definition');\n      }\n\n      if (!newElOption) {\n        return;\n      }\n\n      elOptionsToUpdate.push(newElOption);\n      setKeyInfoToNewElOption(resultItem, newElOption);\n      mergeNewElOptionToExist(existList, index, newElOption);\n      setLayoutInfoToExist(existList[index], newElOption);\n    }, this); // Clean\n\n    for (var i = existList.length - 1; i >= 0; i--) {\n      if (existList[i] == null) {\n        existList.splice(i, 1);\n      } else {\n        // $action should be volatile, otherwise option gotten from\n        // `getOption` will contain unexpected $action.\n        delete existList[i].$action;\n      }\n    }\n  };\n  /**\n   * Convert\n   * [{\n   *  type: 'group',\n   *  id: 'xx',\n   *  children: [{type: 'circle'}, {type: 'polygon'}]\n   * }]\n   * to\n   * [\n   *  {type: 'group', id: 'xx'},\n   *  {type: 'circle', parentId: 'xx'},\n   *  {type: 'polygon', parentId: 'xx'}\n   * ]\n   */\n\n\n  GraphicComponentModel.prototype._flatten = function (optionList, result, parentOption) {\n    zrUtil.each(optionList, function (option) {\n      if (!option) {\n        return;\n      }\n\n      if (parentOption) {\n        option.parentOption = parentOption;\n      }\n\n      result.push(option);\n      var children = option.children;\n\n      if (option.type === 'group' && children) {\n        this._flatten(children, result, option);\n      } // Deleting for JSON output, and for not affecting group creation.\n\n\n      delete option.children;\n    }, this);\n  }; // FIXME\n  // Pass to view using payload? setOption has a payload?\n\n\n  GraphicComponentModel.prototype.useElOptionsToUpdate = function () {\n    var els = this._elOptionsToUpdate; // Clear to avoid render duplicately when zooming.\n\n    this._elOptionsToUpdate = null;\n    return els;\n  };\n\n  GraphicComponentModel.type = 'graphic';\n  GraphicComponentModel.defaultOption = {\n    elements: [] // parentId: null\n\n  };\n  return GraphicComponentModel;\n}(ComponentModel); // ------------------------\n// View\n// ------------------------\n\n\nvar GraphicComponentView =\n/** @class */\nfunction (_super) {\n  __extends(GraphicComponentView, _super);\n\n  function GraphicComponentView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = GraphicComponentView.type;\n    return _this;\n  }\n\n  GraphicComponentView.prototype.init = function () {\n    this._elMap = zrUtil.createHashMap();\n  };\n\n  GraphicComponentView.prototype.render = function (graphicModel, ecModel, api) {\n    // Having leveraged between use cases and algorithm complexity, a very\n    // simple layout mechanism is used:\n    // The size(width/height) can be determined by itself or its parent (not\n    // implemented yet), but can not by its children. (Top-down travel)\n    // The location(x/y) can be determined by the bounding rect of itself\n    // (can including its descendants or not) and the size of its parent.\n    // (Bottom-up travel)\n    // When `chart.clear()` or `chart.setOption({...}, true)` with the same id,\n    // view will be reused.\n    if (graphicModel !== this._lastGraphicModel) {\n      this._clear();\n    }\n\n    this._lastGraphicModel = graphicModel;\n\n    this._updateElements(graphicModel);\n\n    this._relocate(graphicModel, api);\n  };\n  /**\n   * Update graphic elements.\n   */\n\n\n  GraphicComponentView.prototype._updateElements = function (graphicModel) {\n    var elOptionsToUpdate = graphicModel.useElOptionsToUpdate();\n\n    if (!elOptionsToUpdate) {\n      return;\n    }\n\n    var elMap = this._elMap;\n    var rootGroup = this.group; // Top-down tranverse to assign graphic settings to each elements.\n\n    zrUtil.each(elOptionsToUpdate, function (elOption) {\n      var id = modelUtil.convertOptionIdName(elOption.id, null);\n      var elExisting = id != null ? elMap.get(id) : null;\n      var parentId = modelUtil.convertOptionIdName(elOption.parentId, null);\n      var targetElParent = parentId != null ? elMap.get(parentId) : rootGroup;\n      var elType = elOption.type;\n      var elOptionStyle = elOption.style;\n\n      if (elType === 'text' && elOptionStyle) {\n        // In top/bottom mode, textVerticalAlign should not be used, which cause\n        // inaccurately locating.\n        if (elOption.hv && elOption.hv[1]) {\n          elOptionStyle.textVerticalAlign = elOptionStyle.textBaseline = elOptionStyle.verticalAlign = elOptionStyle.align = null;\n        }\n      }\n\n      var textContentOption = elOption.textContent;\n      var textConfig = elOption.textConfig;\n\n      if (elOptionStyle && isEC4CompatibleStyle(elOptionStyle, elType, !!textConfig, !!textContentOption)) {\n        var convertResult = convertFromEC4CompatibleStyle(elOptionStyle, elType, true);\n\n        if (!textConfig && convertResult.textConfig) {\n          textConfig = elOption.textConfig = convertResult.textConfig;\n        }\n\n        if (!textContentOption && convertResult.textContent) {\n          textContentOption = convertResult.textContent;\n        }\n      } // Remove unnecessary props to avoid potential problems.\n\n\n      var elOptionCleaned = getCleanedElOption(elOption); // For simple, do not support parent change, otherwise reorder is needed.\n\n      if (process.env.NODE_ENV !== 'production') {\n        elExisting && zrUtil.assert(targetElParent === elExisting.parent, 'Changing parent is not supported.');\n      }\n\n      var $action = elOption.$action || 'merge';\n\n      if ($action === 'merge') {\n        elExisting ? elExisting.attr(elOptionCleaned) : createEl(id, targetElParent, elOptionCleaned, elMap);\n      } else if ($action === 'replace') {\n        removeEl(elExisting, elMap);\n        createEl(id, targetElParent, elOptionCleaned, elMap);\n      } else if ($action === 'remove') {\n        removeEl(elExisting, elMap);\n      }\n\n      var el = elMap.get(id);\n\n      if (el && textContentOption) {\n        if ($action === 'merge') {\n          var textContentExisting = el.getTextContent();\n          textContentExisting ? textContentExisting.attr(textContentOption) : el.setTextContent(new graphicUtil.Text(textContentOption));\n        } else if ($action === 'replace') {\n          el.setTextContent(new graphicUtil.Text(textContentOption));\n        }\n      }\n\n      if (el) {\n        var elInner = inner(el);\n        elInner.__ecGraphicWidthOption = elOption.width;\n        elInner.__ecGraphicHeightOption = elOption.height;\n        setEventData(el, graphicModel, elOption);\n        graphicUtil.setTooltipConfig({\n          el: el,\n          componentModel: graphicModel,\n          itemName: el.name,\n          itemTooltipOption: elOption.tooltip\n        });\n      }\n    });\n  };\n  /**\n   * Locate graphic elements.\n   */\n\n\n  GraphicComponentView.prototype._relocate = function (graphicModel, api) {\n    var elOptions = graphicModel.option.elements;\n    var rootGroup = this.group;\n    var elMap = this._elMap;\n    var apiWidth = api.getWidth();\n    var apiHeight = api.getHeight(); // Top-down to calculate percentage width/height of group\n\n    for (var i = 0; i < elOptions.length; i++) {\n      var elOption = elOptions[i];\n      var id = modelUtil.convertOptionIdName(elOption.id, null);\n      var el = id != null ? elMap.get(id) : null;\n\n      if (!el || !el.isGroup) {\n        continue;\n      }\n\n      var parentEl = el.parent;\n      var isParentRoot = parentEl === rootGroup; // Like 'position:absolut' in css, default 0.\n\n      var elInner = inner(el);\n      var parentElInner = inner(parentEl);\n      elInner.__ecGraphicWidth = parsePercent(elInner.__ecGraphicWidthOption, isParentRoot ? apiWidth : parentElInner.__ecGraphicWidth) || 0;\n      elInner.__ecGraphicHeight = parsePercent(elInner.__ecGraphicHeightOption, isParentRoot ? apiHeight : parentElInner.__ecGraphicHeight) || 0;\n    } // Bottom-up tranvese all elements (consider ec resize) to locate elements.\n\n\n    for (var i = elOptions.length - 1; i >= 0; i--) {\n      var elOption = elOptions[i];\n      var id = modelUtil.convertOptionIdName(elOption.id, null);\n      var el = id != null ? elMap.get(id) : null;\n\n      if (!el) {\n        continue;\n      }\n\n      var parentEl = el.parent;\n      var parentElInner = inner(parentEl);\n      var containerInfo = parentEl === rootGroup ? {\n        width: apiWidth,\n        height: apiHeight\n      } : {\n        width: parentElInner.__ecGraphicWidth,\n        height: parentElInner.__ecGraphicHeight\n      }; // PENDING\n      // Currently, when `bounding: 'all'`, the union bounding rect of the group\n      // does not include the rect of [0, 0, group.width, group.height], which\n      // is probably weird for users. Should we make a break change for it?\n\n      layoutUtil.positionElement(el, elOption, containerInfo, null, {\n        hv: elOption.hv,\n        boundingMode: elOption.bounding\n      });\n    }\n  };\n  /**\n   * Clear all elements.\n   */\n\n\n  GraphicComponentView.prototype._clear = function () {\n    var elMap = this._elMap;\n    elMap.each(function (el) {\n      removeEl(el, elMap);\n    });\n    this._elMap = zrUtil.createHashMap();\n  };\n\n  GraphicComponentView.prototype.dispose = function () {\n    this._clear();\n  };\n\n  GraphicComponentView.type = 'graphic';\n  return GraphicComponentView;\n}(ComponentView);\n\nfunction createEl(id, targetElParent, elOption, elMap) {\n  var graphicType = elOption.type;\n\n  if (process.env.NODE_ENV !== 'production') {\n    zrUtil.assert(graphicType, 'graphic type MUST be set');\n  }\n\n  var Clz = zrUtil.hasOwn(_nonShapeGraphicElements, graphicType) // Those graphic elements are not shapes. They should not be\n  // overwritten by users, so do them first.\n  ? _nonShapeGraphicElements[graphicType] : graphicUtil.getShapeClass(graphicType);\n\n  if (process.env.NODE_ENV !== 'production') {\n    zrUtil.assert(Clz, 'graphic type can not be found');\n  }\n\n  var el = new Clz(elOption);\n  targetElParent.add(el);\n  elMap.set(id, el);\n  inner(el).__ecGraphicId = id;\n}\n\nfunction removeEl(elExisting, elMap) {\n  var existElParent = elExisting && elExisting.parent;\n\n  if (existElParent) {\n    elExisting.type === 'group' && elExisting.traverse(function (el) {\n      removeEl(el, elMap);\n    });\n    elMap.removeKey(inner(elExisting).__ecGraphicId);\n    existElParent.remove(elExisting);\n  }\n} // Remove unnecessary props to avoid potential problems.\n\n\nfunction getCleanedElOption(elOption) {\n  elOption = zrUtil.extend({}, elOption);\n  zrUtil.each(['id', 'parentId', '$action', 'hv', 'bounding', 'textContent'].concat(layoutUtil.LOCATION_PARAMS), function (name) {\n    delete elOption[name];\n  });\n  return elOption;\n}\n\nfunction isSetLoc(obj, props) {\n  var isSet;\n  zrUtil.each(props, function (prop) {\n    obj[prop] != null && obj[prop] !== 'auto' && (isSet = true);\n  });\n  return isSet;\n}\n\nfunction setKeyInfoToNewElOption(resultItem, newElOption) {\n  var existElOption = resultItem.existing; // Set id and type after id assigned.\n\n  newElOption.id = resultItem.keyInfo.id;\n  !newElOption.type && existElOption && (newElOption.type = existElOption.type); // Set parent id if not specified\n\n  if (newElOption.parentId == null) {\n    var newElParentOption = newElOption.parentOption;\n\n    if (newElParentOption) {\n      newElOption.parentId = newElParentOption.id;\n    } else if (existElOption) {\n      newElOption.parentId = existElOption.parentId;\n    }\n  } // Clear\n\n\n  newElOption.parentOption = null;\n}\n\nfunction mergeNewElOptionToExist(existList, index, newElOption) {\n  // Update existing options, for `getOption` feature.\n  var newElOptCopy = zrUtil.extend({}, newElOption);\n  var existElOption = existList[index];\n  var $action = newElOption.$action || 'merge';\n\n  if ($action === 'merge') {\n    if (existElOption) {\n      if (process.env.NODE_ENV !== 'production') {\n        var newType = newElOption.type;\n        zrUtil.assert(!newType || existElOption.type === newType, 'Please set $action: \"replace\" to change `type`');\n      } // We can ensure that newElOptCopy and existElOption are not\n      // the same object, so `merge` will not change newElOptCopy.\n\n\n      zrUtil.merge(existElOption, newElOptCopy, true); // Rigid body, use ignoreSize.\n\n      layoutUtil.mergeLayoutParam(existElOption, newElOptCopy, {\n        ignoreSize: true\n      }); // Will be used in render.\n\n      layoutUtil.copyLayoutParams(newElOption, existElOption);\n    } else {\n      existList[index] = newElOptCopy;\n    }\n  } else if ($action === 'replace') {\n    existList[index] = newElOptCopy;\n  } else if ($action === 'remove') {\n    // null will be cleaned later.\n    existElOption && (existList[index] = null);\n  }\n}\n\nfunction setLayoutInfoToExist(existItem, newElOption) {\n  if (!existItem) {\n    return;\n  }\n\n  existItem.hv = newElOption.hv = [// Rigid body, dont care `width`.\n  isSetLoc(newElOption, ['left', 'right']), // Rigid body, dont care `height`.\n  isSetLoc(newElOption, ['top', 'bottom'])]; // Give default group size. Otherwise layout error may occur.\n\n  if (existItem.type === 'group') {\n    var existingGroupOpt = existItem;\n    var newGroupOpt = newElOption;\n    existingGroupOpt.width == null && (existingGroupOpt.width = newGroupOpt.width = 0);\n    existingGroupOpt.height == null && (existingGroupOpt.height = newGroupOpt.height = 0);\n  }\n}\n\nfunction setEventData(el, graphicModel, elOption) {\n  var eventData = getECData(el).eventData; // Simple optimize for large amount of elements that no need event.\n\n  if (!el.silent && !el.ignore && !eventData) {\n    eventData = getECData(el).eventData = {\n      componentType: 'graphic',\n      componentIndex: graphicModel.componentIndex,\n      name: el.name\n    };\n  } // `elOption.info` enables user to mount some info on\n  // elements and use them in event handlers.\n\n\n  if (eventData) {\n    eventData.info = elOption.info;\n  }\n}\n\nexport function install(registers) {\n  registers.registerComponentModel(GraphicComponentModel);\n  registers.registerComponentView(GraphicComponentView);\n  registers.registerPreprocessor(preprocessor);\n}"]},"metadata":{},"sourceType":"module"}