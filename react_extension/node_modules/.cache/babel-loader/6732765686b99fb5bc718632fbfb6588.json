{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\"; // TODO depends on DataZoom and Brush\n\nimport * as zrUtil from 'zrender/lib/core/util';\nimport BrushController from '../../helper/BrushController';\nimport BrushTargetManager from '../../helper/BrushTargetManager';\nimport * as history from '../../dataZoom/history';\nimport sliderMove from '../../helper/sliderMove';\nimport { ToolboxFeature } from '../featureManager';\nimport { makeInternalComponentId, parseFinder } from '../../../util/model';\nimport { registerInternalOptionCreator } from '../../../model/internalComponentCreator';\nvar each = zrUtil.each;\nvar DATA_ZOOM_ID_BASE = makeInternalComponentId('toolbox-dataZoom_');\nvar ICON_TYPES = ['zoom', 'back'];\n\nvar DataZoomFeature =\n/** @class */\nfunction (_super) {\n  __extends(DataZoomFeature, _super);\n\n  function DataZoomFeature() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  DataZoomFeature.prototype.render = function (featureModel, ecModel, api, payload) {\n    if (!this._brushController) {\n      this._brushController = new BrushController(api.getZr());\n\n      this._brushController.on('brush', zrUtil.bind(this._onBrush, this)).mount();\n    }\n\n    updateZoomBtnStatus(featureModel, ecModel, this, payload, api);\n    updateBackBtnStatus(featureModel, ecModel);\n  };\n\n  DataZoomFeature.prototype.onclick = function (ecModel, api, type) {\n    handlers[type].call(this);\n  };\n\n  DataZoomFeature.prototype.remove = function (ecModel, api) {\n    this._brushController && this._brushController.unmount();\n  };\n\n  DataZoomFeature.prototype.dispose = function (ecModel, api) {\n    this._brushController && this._brushController.dispose();\n  };\n\n  DataZoomFeature.prototype._onBrush = function (eventParam) {\n    var areas = eventParam.areas;\n\n    if (!eventParam.isEnd || !areas.length) {\n      return;\n    }\n\n    var snapshot = {};\n    var ecModel = this.ecModel;\n\n    this._brushController.updateCovers([]); // remove cover\n\n\n    var brushTargetManager = new BrushTargetManager(makeAxisFinder(this.model), ecModel, {\n      include: ['grid']\n    });\n    brushTargetManager.matchOutputRanges(areas, ecModel, function (area, coordRange, coordSys) {\n      if (coordSys.type !== 'cartesian2d') {\n        return;\n      }\n\n      var brushType = area.brushType;\n\n      if (brushType === 'rect') {\n        setBatch('x', coordSys, coordRange[0]);\n        setBatch('y', coordSys, coordRange[1]);\n      } else {\n        setBatch({\n          lineX: 'x',\n          lineY: 'y'\n        }[brushType], coordSys, coordRange);\n      }\n    });\n    history.push(ecModel, snapshot);\n\n    this._dispatchZoomAction(snapshot);\n\n    function setBatch(dimName, coordSys, minMax) {\n      var axis = coordSys.getAxis(dimName);\n      var axisModel = axis.model;\n      var dataZoomModel = findDataZoom(dimName, axisModel, ecModel); // Restrict range.\n\n      var minMaxSpan = dataZoomModel.findRepresentativeAxisProxy(axisModel).getMinMaxSpan();\n\n      if (minMaxSpan.minValueSpan != null || minMaxSpan.maxValueSpan != null) {\n        minMax = sliderMove(0, minMax.slice(), axis.scale.getExtent(), 0, minMaxSpan.minValueSpan, minMaxSpan.maxValueSpan);\n      }\n\n      dataZoomModel && (snapshot[dataZoomModel.id] = {\n        dataZoomId: dataZoomModel.id,\n        startValue: minMax[0],\n        endValue: minMax[1]\n      });\n    }\n\n    function findDataZoom(dimName, axisModel, ecModel) {\n      var found;\n      ecModel.eachComponent({\n        mainType: 'dataZoom',\n        subType: 'select'\n      }, function (dzModel) {\n        var has = dzModel.getAxisModel(dimName, axisModel.componentIndex);\n        has && (found = dzModel);\n      });\n      return found;\n    }\n  };\n\n  ;\n\n  DataZoomFeature.prototype._dispatchZoomAction = function (snapshot) {\n    var batch = []; // Convert from hash map to array.\n\n    each(snapshot, function (batchItem, dataZoomId) {\n      batch.push(zrUtil.clone(batchItem));\n    });\n    batch.length && this.api.dispatchAction({\n      type: 'dataZoom',\n      from: this.uid,\n      batch: batch\n    });\n  };\n\n  DataZoomFeature.getDefaultOption = function (ecModel) {\n    var defaultOption = {\n      show: true,\n      filterMode: 'filter',\n      // Icon group\n      icon: {\n        zoom: 'M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1',\n        back: 'M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26'\n      },\n      // `zoom`, `back`\n      title: ecModel.getLocaleModel().get(['toolbox', 'dataZoom', 'title']),\n      brushStyle: {\n        borderWidth: 0,\n        color: 'rgba(210,219,238,0.2)'\n      }\n    };\n    return defaultOption;\n  };\n\n  return DataZoomFeature;\n}(ToolboxFeature);\n\nvar handlers = {\n  zoom: function () {\n    var nextActive = !this._isZoomActive;\n    this.api.dispatchAction({\n      type: 'takeGlobalCursor',\n      key: 'dataZoomSelect',\n      dataZoomSelectActive: nextActive\n    });\n  },\n  back: function () {\n    this._dispatchZoomAction(history.pop(this.ecModel));\n  }\n};\n\nfunction makeAxisFinder(dzFeatureModel) {\n  var setting = {\n    xAxisIndex: dzFeatureModel.get('xAxisIndex', true),\n    yAxisIndex: dzFeatureModel.get('yAxisIndex', true),\n    xAxisId: dzFeatureModel.get('xAxisId', true),\n    yAxisId: dzFeatureModel.get('yAxisId', true)\n  }; // If both `xAxisIndex` `xAxisId` not set, it means 'all'.\n  // If both `yAxisIndex` `yAxisId` not set, it means 'all'.\n  // Some old cases set like this below to close yAxis control but leave xAxis control:\n  // `{ feature: { dataZoom: { yAxisIndex: false } }`.\n\n  if (setting.xAxisIndex == null && setting.xAxisId == null) {\n    setting.xAxisIndex = 'all';\n  }\n\n  if (setting.yAxisIndex == null && setting.yAxisId == null) {\n    setting.yAxisIndex = 'all';\n  }\n\n  return setting;\n}\n\nfunction updateBackBtnStatus(featureModel, ecModel) {\n  featureModel.setIconStatus('back', history.count(ecModel) > 1 ? 'emphasis' : 'normal');\n}\n\nfunction updateZoomBtnStatus(featureModel, ecModel, view, payload, api) {\n  var zoomActive = view._isZoomActive;\n\n  if (payload && payload.type === 'takeGlobalCursor') {\n    zoomActive = payload.key === 'dataZoomSelect' ? payload.dataZoomSelectActive : false;\n  }\n\n  view._isZoomActive = zoomActive;\n  featureModel.setIconStatus('zoom', zoomActive ? 'emphasis' : 'normal');\n  var brushTargetManager = new BrushTargetManager(makeAxisFinder(featureModel), ecModel, {\n    include: ['grid']\n  });\n  var panels = brushTargetManager.makePanelOpts(api, function (targetInfo) {\n    return targetInfo.xAxisDeclared && !targetInfo.yAxisDeclared ? 'lineX' : !targetInfo.xAxisDeclared && targetInfo.yAxisDeclared ? 'lineY' : 'rect';\n  });\n\n  view._brushController.setPanels(panels).enableBrush(zoomActive && panels.length ? {\n    brushType: 'auto',\n    brushStyle: featureModel.getModel('brushStyle').getItemStyle()\n  } : false);\n}\n\nregisterInternalOptionCreator('dataZoom', function (ecModel) {\n  var toolboxModel = ecModel.getComponent('toolbox', 0);\n  var featureDataZoomPath = ['feature', 'dataZoom'];\n\n  if (!toolboxModel || toolboxModel.get(featureDataZoomPath) == null) {\n    return;\n  }\n\n  var dzFeatureModel = toolboxModel.getModel(featureDataZoomPath);\n  var dzOptions = [];\n  var finder = makeAxisFinder(dzFeatureModel);\n  var finderResult = parseFinder(ecModel, finder);\n  each(finderResult.xAxisModels, function (axisModel) {\n    return buildInternalOptions(axisModel, 'xAxis', 'xAxisIndex');\n  });\n  each(finderResult.yAxisModels, function (axisModel) {\n    return buildInternalOptions(axisModel, 'yAxis', 'yAxisIndex');\n  });\n\n  function buildInternalOptions(axisModel, axisMainType, axisIndexPropName) {\n    var axisIndex = axisModel.componentIndex;\n    var newOpt = {\n      type: 'select',\n      $fromToolbox: true,\n      // Default to be filter\n      filterMode: dzFeatureModel.get('filterMode', true) || 'filter',\n      // Id for merge mapping.\n      id: DATA_ZOOM_ID_BASE + axisMainType + axisIndex\n    };\n    newOpt[axisIndexPropName] = axisIndex;\n    dzOptions.push(newOpt);\n  }\n\n  return dzOptions;\n});\nexport default DataZoomFeature;","map":{"version":3,"sources":["D:/桌面/react基础原理分析/react_extension/node_modules/echarts/lib/component/toolbox/feature/DataZoom.js"],"names":["__extends","zrUtil","BrushController","BrushTargetManager","history","sliderMove","ToolboxFeature","makeInternalComponentId","parseFinder","registerInternalOptionCreator","each","DATA_ZOOM_ID_BASE","ICON_TYPES","DataZoomFeature","_super","apply","arguments","prototype","render","featureModel","ecModel","api","payload","_brushController","getZr","on","bind","_onBrush","mount","updateZoomBtnStatus","updateBackBtnStatus","onclick","type","handlers","call","remove","unmount","dispose","eventParam","areas","isEnd","length","snapshot","updateCovers","brushTargetManager","makeAxisFinder","model","include","matchOutputRanges","area","coordRange","coordSys","brushType","setBatch","lineX","lineY","push","_dispatchZoomAction","dimName","minMax","axis","getAxis","axisModel","dataZoomModel","findDataZoom","minMaxSpan","findRepresentativeAxisProxy","getMinMaxSpan","minValueSpan","maxValueSpan","slice","scale","getExtent","id","dataZoomId","startValue","endValue","found","eachComponent","mainType","subType","dzModel","has","getAxisModel","componentIndex","batch","batchItem","clone","dispatchAction","from","uid","getDefaultOption","defaultOption","show","filterMode","icon","zoom","back","title","getLocaleModel","get","brushStyle","borderWidth","color","nextActive","_isZoomActive","key","dataZoomSelectActive","pop","dzFeatureModel","setting","xAxisIndex","yAxisIndex","xAxisId","yAxisId","setIconStatus","count","view","zoomActive","panels","makePanelOpts","targetInfo","xAxisDeclared","yAxisDeclared","setPanels","enableBrush","getModel","getItemStyle","toolboxModel","getComponent","featureDataZoomPath","dzOptions","finder","finderResult","xAxisModels","buildInternalOptions","yAxisModels","axisMainType","axisIndexPropName","axisIndex","newOpt","$fromToolbox"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\"; // TODO depends on DataZoom and Brush\n\nimport * as zrUtil from 'zrender/lib/core/util';\nimport BrushController from '../../helper/BrushController';\nimport BrushTargetManager from '../../helper/BrushTargetManager';\nimport * as history from '../../dataZoom/history';\nimport sliderMove from '../../helper/sliderMove';\nimport { ToolboxFeature } from '../featureManager';\nimport { makeInternalComponentId, parseFinder } from '../../../util/model';\nimport { registerInternalOptionCreator } from '../../../model/internalComponentCreator';\nvar each = zrUtil.each;\nvar DATA_ZOOM_ID_BASE = makeInternalComponentId('toolbox-dataZoom_');\nvar ICON_TYPES = ['zoom', 'back'];\n\nvar DataZoomFeature =\n/** @class */\nfunction (_super) {\n  __extends(DataZoomFeature, _super);\n\n  function DataZoomFeature() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  DataZoomFeature.prototype.render = function (featureModel, ecModel, api, payload) {\n    if (!this._brushController) {\n      this._brushController = new BrushController(api.getZr());\n\n      this._brushController.on('brush', zrUtil.bind(this._onBrush, this)).mount();\n    }\n\n    updateZoomBtnStatus(featureModel, ecModel, this, payload, api);\n    updateBackBtnStatus(featureModel, ecModel);\n  };\n\n  DataZoomFeature.prototype.onclick = function (ecModel, api, type) {\n    handlers[type].call(this);\n  };\n\n  DataZoomFeature.prototype.remove = function (ecModel, api) {\n    this._brushController && this._brushController.unmount();\n  };\n\n  DataZoomFeature.prototype.dispose = function (ecModel, api) {\n    this._brushController && this._brushController.dispose();\n  };\n\n  DataZoomFeature.prototype._onBrush = function (eventParam) {\n    var areas = eventParam.areas;\n\n    if (!eventParam.isEnd || !areas.length) {\n      return;\n    }\n\n    var snapshot = {};\n    var ecModel = this.ecModel;\n\n    this._brushController.updateCovers([]); // remove cover\n\n\n    var brushTargetManager = new BrushTargetManager(makeAxisFinder(this.model), ecModel, {\n      include: ['grid']\n    });\n    brushTargetManager.matchOutputRanges(areas, ecModel, function (area, coordRange, coordSys) {\n      if (coordSys.type !== 'cartesian2d') {\n        return;\n      }\n\n      var brushType = area.brushType;\n\n      if (brushType === 'rect') {\n        setBatch('x', coordSys, coordRange[0]);\n        setBatch('y', coordSys, coordRange[1]);\n      } else {\n        setBatch({\n          lineX: 'x',\n          lineY: 'y'\n        }[brushType], coordSys, coordRange);\n      }\n    });\n    history.push(ecModel, snapshot);\n\n    this._dispatchZoomAction(snapshot);\n\n    function setBatch(dimName, coordSys, minMax) {\n      var axis = coordSys.getAxis(dimName);\n      var axisModel = axis.model;\n      var dataZoomModel = findDataZoom(dimName, axisModel, ecModel); // Restrict range.\n\n      var minMaxSpan = dataZoomModel.findRepresentativeAxisProxy(axisModel).getMinMaxSpan();\n\n      if (minMaxSpan.minValueSpan != null || minMaxSpan.maxValueSpan != null) {\n        minMax = sliderMove(0, minMax.slice(), axis.scale.getExtent(), 0, minMaxSpan.minValueSpan, minMaxSpan.maxValueSpan);\n      }\n\n      dataZoomModel && (snapshot[dataZoomModel.id] = {\n        dataZoomId: dataZoomModel.id,\n        startValue: minMax[0],\n        endValue: minMax[1]\n      });\n    }\n\n    function findDataZoom(dimName, axisModel, ecModel) {\n      var found;\n      ecModel.eachComponent({\n        mainType: 'dataZoom',\n        subType: 'select'\n      }, function (dzModel) {\n        var has = dzModel.getAxisModel(dimName, axisModel.componentIndex);\n        has && (found = dzModel);\n      });\n      return found;\n    }\n  };\n\n  ;\n\n  DataZoomFeature.prototype._dispatchZoomAction = function (snapshot) {\n    var batch = []; // Convert from hash map to array.\n\n    each(snapshot, function (batchItem, dataZoomId) {\n      batch.push(zrUtil.clone(batchItem));\n    });\n    batch.length && this.api.dispatchAction({\n      type: 'dataZoom',\n      from: this.uid,\n      batch: batch\n    });\n  };\n\n  DataZoomFeature.getDefaultOption = function (ecModel) {\n    var defaultOption = {\n      show: true,\n      filterMode: 'filter',\n      // Icon group\n      icon: {\n        zoom: 'M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1',\n        back: 'M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26'\n      },\n      // `zoom`, `back`\n      title: ecModel.getLocaleModel().get(['toolbox', 'dataZoom', 'title']),\n      brushStyle: {\n        borderWidth: 0,\n        color: 'rgba(210,219,238,0.2)'\n      }\n    };\n    return defaultOption;\n  };\n\n  return DataZoomFeature;\n}(ToolboxFeature);\n\nvar handlers = {\n  zoom: function () {\n    var nextActive = !this._isZoomActive;\n    this.api.dispatchAction({\n      type: 'takeGlobalCursor',\n      key: 'dataZoomSelect',\n      dataZoomSelectActive: nextActive\n    });\n  },\n  back: function () {\n    this._dispatchZoomAction(history.pop(this.ecModel));\n  }\n};\n\nfunction makeAxisFinder(dzFeatureModel) {\n  var setting = {\n    xAxisIndex: dzFeatureModel.get('xAxisIndex', true),\n    yAxisIndex: dzFeatureModel.get('yAxisIndex', true),\n    xAxisId: dzFeatureModel.get('xAxisId', true),\n    yAxisId: dzFeatureModel.get('yAxisId', true)\n  }; // If both `xAxisIndex` `xAxisId` not set, it means 'all'.\n  // If both `yAxisIndex` `yAxisId` not set, it means 'all'.\n  // Some old cases set like this below to close yAxis control but leave xAxis control:\n  // `{ feature: { dataZoom: { yAxisIndex: false } }`.\n\n  if (setting.xAxisIndex == null && setting.xAxisId == null) {\n    setting.xAxisIndex = 'all';\n  }\n\n  if (setting.yAxisIndex == null && setting.yAxisId == null) {\n    setting.yAxisIndex = 'all';\n  }\n\n  return setting;\n}\n\nfunction updateBackBtnStatus(featureModel, ecModel) {\n  featureModel.setIconStatus('back', history.count(ecModel) > 1 ? 'emphasis' : 'normal');\n}\n\nfunction updateZoomBtnStatus(featureModel, ecModel, view, payload, api) {\n  var zoomActive = view._isZoomActive;\n\n  if (payload && payload.type === 'takeGlobalCursor') {\n    zoomActive = payload.key === 'dataZoomSelect' ? payload.dataZoomSelectActive : false;\n  }\n\n  view._isZoomActive = zoomActive;\n  featureModel.setIconStatus('zoom', zoomActive ? 'emphasis' : 'normal');\n  var brushTargetManager = new BrushTargetManager(makeAxisFinder(featureModel), ecModel, {\n    include: ['grid']\n  });\n  var panels = brushTargetManager.makePanelOpts(api, function (targetInfo) {\n    return targetInfo.xAxisDeclared && !targetInfo.yAxisDeclared ? 'lineX' : !targetInfo.xAxisDeclared && targetInfo.yAxisDeclared ? 'lineY' : 'rect';\n  });\n\n  view._brushController.setPanels(panels).enableBrush(zoomActive && panels.length ? {\n    brushType: 'auto',\n    brushStyle: featureModel.getModel('brushStyle').getItemStyle()\n  } : false);\n}\n\nregisterInternalOptionCreator('dataZoom', function (ecModel) {\n  var toolboxModel = ecModel.getComponent('toolbox', 0);\n  var featureDataZoomPath = ['feature', 'dataZoom'];\n\n  if (!toolboxModel || toolboxModel.get(featureDataZoomPath) == null) {\n    return;\n  }\n\n  var dzFeatureModel = toolboxModel.getModel(featureDataZoomPath);\n  var dzOptions = [];\n  var finder = makeAxisFinder(dzFeatureModel);\n  var finderResult = parseFinder(ecModel, finder);\n  each(finderResult.xAxisModels, function (axisModel) {\n    return buildInternalOptions(axisModel, 'xAxis', 'xAxisIndex');\n  });\n  each(finderResult.yAxisModels, function (axisModel) {\n    return buildInternalOptions(axisModel, 'yAxis', 'yAxisIndex');\n  });\n\n  function buildInternalOptions(axisModel, axisMainType, axisIndexPropName) {\n    var axisIndex = axisModel.componentIndex;\n    var newOpt = {\n      type: 'select',\n      $fromToolbox: true,\n      // Default to be filter\n      filterMode: dzFeatureModel.get('filterMode', true) || 'filter',\n      // Id for merge mapping.\n      id: DATA_ZOOM_ID_BASE + axisMainType + axisIndex\n    };\n    newOpt[axisIndexPropName] = axisIndex;\n    dzOptions.push(newOpt);\n  }\n\n  return dzOptions;\n});\nexport default DataZoomFeature;"]},"metadata":{},"sourceType":"module"}