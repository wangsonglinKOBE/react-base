{"ast":null,"code":"import { __extends } from \"tslib\";\nimport Definable from './Definable';\nimport * as zrUtil from '../../core/util';\nimport * as colorTool from '../../tool/color';\n\nfunction isLinearGradient(value) {\n  return value.type === 'linear';\n}\n\nfunction isRadialGradient(value) {\n  return value.type === 'radial';\n}\n\nfunction isGradient(value) {\n  return value && (value.type === 'linear' || value.type === 'radial');\n}\n\nvar GradientManager = function (_super) {\n  __extends(GradientManager, _super);\n\n  function GradientManager(zrId, svgRoot) {\n    return _super.call(this, zrId, svgRoot, ['linearGradient', 'radialGradient'], '__gradient_in_use__') || this;\n  }\n\n  GradientManager.prototype.addWithoutUpdate = function (svgElement, displayable) {\n    if (displayable && displayable.style) {\n      var that_1 = this;\n      zrUtil.each(['fill', 'stroke'], function (fillOrStroke) {\n        var value = displayable.style[fillOrStroke];\n\n        if (isGradient(value)) {\n          var gradient = value;\n          var defs = that_1.getDefs(true);\n          var dom = void 0;\n\n          if (gradient.__dom) {\n            dom = gradient.__dom;\n\n            if (!defs.contains(gradient.__dom)) {\n              that_1.addDom(dom);\n            }\n          } else {\n            dom = that_1.add(gradient);\n          }\n\n          that_1.markUsed(displayable);\n          var id = dom.getAttribute('id');\n          svgElement.setAttribute(fillOrStroke, 'url(#' + id + ')');\n        }\n      });\n    }\n  };\n\n  GradientManager.prototype.add = function (gradient) {\n    var dom;\n\n    if (isLinearGradient(gradient)) {\n      dom = this.createElement('linearGradient');\n    } else if (isRadialGradient(gradient)) {\n      dom = this.createElement('radialGradient');\n    } else {\n      zrUtil.logError('Illegal gradient type.');\n      return null;\n    }\n\n    gradient.id = gradient.id || this.nextId++;\n    dom.setAttribute('id', 'zr' + this._zrId + '-gradient-' + gradient.id);\n    this.updateDom(gradient, dom);\n    this.addDom(dom);\n    return dom;\n  };\n\n  GradientManager.prototype.update = function (gradient) {\n    if (!isGradient(gradient)) {\n      return;\n    }\n\n    var that = this;\n    this.doUpdate(gradient, function () {\n      var dom = gradient.__dom;\n\n      if (!dom) {\n        return;\n      }\n\n      var tagName = dom.tagName;\n      var type = gradient.type;\n\n      if (type === 'linear' && tagName === 'linearGradient' || type === 'radial' && tagName === 'radialGradient') {\n        that.updateDom(gradient, gradient.__dom);\n      } else {\n        that.removeDom(gradient);\n        that.add(gradient);\n      }\n    });\n  };\n\n  GradientManager.prototype.updateDom = function (gradient, dom) {\n    if (isLinearGradient(gradient)) {\n      dom.setAttribute('x1', gradient.x + '');\n      dom.setAttribute('y1', gradient.y + '');\n      dom.setAttribute('x2', gradient.x2 + '');\n      dom.setAttribute('y2', gradient.y2 + '');\n    } else if (isRadialGradient(gradient)) {\n      dom.setAttribute('cx', gradient.x + '');\n      dom.setAttribute('cy', gradient.y + '');\n      dom.setAttribute('r', gradient.r + '');\n    } else {\n      zrUtil.logError('Illegal gradient type.');\n      return;\n    }\n\n    if (gradient.global) {\n      dom.setAttribute('gradientUnits', 'userSpaceOnUse');\n    } else {\n      dom.setAttribute('gradientUnits', 'objectBoundingBox');\n    }\n\n    dom.innerHTML = '';\n    var colors = gradient.colorStops;\n\n    for (var i = 0, len = colors.length; i < len; ++i) {\n      var stop_1 = this.createElement('stop');\n      stop_1.setAttribute('offset', colors[i].offset * 100 + '%');\n      var color = colors[i].color;\n\n      if (color.indexOf('rgba') > -1) {\n        var opacity = colorTool.parse(color)[3];\n        var hex = colorTool.toHex(color);\n        stop_1.setAttribute('stop-color', '#' + hex);\n        stop_1.setAttribute('stop-opacity', opacity + '');\n      } else {\n        stop_1.setAttribute('stop-color', colors[i].color);\n      }\n\n      dom.appendChild(stop_1);\n    }\n\n    gradient.__dom = dom;\n  };\n\n  GradientManager.prototype.markUsed = function (displayable) {\n    if (displayable.style) {\n      var gradient = displayable.style.fill;\n\n      if (gradient && gradient.__dom) {\n        _super.prototype.markDomUsed.call(this, gradient.__dom);\n      }\n\n      gradient = displayable.style.stroke;\n\n      if (gradient && gradient.__dom) {\n        _super.prototype.markDomUsed.call(this, gradient.__dom);\n      }\n    }\n  };\n\n  return GradientManager;\n}(Definable);\n\nexport default GradientManager;","map":{"version":3,"sources":["D:/桌面/react基础原理分析/react_extension/node_modules/zrender/lib/svg/helper/GradientManager.js"],"names":["__extends","Definable","zrUtil","colorTool","isLinearGradient","value","type","isRadialGradient","isGradient","GradientManager","_super","zrId","svgRoot","call","prototype","addWithoutUpdate","svgElement","displayable","style","that_1","each","fillOrStroke","gradient","defs","getDefs","dom","__dom","contains","addDom","add","markUsed","id","getAttribute","setAttribute","createElement","logError","nextId","_zrId","updateDom","update","that","doUpdate","tagName","removeDom","x","y","x2","y2","r","global","innerHTML","colors","colorStops","i","len","length","stop_1","offset","color","indexOf","opacity","parse","hex","toHex","appendChild","fill","markDomUsed","stroke"],"mappings":"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","sourcesContent":["import { __extends } from \"tslib\";\nimport Definable from './Definable';\nimport * as zrUtil from '../../core/util';\nimport * as colorTool from '../../tool/color';\nfunction isLinearGradient(value) {\n    return value.type === 'linear';\n}\nfunction isRadialGradient(value) {\n    return value.type === 'radial';\n}\nfunction isGradient(value) {\n    return value && (value.type === 'linear'\n        || value.type === 'radial');\n}\nvar GradientManager = (function (_super) {\n    __extends(GradientManager, _super);\n    function GradientManager(zrId, svgRoot) {\n        return _super.call(this, zrId, svgRoot, ['linearGradient', 'radialGradient'], '__gradient_in_use__') || this;\n    }\n    GradientManager.prototype.addWithoutUpdate = function (svgElement, displayable) {\n        if (displayable && displayable.style) {\n            var that_1 = this;\n            zrUtil.each(['fill', 'stroke'], function (fillOrStroke) {\n                var value = displayable.style[fillOrStroke];\n                if (isGradient(value)) {\n                    var gradient = value;\n                    var defs = that_1.getDefs(true);\n                    var dom = void 0;\n                    if (gradient.__dom) {\n                        dom = gradient.__dom;\n                        if (!defs.contains(gradient.__dom)) {\n                            that_1.addDom(dom);\n                        }\n                    }\n                    else {\n                        dom = that_1.add(gradient);\n                    }\n                    that_1.markUsed(displayable);\n                    var id = dom.getAttribute('id');\n                    svgElement.setAttribute(fillOrStroke, 'url(#' + id + ')');\n                }\n            });\n        }\n    };\n    GradientManager.prototype.add = function (gradient) {\n        var dom;\n        if (isLinearGradient(gradient)) {\n            dom = this.createElement('linearGradient');\n        }\n        else if (isRadialGradient(gradient)) {\n            dom = this.createElement('radialGradient');\n        }\n        else {\n            zrUtil.logError('Illegal gradient type.');\n            return null;\n        }\n        gradient.id = gradient.id || this.nextId++;\n        dom.setAttribute('id', 'zr' + this._zrId\n            + '-gradient-' + gradient.id);\n        this.updateDom(gradient, dom);\n        this.addDom(dom);\n        return dom;\n    };\n    GradientManager.prototype.update = function (gradient) {\n        if (!isGradient(gradient)) {\n            return;\n        }\n        var that = this;\n        this.doUpdate(gradient, function () {\n            var dom = gradient.__dom;\n            if (!dom) {\n                return;\n            }\n            var tagName = dom.tagName;\n            var type = gradient.type;\n            if (type === 'linear' && tagName === 'linearGradient'\n                || type === 'radial' && tagName === 'radialGradient') {\n                that.updateDom(gradient, gradient.__dom);\n            }\n            else {\n                that.removeDom(gradient);\n                that.add(gradient);\n            }\n        });\n    };\n    GradientManager.prototype.updateDom = function (gradient, dom) {\n        if (isLinearGradient(gradient)) {\n            dom.setAttribute('x1', gradient.x + '');\n            dom.setAttribute('y1', gradient.y + '');\n            dom.setAttribute('x2', gradient.x2 + '');\n            dom.setAttribute('y2', gradient.y2 + '');\n        }\n        else if (isRadialGradient(gradient)) {\n            dom.setAttribute('cx', gradient.x + '');\n            dom.setAttribute('cy', gradient.y + '');\n            dom.setAttribute('r', gradient.r + '');\n        }\n        else {\n            zrUtil.logError('Illegal gradient type.');\n            return;\n        }\n        if (gradient.global) {\n            dom.setAttribute('gradientUnits', 'userSpaceOnUse');\n        }\n        else {\n            dom.setAttribute('gradientUnits', 'objectBoundingBox');\n        }\n        dom.innerHTML = '';\n        var colors = gradient.colorStops;\n        for (var i = 0, len = colors.length; i < len; ++i) {\n            var stop_1 = this.createElement('stop');\n            stop_1.setAttribute('offset', colors[i].offset * 100 + '%');\n            var color = colors[i].color;\n            if (color.indexOf('rgba') > -1) {\n                var opacity = colorTool.parse(color)[3];\n                var hex = colorTool.toHex(color);\n                stop_1.setAttribute('stop-color', '#' + hex);\n                stop_1.setAttribute('stop-opacity', opacity + '');\n            }\n            else {\n                stop_1.setAttribute('stop-color', colors[i].color);\n            }\n            dom.appendChild(stop_1);\n        }\n        gradient.__dom = dom;\n    };\n    GradientManager.prototype.markUsed = function (displayable) {\n        if (displayable.style) {\n            var gradient = displayable.style.fill;\n            if (gradient && gradient.__dom) {\n                _super.prototype.markDomUsed.call(this, gradient.__dom);\n            }\n            gradient = displayable.style.stroke;\n            if (gradient && gradient.__dom) {\n                _super.prototype.markDomUsed.call(this, gradient.__dom);\n            }\n        }\n    };\n    return GradientManager;\n}(Definable));\nexport default GradientManager;\n"]},"metadata":{},"sourceType":"module"}