{"ast":null,"code":"import { __extends } from \"tslib\";\nimport Eventful from '../core/Eventful';\nimport requestAnimationFrame from './requestAnimationFrame';\nimport Animator from './Animator';\n\nvar Animation = function (_super) {\n  __extends(Animation, _super);\n\n  function Animation(opts) {\n    var _this = _super.call(this) || this;\n\n    _this._running = false;\n    _this._time = 0;\n    _this._pausedTime = 0;\n    _this._pauseStart = 0;\n    _this._paused = false;\n    opts = opts || {};\n    _this.stage = opts.stage || {};\n\n    _this.onframe = opts.onframe || function () {};\n\n    return _this;\n  }\n\n  Animation.prototype.addClip = function (clip) {\n    if (clip.animation) {\n      this.removeClip(clip);\n    }\n\n    if (!this._clipsHead) {\n      this._clipsHead = this._clipsTail = clip;\n    } else {\n      this._clipsTail.next = clip;\n      clip.prev = this._clipsTail;\n      clip.next = null;\n      this._clipsTail = clip;\n    }\n\n    clip.animation = this;\n  };\n\n  Animation.prototype.addAnimator = function (animator) {\n    animator.animation = this;\n    var clip = animator.getClip();\n\n    if (clip) {\n      this.addClip(clip);\n    }\n  };\n\n  Animation.prototype.removeClip = function (clip) {\n    if (!clip.animation) {\n      return;\n    }\n\n    var prev = clip.prev;\n    var next = clip.next;\n\n    if (prev) {\n      prev.next = next;\n    } else {\n      this._clipsHead = next;\n    }\n\n    if (next) {\n      next.prev = prev;\n    } else {\n      this._clipsTail = prev;\n    }\n\n    clip.next = clip.prev = clip.animation = null;\n  };\n\n  Animation.prototype.removeAnimator = function (animator) {\n    var clip = animator.getClip();\n\n    if (clip) {\n      this.removeClip(clip);\n    }\n\n    animator.animation = null;\n  };\n\n  Animation.prototype.update = function (notTriggerFrameAndStageUpdate) {\n    var time = new Date().getTime() - this._pausedTime;\n\n    var delta = time - this._time;\n    var clip = this._clipsHead;\n\n    while (clip) {\n      var nextClip = clip.next;\n      var finished = clip.step(time, delta);\n\n      if (finished) {\n        clip.ondestroy && clip.ondestroy();\n        this.removeClip(clip);\n        clip = nextClip;\n      } else {\n        clip = nextClip;\n      }\n    }\n\n    this._time = time;\n\n    if (!notTriggerFrameAndStageUpdate) {\n      this.onframe(delta);\n      this.trigger('frame', delta);\n      this.stage.update && this.stage.update();\n    }\n  };\n\n  Animation.prototype._startLoop = function () {\n    var self = this;\n    this._running = true;\n\n    function step() {\n      if (self._running) {\n        requestAnimationFrame(step);\n        !self._paused && self.update();\n      }\n    }\n\n    requestAnimationFrame(step);\n  };\n\n  Animation.prototype.start = function () {\n    if (this._running) {\n      return;\n    }\n\n    this._time = new Date().getTime();\n    this._pausedTime = 0;\n\n    this._startLoop();\n  };\n\n  Animation.prototype.stop = function () {\n    this._running = false;\n  };\n\n  Animation.prototype.pause = function () {\n    if (!this._paused) {\n      this._pauseStart = new Date().getTime();\n      this._paused = true;\n    }\n  };\n\n  Animation.prototype.resume = function () {\n    if (this._paused) {\n      this._pausedTime += new Date().getTime() - this._pauseStart;\n      this._paused = false;\n    }\n  };\n\n  Animation.prototype.clear = function () {\n    var clip = this._clipsHead;\n\n    while (clip) {\n      var nextClip = clip.next;\n      clip.prev = clip.next = clip.animation = null;\n      clip = nextClip;\n    }\n\n    this._clipsHead = this._clipsTail = null;\n  };\n\n  Animation.prototype.isFinished = function () {\n    return this._clipsHead == null;\n  };\n\n  Animation.prototype.animate = function (target, options) {\n    options = options || {};\n    this.start();\n    var animator = new Animator(target, options.loop);\n    this.addAnimator(animator);\n    return animator;\n  };\n\n  return Animation;\n}(Eventful);\n\nexport default Animation;","map":{"version":3,"sources":["D:/桌面/react基础原理分析/react_extension/node_modules/zrender/lib/animation/Animation.js"],"names":["__extends","Eventful","requestAnimationFrame","Animator","Animation","_super","opts","_this","call","_running","_time","_pausedTime","_pauseStart","_paused","stage","onframe","prototype","addClip","clip","animation","removeClip","_clipsHead","_clipsTail","next","prev","addAnimator","animator","getClip","removeAnimator","update","notTriggerFrameAndStageUpdate","time","Date","getTime","delta","nextClip","finished","step","ondestroy","trigger","_startLoop","self","start","stop","pause","resume","clear","isFinished","animate","target","options","loop"],"mappings":"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","sourcesContent":["import { __extends } from \"tslib\";\nimport Eventful from '../core/Eventful';\nimport requestAnimationFrame from './requestAnimationFrame';\nimport Animator from './Animator';\nvar Animation = (function (_super) {\n    __extends(Animation, _super);\n    function Animation(opts) {\n        var _this = _super.call(this) || this;\n        _this._running = false;\n        _this._time = 0;\n        _this._pausedTime = 0;\n        _this._pauseStart = 0;\n        _this._paused = false;\n        opts = opts || {};\n        _this.stage = opts.stage || {};\n        _this.onframe = opts.onframe || function () { };\n        return _this;\n    }\n    Animation.prototype.addClip = function (clip) {\n        if (clip.animation) {\n            this.removeClip(clip);\n        }\n        if (!this._clipsHead) {\n            this._clipsHead = this._clipsTail = clip;\n        }\n        else {\n            this._clipsTail.next = clip;\n            clip.prev = this._clipsTail;\n            clip.next = null;\n            this._clipsTail = clip;\n        }\n        clip.animation = this;\n    };\n    Animation.prototype.addAnimator = function (animator) {\n        animator.animation = this;\n        var clip = animator.getClip();\n        if (clip) {\n            this.addClip(clip);\n        }\n    };\n    Animation.prototype.removeClip = function (clip) {\n        if (!clip.animation) {\n            return;\n        }\n        var prev = clip.prev;\n        var next = clip.next;\n        if (prev) {\n            prev.next = next;\n        }\n        else {\n            this._clipsHead = next;\n        }\n        if (next) {\n            next.prev = prev;\n        }\n        else {\n            this._clipsTail = prev;\n        }\n        clip.next = clip.prev = clip.animation = null;\n    };\n    Animation.prototype.removeAnimator = function (animator) {\n        var clip = animator.getClip();\n        if (clip) {\n            this.removeClip(clip);\n        }\n        animator.animation = null;\n    };\n    Animation.prototype.update = function (notTriggerFrameAndStageUpdate) {\n        var time = new Date().getTime() - this._pausedTime;\n        var delta = time - this._time;\n        var clip = this._clipsHead;\n        while (clip) {\n            var nextClip = clip.next;\n            var finished = clip.step(time, delta);\n            if (finished) {\n                clip.ondestroy && clip.ondestroy();\n                this.removeClip(clip);\n                clip = nextClip;\n            }\n            else {\n                clip = nextClip;\n            }\n        }\n        this._time = time;\n        if (!notTriggerFrameAndStageUpdate) {\n            this.onframe(delta);\n            this.trigger('frame', delta);\n            this.stage.update && this.stage.update();\n        }\n    };\n    Animation.prototype._startLoop = function () {\n        var self = this;\n        this._running = true;\n        function step() {\n            if (self._running) {\n                requestAnimationFrame(step);\n                !self._paused && self.update();\n            }\n        }\n        requestAnimationFrame(step);\n    };\n    Animation.prototype.start = function () {\n        if (this._running) {\n            return;\n        }\n        this._time = new Date().getTime();\n        this._pausedTime = 0;\n        this._startLoop();\n    };\n    Animation.prototype.stop = function () {\n        this._running = false;\n    };\n    Animation.prototype.pause = function () {\n        if (!this._paused) {\n            this._pauseStart = new Date().getTime();\n            this._paused = true;\n        }\n    };\n    Animation.prototype.resume = function () {\n        if (this._paused) {\n            this._pausedTime += (new Date().getTime()) - this._pauseStart;\n            this._paused = false;\n        }\n    };\n    Animation.prototype.clear = function () {\n        var clip = this._clipsHead;\n        while (clip) {\n            var nextClip = clip.next;\n            clip.prev = clip.next = clip.animation = null;\n            clip = nextClip;\n        }\n        this._clipsHead = this._clipsTail = null;\n    };\n    Animation.prototype.isFinished = function () {\n        return this._clipsHead == null;\n    };\n    Animation.prototype.animate = function (target, options) {\n        options = options || {};\n        this.start();\n        var animator = new Animator(target, options.loop);\n        this.addAnimator(animator);\n        return animator;\n    };\n    return Animation;\n}(Eventful));\nexport default Animation;\n"]},"metadata":{},"sourceType":"module"}