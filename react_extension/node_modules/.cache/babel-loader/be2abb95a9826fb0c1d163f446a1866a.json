{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\nimport { ECPolygon } from '../line/poly';\nimport * as graphic from '../../util/graphic';\nimport { setStatesStylesFromModel, enableHoverEmphasis } from '../../util/states';\nimport { setLabelStyle, getLabelStatesModels } from '../../label/labelStyle';\nimport { bind } from 'zrender/lib/core/util';\nimport DataDiffer from '../../data/DataDiffer';\nimport ChartView from '../../view/Chart';\nimport { saveOldStyle } from '../../animation/basicTrasition';\n\nvar ThemeRiverView =\n/** @class */\nfunction (_super) {\n  __extends(ThemeRiverView, _super);\n\n  function ThemeRiverView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = ThemeRiverView.type;\n    _this._layers = [];\n    return _this;\n  }\n\n  ThemeRiverView.prototype.render = function (seriesModel, ecModel, api) {\n    var data = seriesModel.getData();\n    var self = this;\n    var group = this.group;\n    var layersSeries = seriesModel.getLayerSeries();\n    var layoutInfo = data.getLayout('layoutInfo');\n    var rect = layoutInfo.rect;\n    var boundaryGap = layoutInfo.boundaryGap;\n    group.x = 0;\n    group.y = rect.y + boundaryGap[0];\n\n    function keyGetter(item) {\n      return item.name;\n    }\n\n    var dataDiffer = new DataDiffer(this._layersSeries || [], layersSeries, keyGetter, keyGetter);\n    var newLayersGroups = [];\n    dataDiffer.add(bind(process, this, 'add')).update(bind(process, this, 'update')).remove(bind(process, this, 'remove')).execute();\n\n    function process(status, idx, oldIdx) {\n      var oldLayersGroups = self._layers;\n\n      if (status === 'remove') {\n        group.remove(oldLayersGroups[idx]);\n        return;\n      }\n\n      var points0 = [];\n      var points1 = [];\n      var style;\n      var indices = layersSeries[idx].indices;\n      var j = 0;\n\n      for (; j < indices.length; j++) {\n        var layout = data.getItemLayout(indices[j]);\n        var x = layout.x;\n        var y0 = layout.y0;\n        var y = layout.y;\n        points0.push(x, y0);\n        points1.push(x, y0 + y);\n        style = data.getItemVisual(indices[j], 'style');\n      }\n\n      var polygon;\n      var textLayout = data.getItemLayout(indices[0]);\n      var labelModel = seriesModel.getModel('label');\n      var margin = labelModel.get('margin');\n      var emphasisModel = seriesModel.getModel('emphasis');\n\n      if (status === 'add') {\n        var layerGroup = newLayersGroups[idx] = new graphic.Group();\n        polygon = new ECPolygon({\n          shape: {\n            points: points0,\n            stackedOnPoints: points1,\n            smooth: 0.4,\n            stackedOnSmooth: 0.4,\n            smoothConstraint: false\n          },\n          z2: 0\n        });\n        layerGroup.add(polygon);\n        group.add(layerGroup);\n\n        if (seriesModel.isAnimationEnabled()) {\n          polygon.setClipPath(createGridClipShape(polygon.getBoundingRect(), seriesModel, function () {\n            polygon.removeClipPath();\n          }));\n        }\n      } else {\n        var layerGroup = oldLayersGroups[oldIdx];\n        polygon = layerGroup.childAt(0);\n        group.add(layerGroup);\n        newLayersGroups[idx] = layerGroup;\n        graphic.updateProps(polygon, {\n          shape: {\n            points: points0,\n            stackedOnPoints: points1\n          }\n        }, seriesModel);\n        saveOldStyle(polygon);\n      }\n\n      setLabelStyle(polygon, getLabelStatesModels(seriesModel), {\n        labelDataIndex: indices[j - 1],\n        defaultText: data.getName(indices[j - 1]),\n        inheritColor: style.fill\n      }, {\n        normal: {\n          verticalAlign: 'middle' // align: 'right'\n\n        }\n      });\n      polygon.setTextConfig({\n        position: null,\n        local: true\n      });\n      var labelEl = polygon.getTextContent(); // TODO More label position options.\n\n      if (labelEl) {\n        labelEl.x = textLayout.x - margin;\n        labelEl.y = textLayout.y0 + textLayout.y / 2;\n      }\n\n      polygon.useStyle(style);\n      data.setItemGraphicEl(idx, polygon);\n      setStatesStylesFromModel(polygon, seriesModel);\n      enableHoverEmphasis(polygon, emphasisModel.get('focus'), emphasisModel.get('blurScope'));\n    }\n\n    this._layersSeries = layersSeries;\n    this._layers = newLayersGroups;\n  };\n\n  ThemeRiverView.type = 'themeRiver';\n  return ThemeRiverView;\n}(ChartView);\n\n; // add animation to the view\n\nfunction createGridClipShape(rect, seriesModel, cb) {\n  var rectEl = new graphic.Rect({\n    shape: {\n      x: rect.x - 10,\n      y: rect.y - 10,\n      width: 0,\n      height: rect.height + 20\n    }\n  });\n  graphic.initProps(rectEl, {\n    shape: {\n      x: rect.x - 50,\n      width: rect.width + 100,\n      height: rect.height + 20\n    }\n  }, seriesModel, cb);\n  return rectEl;\n}\n\nexport default ThemeRiverView;","map":{"version":3,"sources":["D:/桌面/react基础原理分析/react_extension/node_modules/echarts/lib/chart/themeRiver/ThemeRiverView.js"],"names":["__extends","ECPolygon","graphic","setStatesStylesFromModel","enableHoverEmphasis","setLabelStyle","getLabelStatesModels","bind","DataDiffer","ChartView","saveOldStyle","ThemeRiverView","_super","_this","apply","arguments","type","_layers","prototype","render","seriesModel","ecModel","api","data","getData","self","group","layersSeries","getLayerSeries","layoutInfo","getLayout","rect","boundaryGap","x","y","keyGetter","item","name","dataDiffer","_layersSeries","newLayersGroups","add","process","update","remove","execute","status","idx","oldIdx","oldLayersGroups","points0","points1","style","indices","j","length","layout","getItemLayout","y0","push","getItemVisual","polygon","textLayout","labelModel","getModel","margin","get","emphasisModel","layerGroup","Group","shape","points","stackedOnPoints","smooth","stackedOnSmooth","smoothConstraint","z2","isAnimationEnabled","setClipPath","createGridClipShape","getBoundingRect","removeClipPath","childAt","updateProps","labelDataIndex","defaultText","getName","inheritColor","fill","normal","verticalAlign","setTextConfig","position","local","labelEl","getTextContent","useStyle","setItemGraphicEl","cb","rectEl","Rect","width","height","initProps"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\nimport { ECPolygon } from '../line/poly';\nimport * as graphic from '../../util/graphic';\nimport { setStatesStylesFromModel, enableHoverEmphasis } from '../../util/states';\nimport { setLabelStyle, getLabelStatesModels } from '../../label/labelStyle';\nimport { bind } from 'zrender/lib/core/util';\nimport DataDiffer from '../../data/DataDiffer';\nimport ChartView from '../../view/Chart';\nimport { saveOldStyle } from '../../animation/basicTrasition';\n\nvar ThemeRiverView =\n/** @class */\nfunction (_super) {\n  __extends(ThemeRiverView, _super);\n\n  function ThemeRiverView() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.type = ThemeRiverView.type;\n    _this._layers = [];\n    return _this;\n  }\n\n  ThemeRiverView.prototype.render = function (seriesModel, ecModel, api) {\n    var data = seriesModel.getData();\n    var self = this;\n    var group = this.group;\n    var layersSeries = seriesModel.getLayerSeries();\n    var layoutInfo = data.getLayout('layoutInfo');\n    var rect = layoutInfo.rect;\n    var boundaryGap = layoutInfo.boundaryGap;\n    group.x = 0;\n    group.y = rect.y + boundaryGap[0];\n\n    function keyGetter(item) {\n      return item.name;\n    }\n\n    var dataDiffer = new DataDiffer(this._layersSeries || [], layersSeries, keyGetter, keyGetter);\n    var newLayersGroups = [];\n    dataDiffer.add(bind(process, this, 'add')).update(bind(process, this, 'update')).remove(bind(process, this, 'remove')).execute();\n\n    function process(status, idx, oldIdx) {\n      var oldLayersGroups = self._layers;\n\n      if (status === 'remove') {\n        group.remove(oldLayersGroups[idx]);\n        return;\n      }\n\n      var points0 = [];\n      var points1 = [];\n      var style;\n      var indices = layersSeries[idx].indices;\n      var j = 0;\n\n      for (; j < indices.length; j++) {\n        var layout = data.getItemLayout(indices[j]);\n        var x = layout.x;\n        var y0 = layout.y0;\n        var y = layout.y;\n        points0.push(x, y0);\n        points1.push(x, y0 + y);\n        style = data.getItemVisual(indices[j], 'style');\n      }\n\n      var polygon;\n      var textLayout = data.getItemLayout(indices[0]);\n      var labelModel = seriesModel.getModel('label');\n      var margin = labelModel.get('margin');\n      var emphasisModel = seriesModel.getModel('emphasis');\n\n      if (status === 'add') {\n        var layerGroup = newLayersGroups[idx] = new graphic.Group();\n        polygon = new ECPolygon({\n          shape: {\n            points: points0,\n            stackedOnPoints: points1,\n            smooth: 0.4,\n            stackedOnSmooth: 0.4,\n            smoothConstraint: false\n          },\n          z2: 0\n        });\n        layerGroup.add(polygon);\n        group.add(layerGroup);\n\n        if (seriesModel.isAnimationEnabled()) {\n          polygon.setClipPath(createGridClipShape(polygon.getBoundingRect(), seriesModel, function () {\n            polygon.removeClipPath();\n          }));\n        }\n      } else {\n        var layerGroup = oldLayersGroups[oldIdx];\n        polygon = layerGroup.childAt(0);\n        group.add(layerGroup);\n        newLayersGroups[idx] = layerGroup;\n        graphic.updateProps(polygon, {\n          shape: {\n            points: points0,\n            stackedOnPoints: points1\n          }\n        }, seriesModel);\n        saveOldStyle(polygon);\n      }\n\n      setLabelStyle(polygon, getLabelStatesModels(seriesModel), {\n        labelDataIndex: indices[j - 1],\n        defaultText: data.getName(indices[j - 1]),\n        inheritColor: style.fill\n      }, {\n        normal: {\n          verticalAlign: 'middle' // align: 'right'\n\n        }\n      });\n      polygon.setTextConfig({\n        position: null,\n        local: true\n      });\n      var labelEl = polygon.getTextContent(); // TODO More label position options.\n\n      if (labelEl) {\n        labelEl.x = textLayout.x - margin;\n        labelEl.y = textLayout.y0 + textLayout.y / 2;\n      }\n\n      polygon.useStyle(style);\n      data.setItemGraphicEl(idx, polygon);\n      setStatesStylesFromModel(polygon, seriesModel);\n      enableHoverEmphasis(polygon, emphasisModel.get('focus'), emphasisModel.get('blurScope'));\n    }\n\n    this._layersSeries = layersSeries;\n    this._layers = newLayersGroups;\n  };\n\n  ThemeRiverView.type = 'themeRiver';\n  return ThemeRiverView;\n}(ChartView);\n\n; // add animation to the view\n\nfunction createGridClipShape(rect, seriesModel, cb) {\n  var rectEl = new graphic.Rect({\n    shape: {\n      x: rect.x - 10,\n      y: rect.y - 10,\n      width: 0,\n      height: rect.height + 20\n    }\n  });\n  graphic.initProps(rectEl, {\n    shape: {\n      x: rect.x - 50,\n      width: rect.width + 100,\n      height: rect.height + 20\n    }\n  }, seriesModel, cb);\n  return rectEl;\n}\n\nexport default ThemeRiverView;"]},"metadata":{},"sourceType":"module"}