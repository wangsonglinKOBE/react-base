{"ast":null,"code":"import { createElement, normalizeColor } from './core';\nimport ZRImage from '../graphic/Image';\nimport { DEFAULT_FONT, getLineHeight } from '../contain/text';\nimport { map } from '../core/util';\nimport { normalizeLineDash } from '../graphic/helper/dashStyle';\nvar NONE = 'none';\nvar mathRound = Math.round;\nvar mathSin = Math.sin;\nvar mathCos = Math.cos;\nvar PI = Math.PI;\nvar PI2 = Math.PI * 2;\nvar degree = 180 / PI;\nvar EPSILON = 1e-4;\n\nfunction round3(val) {\n  return mathRound(val * 1e3) / 1e3;\n}\n\nfunction round4(val) {\n  return mathRound(val * 1e4) / 1e4;\n}\n\nfunction isAroundZero(val) {\n  return val < EPSILON && val > -EPSILON;\n}\n\nfunction pathHasFill(style) {\n  var fill = style.fill;\n  return fill != null && fill !== NONE;\n}\n\nfunction pathHasStroke(style) {\n  var stroke = style.stroke;\n  return stroke != null && stroke !== NONE;\n}\n\nfunction setTransform(svgEl, m) {\n  if (m) {\n    attr(svgEl, 'transform', 'matrix(' + round3(m[0]) + ',' + round3(m[1]) + ',' + round3(m[2]) + ',' + round3(m[3]) + ',' + round4(m[4]) + ',' + round4(m[5]) + ')');\n  }\n}\n\nfunction attr(el, key, val) {\n  if (!val || val.type !== 'linear' && val.type !== 'radial') {\n    el.setAttribute(key, val);\n  }\n}\n\nfunction attrXLink(el, key, val) {\n  el.setAttributeNS('http://www.w3.org/1999/xlink', key, val);\n}\n\nfunction attrXML(el, key, val) {\n  el.setAttributeNS('http://www.w3.org/XML/1998/namespace', key, val);\n}\n\nfunction bindStyle(svgEl, style, el) {\n  var opacity = style.opacity == null ? 1 : style.opacity;\n\n  if (el instanceof ZRImage) {\n    svgEl.style.opacity = opacity + '';\n    return;\n  }\n\n  if (pathHasFill(style)) {\n    var fill = normalizeColor(style.fill);\n    attr(svgEl, 'fill', fill.color);\n    attr(svgEl, 'fill-opacity', (style.fillOpacity != null ? style.fillOpacity * fill.opacity * opacity : fill.opacity * opacity) + '');\n  } else {\n    attr(svgEl, 'fill', NONE);\n  }\n\n  if (pathHasStroke(style)) {\n    var stroke = normalizeColor(style.stroke);\n    attr(svgEl, 'stroke', stroke.color);\n    var strokeWidth = style.lineWidth;\n    var strokeScale_1 = style.strokeNoScale ? el.getLineScale() : 1;\n    attr(svgEl, 'stroke-width', (strokeScale_1 ? strokeWidth / strokeScale_1 : 0) + '');\n    attr(svgEl, 'paint-order', style.strokeFirst ? 'stroke' : 'fill');\n    attr(svgEl, 'stroke-opacity', (style.strokeOpacity != null ? style.strokeOpacity * stroke.opacity * opacity : stroke.opacity * opacity) + '');\n    var lineDash = style.lineDash && strokeWidth > 0 && normalizeLineDash(style.lineDash, strokeWidth);\n\n    if (lineDash) {\n      var lineDashOffset = style.lineDashOffset;\n\n      if (strokeScale_1 && strokeScale_1 !== 1) {\n        lineDash = map(lineDash, function (rawVal) {\n          return rawVal / strokeScale_1;\n        });\n\n        if (lineDashOffset) {\n          lineDashOffset /= strokeScale_1;\n          lineDashOffset = mathRound(lineDashOffset);\n        }\n      }\n\n      attr(svgEl, 'stroke-dasharray', lineDash.join(','));\n      attr(svgEl, 'stroke-dashoffset', (lineDashOffset || 0) + '');\n    } else {\n      attr(svgEl, 'stroke-dasharray', '');\n    }\n\n    style.lineCap && attr(svgEl, 'stroke-linecap', style.lineCap);\n    style.lineJoin && attr(svgEl, 'stroke-linejoin', style.lineJoin);\n    style.miterLimit && attr(svgEl, 'stroke-miterlimit', style.miterLimit + '');\n  } else {\n    attr(svgEl, 'stroke', NONE);\n  }\n}\n\nvar SVGPathRebuilder = function () {\n  function SVGPathRebuilder() {}\n\n  SVGPathRebuilder.prototype.reset = function () {\n    this._d = [];\n    this._str = '';\n  };\n\n  SVGPathRebuilder.prototype.moveTo = function (x, y) {\n    this._add('M', x, y);\n  };\n\n  SVGPathRebuilder.prototype.lineTo = function (x, y) {\n    this._add('L', x, y);\n  };\n\n  SVGPathRebuilder.prototype.bezierCurveTo = function (x, y, x2, y2, x3, y3) {\n    this._add('C', x, y, x2, y2, x3, y3);\n  };\n\n  SVGPathRebuilder.prototype.quadraticCurveTo = function (x, y, x2, y2) {\n    this._add('Q', x, y, x2, y2);\n  };\n\n  SVGPathRebuilder.prototype.arc = function (cx, cy, r, startAngle, endAngle, anticlockwise) {\n    this.ellipse(cx, cy, r, r, 0, startAngle, endAngle, anticlockwise);\n  };\n\n  SVGPathRebuilder.prototype.ellipse = function (cx, cy, rx, ry, psi, startAngle, endAngle, anticlockwise) {\n    var firstCmd = this._d.length === 0;\n    var dTheta = endAngle - startAngle;\n    var clockwise = !anticlockwise;\n    var dThetaPositive = Math.abs(dTheta);\n    var isCircle = isAroundZero(dThetaPositive - PI2) || (clockwise ? dTheta >= PI2 : -dTheta >= PI2);\n    var unifiedTheta = dTheta > 0 ? dTheta % PI2 : dTheta % PI2 + PI2;\n    var large = false;\n\n    if (isCircle) {\n      large = true;\n    } else if (isAroundZero(dThetaPositive)) {\n      large = false;\n    } else {\n      large = unifiedTheta >= PI === !!clockwise;\n    }\n\n    var x0 = round4(cx + rx * mathCos(startAngle));\n    var y0 = round4(cy + ry * mathSin(startAngle));\n\n    if (isCircle) {\n      if (clockwise) {\n        dTheta = PI2 - 1e-4;\n      } else {\n        dTheta = -PI2 + 1e-4;\n      }\n\n      large = true;\n\n      if (firstCmd) {\n        this._d.push('M', x0, y0);\n      }\n    }\n\n    var x = round4(cx + rx * mathCos(startAngle + dTheta));\n    var y = round4(cy + ry * mathSin(startAngle + dTheta));\n\n    if (isNaN(x0) || isNaN(y0) || isNaN(rx) || isNaN(ry) || isNaN(psi) || isNaN(degree) || isNaN(x) || isNaN(y)) {\n      return '';\n    }\n\n    this._d.push('A', round4(rx), round4(ry), mathRound(psi * degree), +large, +clockwise, x, y);\n  };\n\n  SVGPathRebuilder.prototype.rect = function (x, y, w, h) {\n    this._add('M', x, y);\n\n    this._add('L', x + w, y);\n\n    this._add('L', x + w, y + h);\n\n    this._add('L', x, y + h);\n\n    this._add('L', x, y);\n\n    this._add('Z');\n  };\n\n  SVGPathRebuilder.prototype.closePath = function () {\n    if (this._d.length > 0) {\n      this._add('Z');\n    }\n  };\n\n  SVGPathRebuilder.prototype._add = function (cmd, a, b, c, d, e, f, g, h) {\n    this._d.push(cmd);\n\n    for (var i = 1; i < arguments.length; i++) {\n      var val = arguments[i];\n\n      if (isNaN(val)) {\n        this._invalid = true;\n        return;\n      }\n\n      this._d.push(round4(val));\n    }\n  };\n\n  SVGPathRebuilder.prototype.generateStr = function () {\n    this._str = this._invalid ? '' : this._d.join(' ');\n    this._d = [];\n  };\n\n  SVGPathRebuilder.prototype.getStr = function () {\n    return this._str;\n  };\n\n  return SVGPathRebuilder;\n}();\n\nvar svgPath = {\n  brush: function (el) {\n    var style = el.style;\n    var svgEl = el.__svgEl;\n\n    if (!svgEl) {\n      svgEl = createElement('path');\n      el.__svgEl = svgEl;\n    }\n\n    if (!el.path) {\n      el.createPathProxy();\n    }\n\n    var path = el.path;\n\n    if (el.shapeChanged()) {\n      path.beginPath();\n      el.buildPath(path, el.shape);\n      el.pathUpdated();\n    }\n\n    var pathVersion = path.getVersion();\n    var elExt = el;\n    var svgPathBuilder = elExt.__svgPathBuilder;\n\n    if (elExt.__svgPathVersion !== pathVersion || !svgPathBuilder || el.style.strokePercent < 1) {\n      if (!svgPathBuilder) {\n        svgPathBuilder = elExt.__svgPathBuilder = new SVGPathRebuilder();\n      }\n\n      svgPathBuilder.reset();\n      path.rebuildPath(svgPathBuilder, el.style.strokePercent);\n      svgPathBuilder.generateStr();\n      elExt.__svgPathVersion = pathVersion;\n    }\n\n    attr(svgEl, 'd', svgPathBuilder.getStr());\n    bindStyle(svgEl, style, el);\n    setTransform(svgEl, el.transform);\n  }\n};\nexport { svgPath as path };\nvar svgImage = {\n  brush: function (el) {\n    var style = el.style;\n    var image = style.image;\n\n    if (image instanceof HTMLImageElement) {\n      image = image.src;\n    } else if (image instanceof HTMLCanvasElement) {\n      image = image.toDataURL();\n    }\n\n    if (!image) {\n      return;\n    }\n\n    var x = style.x || 0;\n    var y = style.y || 0;\n    var dw = style.width;\n    var dh = style.height;\n    var svgEl = el.__svgEl;\n\n    if (!svgEl) {\n      svgEl = createElement('image');\n      el.__svgEl = svgEl;\n    }\n\n    if (image !== el.__imageSrc) {\n      attrXLink(svgEl, 'href', image);\n      el.__imageSrc = image;\n    }\n\n    attr(svgEl, 'width', dw + '');\n    attr(svgEl, 'height', dh + '');\n    attr(svgEl, 'x', x + '');\n    attr(svgEl, 'y', y + '');\n    bindStyle(svgEl, style, el);\n    setTransform(svgEl, el.transform);\n  }\n};\nexport { svgImage as image };\nvar TEXT_ALIGN_TO_ANCHOR = {\n  left: 'start',\n  right: 'end',\n  center: 'middle',\n  middle: 'middle'\n};\n\nfunction adjustTextY(y, lineHeight, textBaseline) {\n  if (textBaseline === 'top') {\n    y += lineHeight / 2;\n  } else if (textBaseline === 'bottom') {\n    y -= lineHeight / 2;\n  }\n\n  return y;\n}\n\nvar svgText = {\n  brush: function (el) {\n    var style = el.style;\n    var text = style.text;\n    text != null && (text += '');\n\n    if (!text || isNaN(style.x) || isNaN(style.y)) {\n      return;\n    }\n\n    var textSvgEl = el.__svgEl;\n\n    if (!textSvgEl) {\n      textSvgEl = createElement('text');\n      attrXML(textSvgEl, 'xml:space', 'preserve');\n      el.__svgEl = textSvgEl;\n    }\n\n    var font = style.font || DEFAULT_FONT;\n    var textSvgElStyle = textSvgEl.style;\n    textSvgElStyle.font = font;\n    textSvgEl.textContent = text;\n    bindStyle(textSvgEl, style, el);\n    setTransform(textSvgEl, el.transform);\n    var x = style.x || 0;\n    var y = adjustTextY(style.y || 0, getLineHeight(font), style.textBaseline);\n    var textAlign = TEXT_ALIGN_TO_ANCHOR[style.textAlign] || style.textAlign;\n    attr(textSvgEl, 'dominant-baseline', 'central');\n    attr(textSvgEl, 'text-anchor', textAlign);\n    attr(textSvgEl, 'x', x + '');\n    attr(textSvgEl, 'y', y + '');\n  }\n};\nexport { svgText as text };","map":{"version":3,"sources":["D:/桌面/react基础原理分析/react_extension/node_modules/zrender/lib/svg/graphic.js"],"names":["createElement","normalizeColor","ZRImage","DEFAULT_FONT","getLineHeight","map","normalizeLineDash","NONE","mathRound","Math","round","mathSin","sin","mathCos","cos","PI","PI2","degree","EPSILON","round3","val","round4","isAroundZero","pathHasFill","style","fill","pathHasStroke","stroke","setTransform","svgEl","m","attr","el","key","type","setAttribute","attrXLink","setAttributeNS","attrXML","bindStyle","opacity","color","fillOpacity","strokeWidth","lineWidth","strokeScale_1","strokeNoScale","getLineScale","strokeFirst","strokeOpacity","lineDash","lineDashOffset","rawVal","join","lineCap","lineJoin","miterLimit","SVGPathRebuilder","prototype","reset","_d","_str","moveTo","x","y","_add","lineTo","bezierCurveTo","x2","y2","x3","y3","quadraticCurveTo","arc","cx","cy","r","startAngle","endAngle","anticlockwise","ellipse","rx","ry","psi","firstCmd","length","dTheta","clockwise","dThetaPositive","abs","isCircle","unifiedTheta","large","x0","y0","push","isNaN","rect","w","h","closePath","cmd","a","b","c","d","e","f","g","i","arguments","_invalid","generateStr","getStr","svgPath","brush","__svgEl","path","createPathProxy","shapeChanged","beginPath","buildPath","shape","pathUpdated","pathVersion","getVersion","elExt","svgPathBuilder","__svgPathBuilder","__svgPathVersion","strokePercent","rebuildPath","transform","svgImage","image","HTMLImageElement","src","HTMLCanvasElement","toDataURL","dw","width","dh","height","__imageSrc","TEXT_ALIGN_TO_ANCHOR","left","right","center","middle","adjustTextY","lineHeight","textBaseline","svgText","text","textSvgEl","font","textSvgElStyle","textContent","textAlign"],"mappings":"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","sourcesContent":["import { createElement, normalizeColor } from './core';\nimport ZRImage from '../graphic/Image';\nimport { DEFAULT_FONT, getLineHeight } from '../contain/text';\nimport { map } from '../core/util';\nimport { normalizeLineDash } from '../graphic/helper/dashStyle';\nvar NONE = 'none';\nvar mathRound = Math.round;\nvar mathSin = Math.sin;\nvar mathCos = Math.cos;\nvar PI = Math.PI;\nvar PI2 = Math.PI * 2;\nvar degree = 180 / PI;\nvar EPSILON = 1e-4;\nfunction round3(val) {\n    return mathRound(val * 1e3) / 1e3;\n}\nfunction round4(val) {\n    return mathRound(val * 1e4) / 1e4;\n}\nfunction isAroundZero(val) {\n    return val < EPSILON && val > -EPSILON;\n}\nfunction pathHasFill(style) {\n    var fill = style.fill;\n    return fill != null && fill !== NONE;\n}\nfunction pathHasStroke(style) {\n    var stroke = style.stroke;\n    return stroke != null && stroke !== NONE;\n}\nfunction setTransform(svgEl, m) {\n    if (m) {\n        attr(svgEl, 'transform', 'matrix('\n            + round3(m[0]) + ','\n            + round3(m[1]) + ','\n            + round3(m[2]) + ','\n            + round3(m[3]) + ','\n            + round4(m[4]) + ','\n            + round4(m[5])\n            + ')');\n    }\n}\nfunction attr(el, key, val) {\n    if (!val || val.type !== 'linear' && val.type !== 'radial') {\n        el.setAttribute(key, val);\n    }\n}\nfunction attrXLink(el, key, val) {\n    el.setAttributeNS('http://www.w3.org/1999/xlink', key, val);\n}\nfunction attrXML(el, key, val) {\n    el.setAttributeNS('http://www.w3.org/XML/1998/namespace', key, val);\n}\nfunction bindStyle(svgEl, style, el) {\n    var opacity = style.opacity == null ? 1 : style.opacity;\n    if (el instanceof ZRImage) {\n        svgEl.style.opacity = opacity + '';\n        return;\n    }\n    if (pathHasFill(style)) {\n        var fill = normalizeColor(style.fill);\n        attr(svgEl, 'fill', fill.color);\n        attr(svgEl, 'fill-opacity', (style.fillOpacity != null\n            ? style.fillOpacity * fill.opacity * opacity\n            : fill.opacity * opacity) + '');\n    }\n    else {\n        attr(svgEl, 'fill', NONE);\n    }\n    if (pathHasStroke(style)) {\n        var stroke = normalizeColor(style.stroke);\n        attr(svgEl, 'stroke', stroke.color);\n        var strokeWidth = style.lineWidth;\n        var strokeScale_1 = style.strokeNoScale\n            ? el.getLineScale()\n            : 1;\n        attr(svgEl, 'stroke-width', (strokeScale_1 ? strokeWidth / strokeScale_1 : 0) + '');\n        attr(svgEl, 'paint-order', style.strokeFirst ? 'stroke' : 'fill');\n        attr(svgEl, 'stroke-opacity', (style.strokeOpacity != null\n            ? style.strokeOpacity * stroke.opacity * opacity\n            : stroke.opacity * opacity) + '');\n        var lineDash = style.lineDash && strokeWidth > 0 && normalizeLineDash(style.lineDash, strokeWidth);\n        if (lineDash) {\n            var lineDashOffset = style.lineDashOffset;\n            if (strokeScale_1 && strokeScale_1 !== 1) {\n                lineDash = map(lineDash, function (rawVal) {\n                    return rawVal / strokeScale_1;\n                });\n                if (lineDashOffset) {\n                    lineDashOffset /= strokeScale_1;\n                    lineDashOffset = mathRound(lineDashOffset);\n                }\n            }\n            attr(svgEl, 'stroke-dasharray', lineDash.join(','));\n            attr(svgEl, 'stroke-dashoffset', (lineDashOffset || 0) + '');\n        }\n        else {\n            attr(svgEl, 'stroke-dasharray', '');\n        }\n        style.lineCap && attr(svgEl, 'stroke-linecap', style.lineCap);\n        style.lineJoin && attr(svgEl, 'stroke-linejoin', style.lineJoin);\n        style.miterLimit && attr(svgEl, 'stroke-miterlimit', style.miterLimit + '');\n    }\n    else {\n        attr(svgEl, 'stroke', NONE);\n    }\n}\nvar SVGPathRebuilder = (function () {\n    function SVGPathRebuilder() {\n    }\n    SVGPathRebuilder.prototype.reset = function () {\n        this._d = [];\n        this._str = '';\n    };\n    SVGPathRebuilder.prototype.moveTo = function (x, y) {\n        this._add('M', x, y);\n    };\n    SVGPathRebuilder.prototype.lineTo = function (x, y) {\n        this._add('L', x, y);\n    };\n    SVGPathRebuilder.prototype.bezierCurveTo = function (x, y, x2, y2, x3, y3) {\n        this._add('C', x, y, x2, y2, x3, y3);\n    };\n    SVGPathRebuilder.prototype.quadraticCurveTo = function (x, y, x2, y2) {\n        this._add('Q', x, y, x2, y2);\n    };\n    SVGPathRebuilder.prototype.arc = function (cx, cy, r, startAngle, endAngle, anticlockwise) {\n        this.ellipse(cx, cy, r, r, 0, startAngle, endAngle, anticlockwise);\n    };\n    SVGPathRebuilder.prototype.ellipse = function (cx, cy, rx, ry, psi, startAngle, endAngle, anticlockwise) {\n        var firstCmd = this._d.length === 0;\n        var dTheta = endAngle - startAngle;\n        var clockwise = !anticlockwise;\n        var dThetaPositive = Math.abs(dTheta);\n        var isCircle = isAroundZero(dThetaPositive - PI2)\n            || (clockwise ? dTheta >= PI2 : -dTheta >= PI2);\n        var unifiedTheta = dTheta > 0 ? dTheta % PI2 : (dTheta % PI2 + PI2);\n        var large = false;\n        if (isCircle) {\n            large = true;\n        }\n        else if (isAroundZero(dThetaPositive)) {\n            large = false;\n        }\n        else {\n            large = (unifiedTheta >= PI) === !!clockwise;\n        }\n        var x0 = round4(cx + rx * mathCos(startAngle));\n        var y0 = round4(cy + ry * mathSin(startAngle));\n        if (isCircle) {\n            if (clockwise) {\n                dTheta = PI2 - 1e-4;\n            }\n            else {\n                dTheta = -PI2 + 1e-4;\n            }\n            large = true;\n            if (firstCmd) {\n                this._d.push('M', x0, y0);\n            }\n        }\n        var x = round4(cx + rx * mathCos(startAngle + dTheta));\n        var y = round4(cy + ry * mathSin(startAngle + dTheta));\n        if (isNaN(x0) || isNaN(y0) || isNaN(rx) || isNaN(ry) || isNaN(psi) || isNaN(degree) || isNaN(x) || isNaN(y)) {\n            return '';\n        }\n        this._d.push('A', round4(rx), round4(ry), mathRound(psi * degree), +large, +clockwise, x, y);\n    };\n    SVGPathRebuilder.prototype.rect = function (x, y, w, h) {\n        this._add('M', x, y);\n        this._add('L', x + w, y);\n        this._add('L', x + w, y + h);\n        this._add('L', x, y + h);\n        this._add('L', x, y);\n        this._add('Z');\n    };\n    SVGPathRebuilder.prototype.closePath = function () {\n        if (this._d.length > 0) {\n            this._add('Z');\n        }\n    };\n    SVGPathRebuilder.prototype._add = function (cmd, a, b, c, d, e, f, g, h) {\n        this._d.push(cmd);\n        for (var i = 1; i < arguments.length; i++) {\n            var val = arguments[i];\n            if (isNaN(val)) {\n                this._invalid = true;\n                return;\n            }\n            this._d.push(round4(val));\n        }\n    };\n    SVGPathRebuilder.prototype.generateStr = function () {\n        this._str = this._invalid ? '' : this._d.join(' ');\n        this._d = [];\n    };\n    SVGPathRebuilder.prototype.getStr = function () {\n        return this._str;\n    };\n    return SVGPathRebuilder;\n}());\nvar svgPath = {\n    brush: function (el) {\n        var style = el.style;\n        var svgEl = el.__svgEl;\n        if (!svgEl) {\n            svgEl = createElement('path');\n            el.__svgEl = svgEl;\n        }\n        if (!el.path) {\n            el.createPathProxy();\n        }\n        var path = el.path;\n        if (el.shapeChanged()) {\n            path.beginPath();\n            el.buildPath(path, el.shape);\n            el.pathUpdated();\n        }\n        var pathVersion = path.getVersion();\n        var elExt = el;\n        var svgPathBuilder = elExt.__svgPathBuilder;\n        if (elExt.__svgPathVersion !== pathVersion || !svgPathBuilder || el.style.strokePercent < 1) {\n            if (!svgPathBuilder) {\n                svgPathBuilder = elExt.__svgPathBuilder = new SVGPathRebuilder();\n            }\n            svgPathBuilder.reset();\n            path.rebuildPath(svgPathBuilder, el.style.strokePercent);\n            svgPathBuilder.generateStr();\n            elExt.__svgPathVersion = pathVersion;\n        }\n        attr(svgEl, 'd', svgPathBuilder.getStr());\n        bindStyle(svgEl, style, el);\n        setTransform(svgEl, el.transform);\n    }\n};\nexport { svgPath as path };\nvar svgImage = {\n    brush: function (el) {\n        var style = el.style;\n        var image = style.image;\n        if (image instanceof HTMLImageElement) {\n            image = image.src;\n        }\n        else if (image instanceof HTMLCanvasElement) {\n            image = image.toDataURL();\n        }\n        if (!image) {\n            return;\n        }\n        var x = style.x || 0;\n        var y = style.y || 0;\n        var dw = style.width;\n        var dh = style.height;\n        var svgEl = el.__svgEl;\n        if (!svgEl) {\n            svgEl = createElement('image');\n            el.__svgEl = svgEl;\n        }\n        if (image !== el.__imageSrc) {\n            attrXLink(svgEl, 'href', image);\n            el.__imageSrc = image;\n        }\n        attr(svgEl, 'width', dw + '');\n        attr(svgEl, 'height', dh + '');\n        attr(svgEl, 'x', x + '');\n        attr(svgEl, 'y', y + '');\n        bindStyle(svgEl, style, el);\n        setTransform(svgEl, el.transform);\n    }\n};\nexport { svgImage as image };\nvar TEXT_ALIGN_TO_ANCHOR = {\n    left: 'start',\n    right: 'end',\n    center: 'middle',\n    middle: 'middle'\n};\nfunction adjustTextY(y, lineHeight, textBaseline) {\n    if (textBaseline === 'top') {\n        y += lineHeight / 2;\n    }\n    else if (textBaseline === 'bottom') {\n        y -= lineHeight / 2;\n    }\n    return y;\n}\nvar svgText = {\n    brush: function (el) {\n        var style = el.style;\n        var text = style.text;\n        text != null && (text += '');\n        if (!text || isNaN(style.x) || isNaN(style.y)) {\n            return;\n        }\n        var textSvgEl = el.__svgEl;\n        if (!textSvgEl) {\n            textSvgEl = createElement('text');\n            attrXML(textSvgEl, 'xml:space', 'preserve');\n            el.__svgEl = textSvgEl;\n        }\n        var font = style.font || DEFAULT_FONT;\n        var textSvgElStyle = textSvgEl.style;\n        textSvgElStyle.font = font;\n        textSvgEl.textContent = text;\n        bindStyle(textSvgEl, style, el);\n        setTransform(textSvgEl, el.transform);\n        var x = style.x || 0;\n        var y = adjustTextY(style.y || 0, getLineHeight(font), style.textBaseline);\n        var textAlign = TEXT_ALIGN_TO_ANCHOR[style.textAlign]\n            || style.textAlign;\n        attr(textSvgEl, 'dominant-baseline', 'central');\n        attr(textSvgEl, 'text-anchor', textAlign);\n        attr(textSvgEl, 'x', x + '');\n        attr(textSvgEl, 'y', y + '');\n    }\n};\nexport { svgText as text };\n"]},"metadata":{},"sourceType":"module"}