{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { isObject, retrieve2 } from 'zrender/lib/core/util';\nimport { makeInner } from '../util/model'; // Stored properties for further transition.\n\nexport var transitionStore = makeInner();\n/**\n * Return null if animation is disabled.\n */\n\nexport function getAnimationConfig(animationType, animatableModel, dataIndex, // Extra opts can override the option in animatable model.\nextraOpts, // TODO It's only for pictorial bar now.\nextraDelayParams) {\n  var animationPayload; // Check if there is global animation configuration from dataZoom/resize can override the config in option.\n  // If animation is enabled. Will use this animation config in payload.\n  // If animation is disabled. Just ignore it.\n\n  if (animatableModel && animatableModel.ecModel) {\n    var updatePayload = animatableModel.ecModel.getUpdatePayload();\n    animationPayload = updatePayload && updatePayload.animation;\n  }\n\n  var animationEnabled = animatableModel && animatableModel.isAnimationEnabled();\n  var isUpdate = animationType === 'update';\n\n  if (animationEnabled) {\n    var duration = void 0;\n    var easing = void 0;\n    var delay = void 0;\n\n    if (extraOpts) {\n      duration = retrieve2(extraOpts.duration, 200);\n      easing = retrieve2(extraOpts.easing, 'cubicOut');\n      delay = 0;\n    } else {\n      duration = animatableModel.getShallow(isUpdate ? 'animationDurationUpdate' : 'animationDuration');\n      easing = animatableModel.getShallow(isUpdate ? 'animationEasingUpdate' : 'animationEasing');\n      delay = animatableModel.getShallow(isUpdate ? 'animationDelayUpdate' : 'animationDelay');\n    } // animation from payload has highest priority.\n\n\n    if (animationPayload) {\n      animationPayload.duration != null && (duration = animationPayload.duration);\n      animationPayload.easing != null && (easing = animationPayload.easing);\n      animationPayload.delay != null && (delay = animationPayload.delay);\n    }\n\n    if (typeof delay === 'function') {\n      delay = delay(dataIndex, extraDelayParams);\n    }\n\n    if (typeof duration === 'function') {\n      duration = duration(dataIndex);\n    }\n\n    var config = {\n      duration: duration || 0,\n      delay: delay,\n      easing: easing\n    };\n    return config;\n  } else {\n    return null;\n  }\n}\n\nfunction animateOrSetProps(animationType, el, props, animatableModel, dataIndex, cb, during) {\n  var isFrom = false;\n  var removeOpt;\n\n  if (typeof dataIndex === 'function') {\n    during = cb;\n    cb = dataIndex;\n    dataIndex = null;\n  } else if (isObject(dataIndex)) {\n    cb = dataIndex.cb;\n    during = dataIndex.during;\n    isFrom = dataIndex.isFrom;\n    removeOpt = dataIndex.removeOpt;\n    dataIndex = dataIndex.dataIndex;\n  }\n\n  var isRemove = animationType === 'remove';\n\n  if (!isRemove) {\n    // Must stop the remove animation.\n    el.stopAnimation('remove');\n  }\n\n  var animationConfig = getAnimationConfig(animationType, animatableModel, dataIndex, isRemove ? removeOpt || {} : null, animatableModel && animatableModel.getAnimationDelayParams ? animatableModel.getAnimationDelayParams(el, dataIndex) : null);\n\n  if (animationConfig && animationConfig.duration > 0) {\n    var duration = animationConfig.duration;\n    var animationDelay = animationConfig.delay;\n    var animationEasing = animationConfig.easing;\n    var animateConfig = {\n      duration: duration,\n      delay: animationDelay || 0,\n      easing: animationEasing,\n      done: cb,\n      force: !!cb || !!during,\n      // Set to final state in update/init animation.\n      // So the post processing based on the path shape can be done correctly.\n      setToFinal: !isRemove,\n      scope: animationType,\n      during: during\n    };\n    isFrom ? el.animateFrom(props, animateConfig) : el.animateTo(props, animateConfig);\n  } else {\n    el.stopAnimation(); // If `isFrom`, the props is the \"from\" props.\n\n    !isFrom && el.attr(props); // Call during at least once.\n\n    during && during(1);\n    cb && cb();\n  }\n}\n/**\n * Update graphic element properties with or without animation according to the\n * configuration in series.\n *\n * Caution: this method will stop previous animation.\n * So do not use this method to one element twice before\n * animation starts, unless you know what you are doing.\n * @example\n *     graphic.updateProps(el, {\n *         position: [100, 100]\n *     }, seriesModel, dataIndex, function () { console.log('Animation done!'); });\n *     // Or\n *     graphic.updateProps(el, {\n *         position: [100, 100]\n *     }, seriesModel, function () { console.log('Animation done!'); });\n */\n\n\nfunction updateProps(el, props, // TODO: TYPE AnimatableModel\nanimatableModel, dataIndex, cb, during) {\n  animateOrSetProps('update', el, props, animatableModel, dataIndex, cb, during);\n}\n\nexport { updateProps };\n/**\n * Init graphic element properties with or without animation according to the\n * configuration in series.\n *\n * Caution: this method will stop previous animation.\n * So do not use this method to one element twice before\n * animation starts, unless you know what you are doing.\n */\n\nexport function initProps(el, props, animatableModel, dataIndex, cb, during) {\n  animateOrSetProps('init', el, props, animatableModel, dataIndex, cb, during);\n}\n/**\n * If element is removed.\n * It can determine if element is having remove animation.\n */\n\nexport function isElementRemoved(el) {\n  if (!el.__zr) {\n    return true;\n  }\n\n  for (var i = 0; i < el.animators.length; i++) {\n    var animator = el.animators[i];\n\n    if (animator.scope === 'remove') {\n      return true;\n    }\n  }\n\n  return false;\n}\n/**\n * Remove graphic element\n */\n\nexport function removeElement(el, props, animatableModel, dataIndex, cb, during) {\n  // Don't do remove animation twice.\n  if (isElementRemoved(el)) {\n    return;\n  }\n\n  animateOrSetProps('remove', el, props, animatableModel, dataIndex, cb, during);\n}\n\nfunction fadeOutDisplayable(el, animatableModel, dataIndex, done) {\n  el.removeTextContent();\n  el.removeTextGuideLine();\n  removeElement(el, {\n    style: {\n      opacity: 0\n    }\n  }, animatableModel, dataIndex, done);\n}\n\nexport function removeElementWithFadeOut(el, animatableModel, dataIndex) {\n  function doRemove() {\n    el.parent && el.parent.remove(el);\n  } // Hide label and labelLine first\n  // TODO Also use fade out animation?\n\n\n  if (!el.isGroup) {\n    fadeOutDisplayable(el, animatableModel, dataIndex, doRemove);\n  } else {\n    el.traverse(function (disp) {\n      if (!disp.isGroup) {\n        // Can invoke doRemove multiple times.\n        fadeOutDisplayable(disp, animatableModel, dataIndex, doRemove);\n      }\n    });\n  }\n}\n/**\n * Save old style for style transition in universalTransition module.\n * It's used when element will be reused in each render.\n * For chart like map, heatmap, which will always create new element.\n * We don't need to save this because universalTransition can get old style from the old element\n */\n\nexport function saveOldStyle(el) {\n  transitionStore(el).oldStyle = el.style;\n}\nexport function getOldStyle(el) {\n  return transitionStore(el).oldStyle;\n}","map":{"version":3,"sources":["D:/桌面/react基础原理分析/react_extension/node_modules/echarts/lib/animation/basicTrasition.js"],"names":["isObject","retrieve2","makeInner","transitionStore","getAnimationConfig","animationType","animatableModel","dataIndex","extraOpts","extraDelayParams","animationPayload","ecModel","updatePayload","getUpdatePayload","animation","animationEnabled","isAnimationEnabled","isUpdate","duration","easing","delay","getShallow","config","animateOrSetProps","el","props","cb","during","isFrom","removeOpt","isRemove","stopAnimation","animationConfig","getAnimationDelayParams","animationDelay","animationEasing","animateConfig","done","force","setToFinal","scope","animateFrom","animateTo","attr","updateProps","initProps","isElementRemoved","__zr","i","animators","length","animator","removeElement","fadeOutDisplayable","removeTextContent","removeTextGuideLine","style","opacity","removeElementWithFadeOut","doRemove","parent","remove","isGroup","traverse","disp","saveOldStyle","oldStyle","getOldStyle"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { isObject, retrieve2 } from 'zrender/lib/core/util';\nimport { makeInner } from '../util/model'; // Stored properties for further transition.\n\nexport var transitionStore = makeInner();\n/**\n * Return null if animation is disabled.\n */\n\nexport function getAnimationConfig(animationType, animatableModel, dataIndex, // Extra opts can override the option in animatable model.\nextraOpts, // TODO It's only for pictorial bar now.\nextraDelayParams) {\n  var animationPayload; // Check if there is global animation configuration from dataZoom/resize can override the config in option.\n  // If animation is enabled. Will use this animation config in payload.\n  // If animation is disabled. Just ignore it.\n\n  if (animatableModel && animatableModel.ecModel) {\n    var updatePayload = animatableModel.ecModel.getUpdatePayload();\n    animationPayload = updatePayload && updatePayload.animation;\n  }\n\n  var animationEnabled = animatableModel && animatableModel.isAnimationEnabled();\n  var isUpdate = animationType === 'update';\n\n  if (animationEnabled) {\n    var duration = void 0;\n    var easing = void 0;\n    var delay = void 0;\n\n    if (extraOpts) {\n      duration = retrieve2(extraOpts.duration, 200);\n      easing = retrieve2(extraOpts.easing, 'cubicOut');\n      delay = 0;\n    } else {\n      duration = animatableModel.getShallow(isUpdate ? 'animationDurationUpdate' : 'animationDuration');\n      easing = animatableModel.getShallow(isUpdate ? 'animationEasingUpdate' : 'animationEasing');\n      delay = animatableModel.getShallow(isUpdate ? 'animationDelayUpdate' : 'animationDelay');\n    } // animation from payload has highest priority.\n\n\n    if (animationPayload) {\n      animationPayload.duration != null && (duration = animationPayload.duration);\n      animationPayload.easing != null && (easing = animationPayload.easing);\n      animationPayload.delay != null && (delay = animationPayload.delay);\n    }\n\n    if (typeof delay === 'function') {\n      delay = delay(dataIndex, extraDelayParams);\n    }\n\n    if (typeof duration === 'function') {\n      duration = duration(dataIndex);\n    }\n\n    var config = {\n      duration: duration || 0,\n      delay: delay,\n      easing: easing\n    };\n    return config;\n  } else {\n    return null;\n  }\n}\n\nfunction animateOrSetProps(animationType, el, props, animatableModel, dataIndex, cb, during) {\n  var isFrom = false;\n  var removeOpt;\n\n  if (typeof dataIndex === 'function') {\n    during = cb;\n    cb = dataIndex;\n    dataIndex = null;\n  } else if (isObject(dataIndex)) {\n    cb = dataIndex.cb;\n    during = dataIndex.during;\n    isFrom = dataIndex.isFrom;\n    removeOpt = dataIndex.removeOpt;\n    dataIndex = dataIndex.dataIndex;\n  }\n\n  var isRemove = animationType === 'remove';\n\n  if (!isRemove) {\n    // Must stop the remove animation.\n    el.stopAnimation('remove');\n  }\n\n  var animationConfig = getAnimationConfig(animationType, animatableModel, dataIndex, isRemove ? removeOpt || {} : null, animatableModel && animatableModel.getAnimationDelayParams ? animatableModel.getAnimationDelayParams(el, dataIndex) : null);\n\n  if (animationConfig && animationConfig.duration > 0) {\n    var duration = animationConfig.duration;\n    var animationDelay = animationConfig.delay;\n    var animationEasing = animationConfig.easing;\n    var animateConfig = {\n      duration: duration,\n      delay: animationDelay || 0,\n      easing: animationEasing,\n      done: cb,\n      force: !!cb || !!during,\n      // Set to final state in update/init animation.\n      // So the post processing based on the path shape can be done correctly.\n      setToFinal: !isRemove,\n      scope: animationType,\n      during: during\n    };\n    isFrom ? el.animateFrom(props, animateConfig) : el.animateTo(props, animateConfig);\n  } else {\n    el.stopAnimation(); // If `isFrom`, the props is the \"from\" props.\n\n    !isFrom && el.attr(props); // Call during at least once.\n\n    during && during(1);\n    cb && cb();\n  }\n}\n/**\n * Update graphic element properties with or without animation according to the\n * configuration in series.\n *\n * Caution: this method will stop previous animation.\n * So do not use this method to one element twice before\n * animation starts, unless you know what you are doing.\n * @example\n *     graphic.updateProps(el, {\n *         position: [100, 100]\n *     }, seriesModel, dataIndex, function () { console.log('Animation done!'); });\n *     // Or\n *     graphic.updateProps(el, {\n *         position: [100, 100]\n *     }, seriesModel, function () { console.log('Animation done!'); });\n */\n\n\nfunction updateProps(el, props, // TODO: TYPE AnimatableModel\nanimatableModel, dataIndex, cb, during) {\n  animateOrSetProps('update', el, props, animatableModel, dataIndex, cb, during);\n}\n\nexport { updateProps };\n/**\n * Init graphic element properties with or without animation according to the\n * configuration in series.\n *\n * Caution: this method will stop previous animation.\n * So do not use this method to one element twice before\n * animation starts, unless you know what you are doing.\n */\n\nexport function initProps(el, props, animatableModel, dataIndex, cb, during) {\n  animateOrSetProps('init', el, props, animatableModel, dataIndex, cb, during);\n}\n/**\n * If element is removed.\n * It can determine if element is having remove animation.\n */\n\nexport function isElementRemoved(el) {\n  if (!el.__zr) {\n    return true;\n  }\n\n  for (var i = 0; i < el.animators.length; i++) {\n    var animator = el.animators[i];\n\n    if (animator.scope === 'remove') {\n      return true;\n    }\n  }\n\n  return false;\n}\n/**\n * Remove graphic element\n */\n\nexport function removeElement(el, props, animatableModel, dataIndex, cb, during) {\n  // Don't do remove animation twice.\n  if (isElementRemoved(el)) {\n    return;\n  }\n\n  animateOrSetProps('remove', el, props, animatableModel, dataIndex, cb, during);\n}\n\nfunction fadeOutDisplayable(el, animatableModel, dataIndex, done) {\n  el.removeTextContent();\n  el.removeTextGuideLine();\n  removeElement(el, {\n    style: {\n      opacity: 0\n    }\n  }, animatableModel, dataIndex, done);\n}\n\nexport function removeElementWithFadeOut(el, animatableModel, dataIndex) {\n  function doRemove() {\n    el.parent && el.parent.remove(el);\n  } // Hide label and labelLine first\n  // TODO Also use fade out animation?\n\n\n  if (!el.isGroup) {\n    fadeOutDisplayable(el, animatableModel, dataIndex, doRemove);\n  } else {\n    el.traverse(function (disp) {\n      if (!disp.isGroup) {\n        // Can invoke doRemove multiple times.\n        fadeOutDisplayable(disp, animatableModel, dataIndex, doRemove);\n      }\n    });\n  }\n}\n/**\n * Save old style for style transition in universalTransition module.\n * It's used when element will be reused in each render.\n * For chart like map, heatmap, which will always create new element.\n * We don't need to save this because universalTransition can get old style from the old element\n */\n\nexport function saveOldStyle(el) {\n  transitionStore(el).oldStyle = el.style;\n}\nexport function getOldStyle(el) {\n  return transitionStore(el).oldStyle;\n}"]},"metadata":{},"sourceType":"module"}