{"ast":null,"code":"var Eventful = function () {\n  function Eventful(eventProcessors) {\n    if (eventProcessors) {\n      this._$eventProcessor = eventProcessors;\n    }\n  }\n\n  Eventful.prototype.on = function (event, query, handler, context) {\n    if (!this._$handlers) {\n      this._$handlers = {};\n    }\n\n    var _h = this._$handlers;\n\n    if (typeof query === 'function') {\n      context = handler;\n      handler = query;\n      query = null;\n    }\n\n    if (!handler || !event) {\n      return this;\n    }\n\n    var eventProcessor = this._$eventProcessor;\n\n    if (query != null && eventProcessor && eventProcessor.normalizeQuery) {\n      query = eventProcessor.normalizeQuery(query);\n    }\n\n    if (!_h[event]) {\n      _h[event] = [];\n    }\n\n    for (var i = 0; i < _h[event].length; i++) {\n      if (_h[event][i].h === handler) {\n        return this;\n      }\n    }\n\n    var wrap = {\n      h: handler,\n      query: query,\n      ctx: context || this,\n      callAtLast: handler.zrEventfulCallAtLast\n    };\n    var lastIndex = _h[event].length - 1;\n    var lastWrap = _h[event][lastIndex];\n    lastWrap && lastWrap.callAtLast ? _h[event].splice(lastIndex, 0, wrap) : _h[event].push(wrap);\n    return this;\n  };\n\n  Eventful.prototype.isSilent = function (eventName) {\n    var _h = this._$handlers;\n    return !_h || !_h[eventName] || !_h[eventName].length;\n  };\n\n  Eventful.prototype.off = function (eventType, handler) {\n    var _h = this._$handlers;\n\n    if (!_h) {\n      return this;\n    }\n\n    if (!eventType) {\n      this._$handlers = {};\n      return this;\n    }\n\n    if (handler) {\n      if (_h[eventType]) {\n        var newList = [];\n\n        for (var i = 0, l = _h[eventType].length; i < l; i++) {\n          if (_h[eventType][i].h !== handler) {\n            newList.push(_h[eventType][i]);\n          }\n        }\n\n        _h[eventType] = newList;\n      }\n\n      if (_h[eventType] && _h[eventType].length === 0) {\n        delete _h[eventType];\n      }\n    } else {\n      delete _h[eventType];\n    }\n\n    return this;\n  };\n\n  Eventful.prototype.trigger = function (eventType) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    if (!this._$handlers) {\n      return this;\n    }\n\n    var _h = this._$handlers[eventType];\n    var eventProcessor = this._$eventProcessor;\n\n    if (_h) {\n      var argLen = args.length;\n      var len = _h.length;\n\n      for (var i = 0; i < len; i++) {\n        var hItem = _h[i];\n\n        if (eventProcessor && eventProcessor.filter && hItem.query != null && !eventProcessor.filter(eventType, hItem.query)) {\n          continue;\n        }\n\n        switch (argLen) {\n          case 0:\n            hItem.h.call(hItem.ctx);\n            break;\n\n          case 1:\n            hItem.h.call(hItem.ctx, args[0]);\n            break;\n\n          case 2:\n            hItem.h.call(hItem.ctx, args[0], args[1]);\n            break;\n\n          default:\n            hItem.h.apply(hItem.ctx, args);\n            break;\n        }\n      }\n    }\n\n    eventProcessor && eventProcessor.afterTrigger && eventProcessor.afterTrigger(eventType);\n    return this;\n  };\n\n  Eventful.prototype.triggerWithContext = function (type) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    if (!this._$handlers) {\n      return this;\n    }\n\n    var _h = this._$handlers[type];\n    var eventProcessor = this._$eventProcessor;\n\n    if (_h) {\n      var argLen = args.length;\n      var ctx = args[argLen - 1];\n      var len = _h.length;\n\n      for (var i = 0; i < len; i++) {\n        var hItem = _h[i];\n\n        if (eventProcessor && eventProcessor.filter && hItem.query != null && !eventProcessor.filter(type, hItem.query)) {\n          continue;\n        }\n\n        switch (argLen) {\n          case 0:\n            hItem.h.call(ctx);\n            break;\n\n          case 1:\n            hItem.h.call(ctx, args[0]);\n            break;\n\n          case 2:\n            hItem.h.call(ctx, args[0], args[1]);\n            break;\n\n          default:\n            hItem.h.apply(ctx, args.slice(1, argLen - 1));\n            break;\n        }\n      }\n    }\n\n    eventProcessor && eventProcessor.afterTrigger && eventProcessor.afterTrigger(type);\n    return this;\n  };\n\n  return Eventful;\n}();\n\nexport default Eventful;","map":{"version":3,"sources":["D:/桌面/react基础原理分析/react_extension/node_modules/zrender/lib/core/Eventful.js"],"names":["Eventful","eventProcessors","_$eventProcessor","prototype","on","event","query","handler","context","_$handlers","_h","eventProcessor","normalizeQuery","i","length","h","wrap","ctx","callAtLast","zrEventfulCallAtLast","lastIndex","lastWrap","splice","push","isSilent","eventName","off","eventType","newList","l","trigger","args","_i","arguments","argLen","len","hItem","filter","call","apply","afterTrigger","triggerWithContext","type","slice"],"mappings":"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","sourcesContent":["var Eventful = (function () {\n    function Eventful(eventProcessors) {\n        if (eventProcessors) {\n            this._$eventProcessor = eventProcessors;\n        }\n    }\n    Eventful.prototype.on = function (event, query, handler, context) {\n        if (!this._$handlers) {\n            this._$handlers = {};\n        }\n        var _h = this._$handlers;\n        if (typeof query === 'function') {\n            context = handler;\n            handler = query;\n            query = null;\n        }\n        if (!handler || !event) {\n            return this;\n        }\n        var eventProcessor = this._$eventProcessor;\n        if (query != null && eventProcessor && eventProcessor.normalizeQuery) {\n            query = eventProcessor.normalizeQuery(query);\n        }\n        if (!_h[event]) {\n            _h[event] = [];\n        }\n        for (var i = 0; i < _h[event].length; i++) {\n            if (_h[event][i].h === handler) {\n                return this;\n            }\n        }\n        var wrap = {\n            h: handler,\n            query: query,\n            ctx: (context || this),\n            callAtLast: handler.zrEventfulCallAtLast\n        };\n        var lastIndex = _h[event].length - 1;\n        var lastWrap = _h[event][lastIndex];\n        (lastWrap && lastWrap.callAtLast)\n            ? _h[event].splice(lastIndex, 0, wrap)\n            : _h[event].push(wrap);\n        return this;\n    };\n    Eventful.prototype.isSilent = function (eventName) {\n        var _h = this._$handlers;\n        return !_h || !_h[eventName] || !_h[eventName].length;\n    };\n    Eventful.prototype.off = function (eventType, handler) {\n        var _h = this._$handlers;\n        if (!_h) {\n            return this;\n        }\n        if (!eventType) {\n            this._$handlers = {};\n            return this;\n        }\n        if (handler) {\n            if (_h[eventType]) {\n                var newList = [];\n                for (var i = 0, l = _h[eventType].length; i < l; i++) {\n                    if (_h[eventType][i].h !== handler) {\n                        newList.push(_h[eventType][i]);\n                    }\n                }\n                _h[eventType] = newList;\n            }\n            if (_h[eventType] && _h[eventType].length === 0) {\n                delete _h[eventType];\n            }\n        }\n        else {\n            delete _h[eventType];\n        }\n        return this;\n    };\n    Eventful.prototype.trigger = function (eventType) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        if (!this._$handlers) {\n            return this;\n        }\n        var _h = this._$handlers[eventType];\n        var eventProcessor = this._$eventProcessor;\n        if (_h) {\n            var argLen = args.length;\n            var len = _h.length;\n            for (var i = 0; i < len; i++) {\n                var hItem = _h[i];\n                if (eventProcessor\n                    && eventProcessor.filter\n                    && hItem.query != null\n                    && !eventProcessor.filter(eventType, hItem.query)) {\n                    continue;\n                }\n                switch (argLen) {\n                    case 0:\n                        hItem.h.call(hItem.ctx);\n                        break;\n                    case 1:\n                        hItem.h.call(hItem.ctx, args[0]);\n                        break;\n                    case 2:\n                        hItem.h.call(hItem.ctx, args[0], args[1]);\n                        break;\n                    default:\n                        hItem.h.apply(hItem.ctx, args);\n                        break;\n                }\n            }\n        }\n        eventProcessor && eventProcessor.afterTrigger\n            && eventProcessor.afterTrigger(eventType);\n        return this;\n    };\n    Eventful.prototype.triggerWithContext = function (type) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        if (!this._$handlers) {\n            return this;\n        }\n        var _h = this._$handlers[type];\n        var eventProcessor = this._$eventProcessor;\n        if (_h) {\n            var argLen = args.length;\n            var ctx = args[argLen - 1];\n            var len = _h.length;\n            for (var i = 0; i < len; i++) {\n                var hItem = _h[i];\n                if (eventProcessor\n                    && eventProcessor.filter\n                    && hItem.query != null\n                    && !eventProcessor.filter(type, hItem.query)) {\n                    continue;\n                }\n                switch (argLen) {\n                    case 0:\n                        hItem.h.call(ctx);\n                        break;\n                    case 1:\n                        hItem.h.call(ctx, args[0]);\n                        break;\n                    case 2:\n                        hItem.h.call(ctx, args[0], args[1]);\n                        break;\n                    default:\n                        hItem.h.apply(ctx, args.slice(1, argLen - 1));\n                        break;\n                }\n            }\n        }\n        eventProcessor && eventProcessor.afterTrigger\n            && eventProcessor.afterTrigger(type);\n        return this;\n    };\n    return Eventful;\n}());\nexport default Eventful;\n"]},"metadata":{},"sourceType":"module"}