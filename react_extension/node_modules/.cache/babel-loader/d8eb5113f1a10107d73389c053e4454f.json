{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\nimport * as echarts from '../../../core/echarts';\nimport * as zrUtil from 'zrender/lib/core/util';\nimport { ToolboxFeature } from '../featureManager';\nimport { SINGLE_REFERRING } from '../../../util/model';\nvar INNER_STACK_KEYWORD = '__ec_magicType_stack__';\nvar ICON_TYPES = ['line', 'bar', 'stack']; // stack and tiled appears in pair for the title\n\nvar TITLE_TYPES = ['line', 'bar', 'stack', 'tiled'];\nvar radioTypes = [['line', 'bar'], ['stack']];\n\nvar MagicType =\n/** @class */\nfunction (_super) {\n  __extends(MagicType, _super);\n\n  function MagicType() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  MagicType.prototype.getIcons = function () {\n    var model = this.model;\n    var availableIcons = model.get('icon');\n    var icons = {};\n    zrUtil.each(model.get('type'), function (type) {\n      if (availableIcons[type]) {\n        icons[type] = availableIcons[type];\n      }\n    });\n    return icons;\n  };\n\n  MagicType.getDefaultOption = function (ecModel) {\n    var defaultOption = {\n      show: true,\n      type: [],\n      // Icon group\n      icon: {\n        line: 'M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4',\n        bar: 'M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7',\n        // eslint-disable-next-line\n        stack: 'M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z' // jshint ignore:line\n\n      },\n      // `line`, `bar`, `stack`, `tiled`\n      title: ecModel.getLocaleModel().get(['toolbox', 'magicType', 'title']),\n      option: {},\n      seriesIndex: {}\n    };\n    return defaultOption;\n  };\n\n  MagicType.prototype.onclick = function (ecModel, api, type) {\n    var model = this.model;\n    var seriesIndex = model.get(['seriesIndex', type]); // Not supported magicType\n\n    if (!seriesOptGenreator[type]) {\n      return;\n    }\n\n    var newOption = {\n      series: []\n    };\n\n    var generateNewSeriesTypes = function (seriesModel) {\n      var seriesType = seriesModel.subType;\n      var seriesId = seriesModel.id;\n      var newSeriesOpt = seriesOptGenreator[type](seriesType, seriesId, seriesModel, model);\n\n      if (newSeriesOpt) {\n        // PENDING If merge original option?\n        zrUtil.defaults(newSeriesOpt, seriesModel.option);\n        newOption.series.push(newSeriesOpt);\n      } // Modify boundaryGap\n\n\n      var coordSys = seriesModel.coordinateSystem;\n\n      if (coordSys && coordSys.type === 'cartesian2d' && (type === 'line' || type === 'bar')) {\n        var categoryAxis = coordSys.getAxesByScale('ordinal')[0];\n\n        if (categoryAxis) {\n          var axisDim = categoryAxis.dim;\n          var axisType = axisDim + 'Axis';\n          var axisModel = seriesModel.getReferringComponents(axisType, SINGLE_REFERRING).models[0];\n          var axisIndex = axisModel.componentIndex;\n          newOption[axisType] = newOption[axisType] || [];\n\n          for (var i = 0; i <= axisIndex; i++) {\n            newOption[axisType][axisIndex] = newOption[axisType][axisIndex] || {};\n          }\n\n          newOption[axisType][axisIndex].boundaryGap = type === 'bar';\n        }\n      }\n    };\n\n    zrUtil.each(radioTypes, function (radio) {\n      if (zrUtil.indexOf(radio, type) >= 0) {\n        zrUtil.each(radio, function (item) {\n          model.setIconStatus(item, 'normal');\n        });\n      }\n    });\n    model.setIconStatus(type, 'emphasis');\n    ecModel.eachComponent({\n      mainType: 'series',\n      query: seriesIndex == null ? null : {\n        seriesIndex: seriesIndex\n      }\n    }, generateNewSeriesTypes);\n    var newTitle;\n    var currentType = type; // Change title of stack\n\n    if (type === 'stack') {\n      // use titles in model instead of ecModel\n      // as stack and tiled appears in pair, just flip them\n      // no need of checking stack state\n      newTitle = zrUtil.merge({\n        stack: model.option.title.tiled,\n        tiled: model.option.title.stack\n      }, model.option.title);\n\n      if (model.get(['iconStatus', type]) !== 'emphasis') {\n        currentType = 'tiled';\n      }\n    }\n\n    api.dispatchAction({\n      type: 'changeMagicType',\n      currentType: currentType,\n      newOption: newOption,\n      newTitle: newTitle,\n      featureName: 'magicType'\n    });\n  };\n\n  return MagicType;\n}(ToolboxFeature);\n\nvar seriesOptGenreator = {\n  'line': function (seriesType, seriesId, seriesModel, model) {\n    if (seriesType === 'bar') {\n      return zrUtil.merge({\n        id: seriesId,\n        type: 'line',\n        // Preserve data related option\n        data: seriesModel.get('data'),\n        stack: seriesModel.get('stack'),\n        markPoint: seriesModel.get('markPoint'),\n        markLine: seriesModel.get('markLine')\n      }, model.get(['option', 'line']) || {}, true);\n    }\n  },\n  'bar': function (seriesType, seriesId, seriesModel, model) {\n    if (seriesType === 'line') {\n      return zrUtil.merge({\n        id: seriesId,\n        type: 'bar',\n        // Preserve data related option\n        data: seriesModel.get('data'),\n        stack: seriesModel.get('stack'),\n        markPoint: seriesModel.get('markPoint'),\n        markLine: seriesModel.get('markLine')\n      }, model.get(['option', 'bar']) || {}, true);\n    }\n  },\n  'stack': function (seriesType, seriesId, seriesModel, model) {\n    var isStack = seriesModel.get('stack') === INNER_STACK_KEYWORD;\n\n    if (seriesType === 'line' || seriesType === 'bar') {\n      model.setIconStatus('stack', isStack ? 'normal' : 'emphasis');\n      return zrUtil.merge({\n        id: seriesId,\n        stack: isStack ? '' : INNER_STACK_KEYWORD\n      }, model.get(['option', 'stack']) || {}, true);\n    }\n  }\n}; // TODO: SELF REGISTERED.\n\necharts.registerAction({\n  type: 'changeMagicType',\n  event: 'magicTypeChanged',\n  update: 'prepareAndUpdate'\n}, function (payload, ecModel) {\n  ecModel.mergeOption(payload.newOption);\n});\nexport default MagicType;","map":{"version":3,"sources":["D:/桌面/react基础原理分析/react_extension/node_modules/echarts/lib/component/toolbox/feature/MagicType.js"],"names":["__extends","echarts","zrUtil","ToolboxFeature","SINGLE_REFERRING","INNER_STACK_KEYWORD","ICON_TYPES","TITLE_TYPES","radioTypes","MagicType","_super","apply","arguments","prototype","getIcons","model","availableIcons","get","icons","each","type","getDefaultOption","ecModel","defaultOption","show","icon","line","bar","stack","title","getLocaleModel","option","seriesIndex","onclick","api","seriesOptGenreator","newOption","series","generateNewSeriesTypes","seriesModel","seriesType","subType","seriesId","id","newSeriesOpt","defaults","push","coordSys","coordinateSystem","categoryAxis","getAxesByScale","axisDim","dim","axisType","axisModel","getReferringComponents","models","axisIndex","componentIndex","i","boundaryGap","radio","indexOf","item","setIconStatus","eachComponent","mainType","query","newTitle","currentType","merge","tiled","dispatchAction","featureName","data","markPoint","markLine","isStack","registerAction","event","update","payload","mergeOption"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\n/**\n * AUTO-GENERATED FILE. DO NOT MODIFY.\n */\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nimport { __extends } from \"tslib\";\nimport * as echarts from '../../../core/echarts';\nimport * as zrUtil from 'zrender/lib/core/util';\nimport { ToolboxFeature } from '../featureManager';\nimport { SINGLE_REFERRING } from '../../../util/model';\nvar INNER_STACK_KEYWORD = '__ec_magicType_stack__';\nvar ICON_TYPES = ['line', 'bar', 'stack']; // stack and tiled appears in pair for the title\n\nvar TITLE_TYPES = ['line', 'bar', 'stack', 'tiled'];\nvar radioTypes = [['line', 'bar'], ['stack']];\n\nvar MagicType =\n/** @class */\nfunction (_super) {\n  __extends(MagicType, _super);\n\n  function MagicType() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  MagicType.prototype.getIcons = function () {\n    var model = this.model;\n    var availableIcons = model.get('icon');\n    var icons = {};\n    zrUtil.each(model.get('type'), function (type) {\n      if (availableIcons[type]) {\n        icons[type] = availableIcons[type];\n      }\n    });\n    return icons;\n  };\n\n  MagicType.getDefaultOption = function (ecModel) {\n    var defaultOption = {\n      show: true,\n      type: [],\n      // Icon group\n      icon: {\n        line: 'M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4',\n        bar: 'M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7',\n        // eslint-disable-next-line\n        stack: 'M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z' // jshint ignore:line\n\n      },\n      // `line`, `bar`, `stack`, `tiled`\n      title: ecModel.getLocaleModel().get(['toolbox', 'magicType', 'title']),\n      option: {},\n      seriesIndex: {}\n    };\n    return defaultOption;\n  };\n\n  MagicType.prototype.onclick = function (ecModel, api, type) {\n    var model = this.model;\n    var seriesIndex = model.get(['seriesIndex', type]); // Not supported magicType\n\n    if (!seriesOptGenreator[type]) {\n      return;\n    }\n\n    var newOption = {\n      series: []\n    };\n\n    var generateNewSeriesTypes = function (seriesModel) {\n      var seriesType = seriesModel.subType;\n      var seriesId = seriesModel.id;\n      var newSeriesOpt = seriesOptGenreator[type](seriesType, seriesId, seriesModel, model);\n\n      if (newSeriesOpt) {\n        // PENDING If merge original option?\n        zrUtil.defaults(newSeriesOpt, seriesModel.option);\n        newOption.series.push(newSeriesOpt);\n      } // Modify boundaryGap\n\n\n      var coordSys = seriesModel.coordinateSystem;\n\n      if (coordSys && coordSys.type === 'cartesian2d' && (type === 'line' || type === 'bar')) {\n        var categoryAxis = coordSys.getAxesByScale('ordinal')[0];\n\n        if (categoryAxis) {\n          var axisDim = categoryAxis.dim;\n          var axisType = axisDim + 'Axis';\n          var axisModel = seriesModel.getReferringComponents(axisType, SINGLE_REFERRING).models[0];\n          var axisIndex = axisModel.componentIndex;\n          newOption[axisType] = newOption[axisType] || [];\n\n          for (var i = 0; i <= axisIndex; i++) {\n            newOption[axisType][axisIndex] = newOption[axisType][axisIndex] || {};\n          }\n\n          newOption[axisType][axisIndex].boundaryGap = type === 'bar';\n        }\n      }\n    };\n\n    zrUtil.each(radioTypes, function (radio) {\n      if (zrUtil.indexOf(radio, type) >= 0) {\n        zrUtil.each(radio, function (item) {\n          model.setIconStatus(item, 'normal');\n        });\n      }\n    });\n    model.setIconStatus(type, 'emphasis');\n    ecModel.eachComponent({\n      mainType: 'series',\n      query: seriesIndex == null ? null : {\n        seriesIndex: seriesIndex\n      }\n    }, generateNewSeriesTypes);\n    var newTitle;\n    var currentType = type; // Change title of stack\n\n    if (type === 'stack') {\n      // use titles in model instead of ecModel\n      // as stack and tiled appears in pair, just flip them\n      // no need of checking stack state\n      newTitle = zrUtil.merge({\n        stack: model.option.title.tiled,\n        tiled: model.option.title.stack\n      }, model.option.title);\n\n      if (model.get(['iconStatus', type]) !== 'emphasis') {\n        currentType = 'tiled';\n      }\n    }\n\n    api.dispatchAction({\n      type: 'changeMagicType',\n      currentType: currentType,\n      newOption: newOption,\n      newTitle: newTitle,\n      featureName: 'magicType'\n    });\n  };\n\n  return MagicType;\n}(ToolboxFeature);\n\nvar seriesOptGenreator = {\n  'line': function (seriesType, seriesId, seriesModel, model) {\n    if (seriesType === 'bar') {\n      return zrUtil.merge({\n        id: seriesId,\n        type: 'line',\n        // Preserve data related option\n        data: seriesModel.get('data'),\n        stack: seriesModel.get('stack'),\n        markPoint: seriesModel.get('markPoint'),\n        markLine: seriesModel.get('markLine')\n      }, model.get(['option', 'line']) || {}, true);\n    }\n  },\n  'bar': function (seriesType, seriesId, seriesModel, model) {\n    if (seriesType === 'line') {\n      return zrUtil.merge({\n        id: seriesId,\n        type: 'bar',\n        // Preserve data related option\n        data: seriesModel.get('data'),\n        stack: seriesModel.get('stack'),\n        markPoint: seriesModel.get('markPoint'),\n        markLine: seriesModel.get('markLine')\n      }, model.get(['option', 'bar']) || {}, true);\n    }\n  },\n  'stack': function (seriesType, seriesId, seriesModel, model) {\n    var isStack = seriesModel.get('stack') === INNER_STACK_KEYWORD;\n\n    if (seriesType === 'line' || seriesType === 'bar') {\n      model.setIconStatus('stack', isStack ? 'normal' : 'emphasis');\n      return zrUtil.merge({\n        id: seriesId,\n        stack: isStack ? '' : INNER_STACK_KEYWORD\n      }, model.get(['option', 'stack']) || {}, true);\n    }\n  }\n}; // TODO: SELF REGISTERED.\n\necharts.registerAction({\n  type: 'changeMagicType',\n  event: 'magicTypeChanged',\n  update: 'prepareAndUpdate'\n}, function (payload, ecModel) {\n  ecModel.mergeOption(payload.newOption);\n});\nexport default MagicType;"]},"metadata":{},"sourceType":"module"}